(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{2339:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CommandManager})),__webpack_require__.d(__webpack_exports__,"b",(function(){return tiptap_core_esm_Editor})),__webpack_require__.d(__webpack_exports__,"c",(function(){return Extension})),__webpack_require__.d(__webpack_exports__,"d",(function(){return InputRule})),__webpack_require__.d(__webpack_exports__,"e",(function(){return Mark})),__webpack_require__.d(__webpack_exports__,"f",(function(){return Node})),__webpack_require__.d(__webpack_exports__,"g",(function(){return tiptap_core_esm_NodeView})),__webpack_require__.d(__webpack_exports__,"h",(function(){return PasteRule})),__webpack_require__.d(__webpack_exports__,"i",(function(){return Tracker})),__webpack_require__.d(__webpack_exports__,"j",(function(){return callOrReturn})),__webpack_require__.d(__webpack_exports__,"k",(function(){return combineTransactionSteps})),__webpack_require__.d(__webpack_exports__,"l",(function(){return tiptap_core_esm_defaultBlockAt})),__webpack_require__.d(__webpack_exports__,"m",(function(){return escapeForRegEx})),__webpack_require__.d(__webpack_exports__,"n",(function(){return tiptap_core_esm_extensions})),__webpack_require__.d(__webpack_exports__,"o",(function(){return findChildren})),__webpack_require__.d(__webpack_exports__,"p",(function(){return findChildrenInRange})),__webpack_require__.d(__webpack_exports__,"q",(function(){return findParentNode})),__webpack_require__.d(__webpack_exports__,"r",(function(){return findParentNodeClosestToPos})),__webpack_require__.d(__webpack_exports__,"s",(function(){return generateHTML})),__webpack_require__.d(__webpack_exports__,"t",(function(){return generateJSON})),__webpack_require__.d(__webpack_exports__,"u",(function(){return generateText})),__webpack_require__.d(__webpack_exports__,"v",(function(){return getAttributes})),__webpack_require__.d(__webpack_exports__,"w",(function(){return getChangedRanges})),__webpack_require__.d(__webpack_exports__,"x",(function(){return getDebugJSON})),__webpack_require__.d(__webpack_exports__,"y",(function(){return getExtensionField})),__webpack_require__.d(__webpack_exports__,"z",(function(){return getHTMLFromFragment})),__webpack_require__.d(__webpack_exports__,"A",(function(){return getMarkAttributes})),__webpack_require__.d(__webpack_exports__,"B",(function(){return getMarkRange})),__webpack_require__.d(__webpack_exports__,"C",(function(){return getMarkType})),__webpack_require__.d(__webpack_exports__,"D",(function(){return getMarksBetween})),__webpack_require__.d(__webpack_exports__,"E",(function(){return getNodeAttributes})),__webpack_require__.d(__webpack_exports__,"F",(function(){return getNodeType})),__webpack_require__.d(__webpack_exports__,"G",(function(){return getSchema})),__webpack_require__.d(__webpack_exports__,"H",(function(){return getText})),__webpack_require__.d(__webpack_exports__,"I",(function(){return getTextBetween})),__webpack_require__.d(__webpack_exports__,"J",(function(){return inputRulesPlugin})),__webpack_require__.d(__webpack_exports__,"K",(function(){return tiptap_core_esm_isActive})),__webpack_require__.d(__webpack_exports__,"L",(function(){return isList})),__webpack_require__.d(__webpack_exports__,"M",(function(){return isMarkActive})),__webpack_require__.d(__webpack_exports__,"N",(function(){return isNodeActive})),__webpack_require__.d(__webpack_exports__,"O",(function(){return isNodeEmpty})),__webpack_require__.d(__webpack_exports__,"P",(function(){return isNodeSelection})),__webpack_require__.d(__webpack_exports__,"Q",(function(){return isTextSelection})),__webpack_require__.d(__webpack_exports__,"R",(function(){return markInputRule})),__webpack_require__.d(__webpack_exports__,"S",(function(){return markPasteRule})),__webpack_require__.d(__webpack_exports__,"T",(function(){return mergeAttributes})),__webpack_require__.d(__webpack_exports__,"U",(function(){return nodeInputRule})),__webpack_require__.d(__webpack_exports__,"V",(function(){return pasteRulesPlugin})),__webpack_require__.d(__webpack_exports__,"W",(function(){return posToDOMRect})),__webpack_require__.d(__webpack_exports__,"X",(function(){return textInputRule})),__webpack_require__.d(__webpack_exports__,"Y",(function(){return textPasteRule})),__webpack_require__.d(__webpack_exports__,"Z",(function(){return textblockTypeInputRule})),__webpack_require__.d(__webpack_exports__,"ab",(function(){return wrappingInputRule}));var index_es=__webpack_require__(2686),dist_index_es=__webpack_require__(2892),prosemirror_model_dist_index_es=__webpack_require__(3057);function deleteSelection(state,dispatch){return!state.selection.empty&&(dispatch&&dispatch(state.tr.deleteSelection().scrollIntoView()),!0)}function joinBackward(state,dispatch,view){var $cursor=state.selection.$cursor;if(!$cursor||(view?!view.endOfTextblock("backward",state):$cursor.parentOffset>0))return!1;var $cut=findCutBefore($cursor);if(!$cut){var range=$cursor.blockRange(),target=range&&Object(dist_index_es.j)(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}var before=$cut.nodeBefore;if(!before.type.spec.isolating&&deleteBarrier(state,$cut,dispatch))return!0;if(0==$cursor.parent.content.size&&(textblockAt(before,"end")||index_es.c.isSelectable(before))){if(dispatch){var tr=state.tr.deleteRange($cursor.before(),$cursor.after());tr.setSelection(textblockAt(before,"end")?index_es.f.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos,-1)),-1):index_es.c.create(tr.doc,$cut.pos-before.nodeSize)),dispatch(tr.scrollIntoView())}return!0}return!(!before.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos-before.nodeSize,$cut.pos).scrollIntoView()),!0)}function textblockAt(node,side,only){for(;node;node="start"==side?node.firstChild:node.lastChild){if(node.isTextblock)return!0;if(only&&1!=node.childCount)return!1}return!1}function selectNodeBackward(state,dispatch,view){var ref=state.selection,$head=ref.$head,$cut=$head;if(!ref.empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("backward",state):$head.parentOffset>0)return!1;$cut=findCutBefore($head)}var node=$cut&&$cut.nodeBefore;return!(!node||!index_es.c.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(index_es.c.create(state.doc,$cut.pos-node.nodeSize)).scrollIntoView()),!0)}function findCutBefore($pos){if(!$pos.parent.type.spec.isolating)for(var i=$pos.depth-1;i>=0;i--){if($pos.index(i)>0)return $pos.doc.resolve($pos.before(i+1));if($pos.node(i).type.spec.isolating)break}return null}function joinForward(state,dispatch,view){var $cursor=state.selection.$cursor;if(!$cursor||(view?!view.endOfTextblock("forward",state):$cursor.parentOffset<$cursor.parent.content.size))return!1;var $cut=findCutAfter($cursor);if(!$cut)return!1;var after=$cut.nodeAfter;if(deleteBarrier(state,$cut,dispatch))return!0;if(0==$cursor.parent.content.size&&(textblockAt(after,"start")||index_es.c.isSelectable(after))){if(dispatch){var tr=state.tr.deleteRange($cursor.before(),$cursor.after());tr.setSelection(textblockAt(after,"start")?index_es.f.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)),1):index_es.c.create(tr.doc,tr.mapping.map($cut.pos))),dispatch(tr.scrollIntoView())}return!0}return!(!after.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos,$cut.pos+after.nodeSize).scrollIntoView()),!0)}function selectNodeForward(state,dispatch,view){var ref=state.selection,$head=ref.$head,$cut=$head;if(!ref.empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("forward",state):$head.parentOffset<$head.parent.content.size)return!1;$cut=findCutAfter($head)}var node=$cut&&$cut.nodeAfter;return!(!node||!index_es.c.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(index_es.c.create(state.doc,$cut.pos)).scrollIntoView()),!0)}function findCutAfter($pos){if(!$pos.parent.type.spec.isolating)for(var i=$pos.depth-1;i>=0;i--){var parent=$pos.node(i);if($pos.index(i)+1<parent.childCount)return $pos.doc.resolve($pos.after(i+1));if(parent.type.spec.isolating)break}return null}function newlineInCode(state,dispatch){var ref=state.selection,$head=ref.$head,$anchor=ref.$anchor;return!(!$head.parent.type.spec.code||!$head.sameParent($anchor))&&(dispatch&&dispatch(state.tr.insertText("\n").scrollIntoView()),!0)}function defaultBlockAt(match){for(var i=0;i<match.edgeCount;i++){var type=match.edge(i).type;if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}function exitCode(state,dispatch){var ref=state.selection,$head=ref.$head,$anchor=ref.$anchor;if(!$head.parent.type.spec.code||!$head.sameParent($anchor))return!1;var above=$head.node(-1),after=$head.indexAfter(-1),type=defaultBlockAt(above.contentMatchAt(after));if(!above.canReplaceWith(after,after,type))return!1;if(dispatch){var pos=$head.after(),tr=state.tr.replaceWith(pos,pos,type.createAndFill());tr.setSelection(index_es.f.near(tr.doc.resolve(pos),1)),dispatch(tr.scrollIntoView())}return!0}function createParagraphNear(state,dispatch){var sel=state.selection,$from=sel.$from,$to=sel.$to;if(sel instanceof index_es.a||$from.parent.inlineContent||$to.parent.inlineContent)return!1;var type=defaultBlockAt($to.parent.contentMatchAt($to.indexAfter()));if(!type||!type.isTextblock)return!1;if(dispatch){var side=(!$from.parentOffset&&$to.index()<$to.parent.childCount?$from:$to).pos,tr=state.tr.insert(side,type.createAndFill());tr.setSelection(index_es.g.create(tr.doc,side+1)),dispatch(tr.scrollIntoView())}return!0}function liftEmptyBlock(state,dispatch){var $cursor=state.selection.$cursor;if(!$cursor||$cursor.parent.content.size)return!1;if($cursor.depth>1&&$cursor.after()!=$cursor.end(-1)){var before=$cursor.before();if(Object(dist_index_es.f)(state.doc,before))return dispatch&&dispatch(state.tr.split(before).scrollIntoView()),!0}var range=$cursor.blockRange(),target=range&&Object(dist_index_es.j)(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}function splitBlock(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to;if(state.selection instanceof index_es.c&&state.selection.node.isBlock)return!(!$from.parentOffset||!Object(dist_index_es.f)(state.doc,$from.pos))&&(dispatch&&dispatch(state.tr.split($from.pos).scrollIntoView()),!0);if(!$from.parent.isBlock)return!1;if(dispatch){var atEnd=$to.parentOffset==$to.parent.content.size,tr=state.tr;(state.selection instanceof index_es.g||state.selection instanceof index_es.a)&&tr.deleteSelection();var deflt=0==$from.depth?null:defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1))),types=atEnd&&deflt?[{type:deflt}]:null,can=Object(dist_index_es.f)(tr.doc,tr.mapping.map($from.pos),1,types);if(types||can||!Object(dist_index_es.f)(tr.doc,tr.mapping.map($from.pos),1,deflt&&[{type:deflt}])||(types=[{type:deflt}],can=!0),can&&(tr.split(tr.mapping.map($from.pos),1,types),!atEnd&&!$from.parentOffset&&$from.parent.type!=deflt)){var first=tr.mapping.map($from.before()),$first=tr.doc.resolve(first);$from.node(-1).canReplaceWith($first.index(),$first.index()+1,deflt)&&tr.setNodeMarkup(tr.mapping.map($from.before()),deflt)}dispatch(tr.scrollIntoView())}return!0}function deleteBarrier(state,$cut,dispatch){var conn,match,before=$cut.nodeBefore,after=$cut.nodeAfter;if(before.type.spec.isolating||after.type.spec.isolating)return!1;if(function joinMaybeClear(state,$pos,dispatch){var before=$pos.nodeBefore,after=$pos.nodeAfter,index=$pos.index();return!(!(before&&after&&before.type.compatibleContent(after.type))||(!before.content.size&&$pos.parent.canReplace(index-1,index)?(dispatch&&dispatch(state.tr.delete($pos.pos-before.nodeSize,$pos.pos).scrollIntoView()),0):!$pos.parent.canReplace(index,index+1)||!after.isTextblock&&!Object(dist_index_es.e)(state.doc,$pos.pos)||(dispatch&&dispatch(state.tr.clearIncompatible($pos.pos,before.type,before.contentMatchAt(before.childCount)).join($pos.pos).scrollIntoView()),0)))}(state,$cut,dispatch))return!0;var canDelAfter=$cut.parent.canReplace($cut.index(),$cut.index()+1);if(canDelAfter&&(conn=(match=before.contentMatchAt(before.childCount)).findWrapping(after.type))&&match.matchType(conn[0]||after.type).validEnd){if(dispatch){for(var end=$cut.pos+after.nodeSize,wrap=prosemirror_model_dist_index_es.c.empty,i=conn.length-1;i>=0;i--)wrap=prosemirror_model_dist_index_es.c.from(conn[i].create(null,wrap));wrap=prosemirror_model_dist_index_es.c.from(before.copy(wrap));var tr=state.tr.step(new dist_index_es.b($cut.pos-1,end,$cut.pos,end,new prosemirror_model_dist_index_es.j(wrap,1,0),conn.length,!0)),joinAt=end+2*conn.length;Object(dist_index_es.e)(tr.doc,joinAt)&&tr.join(joinAt),dispatch(tr.scrollIntoView())}return!0}var selAfter=index_es.f.findFrom($cut,1),range=selAfter&&selAfter.$from.blockRange(selAfter.$to),target=range&&Object(dist_index_es.j)(range);if(null!=target&&target>=$cut.depth)return dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0;if(canDelAfter&&textblockAt(after,"start",!0)&&textblockAt(before,"end")){for(var at=before,wrap$1=[];wrap$1.push(at),!at.isTextblock;)at=at.lastChild;for(var afterText=after,afterDepth=1;!afterText.isTextblock;afterText=afterText.firstChild)afterDepth++;if(at.canReplace(at.childCount,at.childCount,afterText.content)){if(dispatch){for(var end$1=prosemirror_model_dist_index_es.c.empty,i$1=wrap$1.length-1;i$1>=0;i$1--)end$1=prosemirror_model_dist_index_es.c.from(wrap$1[i$1].copy(end$1));dispatch(state.tr.step(new dist_index_es.b($cut.pos-wrap$1.length,$cut.pos+after.nodeSize,$cut.pos+afterDepth,$cut.pos+after.nodeSize-afterDepth,new prosemirror_model_dist_index_es.j(end$1,wrap$1.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function setBlockType(nodeType,attrs){return function(state,dispatch){var ref=state.selection,from=ref.from,to=ref.to,applicable=!1;return state.doc.nodesBetween(from,to,(function(node,pos){if(applicable)return!1;if(node.isTextblock&&!node.hasMarkup(nodeType,attrs))if(node.type==nodeType)applicable=!0;else{var $pos=state.doc.resolve(pos),index=$pos.index();applicable=$pos.parent.canReplaceWith(index,index+1,nodeType)}})),!!applicable&&(dispatch&&dispatch(state.tr.setBlockType(from,to,nodeType,attrs).scrollIntoView()),!0)}}function chainCommands(){for(var commands=[],len=arguments.length;len--;)commands[len]=arguments[len];return function(state,dispatch,view){for(var i=0;i<commands.length;i++)if(commands[i](state,dispatch,view))return!0;return!1}}var backspace=chainCommands(deleteSelection,joinBackward,selectNodeBackward),del=chainCommands(deleteSelection,joinForward,selectNodeForward),pcBaseKeymap={Enter:chainCommands(newlineInCode,createParagraphNear,liftEmptyBlock,splitBlock),"Mod-Enter":exitCode,Backspace:backspace,"Mod-Backspace":backspace,"Shift-Backspace":backspace,Delete:del,"Mod-Delete":del,"Mod-a":function selectAll(state,dispatch){return dispatch&&dispatch(state.tr.setSelection(new index_es.a(state.doc))),!0}},macBaseKeymap={"Ctrl-h":pcBaseKeymap.Backspace,"Alt-Backspace":pcBaseKeymap["Mod-Backspace"],"Ctrl-d":pcBaseKeymap.Delete,"Ctrl-Alt-Backspace":pcBaseKeymap["Mod-Delete"],"Alt-Delete":pcBaseKeymap["Mod-Delete"],"Alt-d":pcBaseKeymap["Mod-Delete"]};for(var key in pcBaseKeymap)macBaseKeymap[key]=pcBaseKeymap[key];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform();function wrapInList(listType,attrs){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to),doJoin=!1,outerRange=range;if(!range)return!1;if(range.depth>=2&&$from.node(range.depth-1).type.compatibleContent(listType)&&0==range.startIndex){if(0==$from.index(range.depth-1))return!1;var $insert=state.doc.resolve(range.start-2);outerRange=new prosemirror_model_dist_index_es.g($insert,$insert,range.depth),range.endIndex<range.parent.childCount&&(range=new prosemirror_model_dist_index_es.g($from,state.doc.resolve($to.end(range.depth)),range.depth)),doJoin=!0}var wrap=Object(dist_index_es.h)(outerRange,listType,attrs,range);return!!wrap&&(dispatch&&dispatch(function doWrapInList(tr,range,wrappers,joinBefore,listType){for(var content=prosemirror_model_dist_index_es.c.empty,i=wrappers.length-1;i>=0;i--)content=prosemirror_model_dist_index_es.c.from(wrappers[i].type.create(wrappers[i].attrs,content));tr.step(new dist_index_es.b(range.start-(joinBefore?2:0),range.end,range.start,range.end,new prosemirror_model_dist_index_es.j(content,0,0),wrappers.length,!0));for(var found=0,i$1=0;i$1<wrappers.length;i$1++)wrappers[i$1].type==listType&&(found=i$1+1);for(var splitDepth=wrappers.length-found,splitPos=range.start+wrappers.length-(joinBefore?2:0),parent=range.parent,i$2=range.startIndex,e=range.endIndex,first=!0;i$2<e;i$2++,first=!1)!first&&Object(dist_index_es.f)(tr.doc,splitPos,splitDepth)&&(tr.split(splitPos,splitDepth),splitPos+=2*splitDepth),splitPos+=parent.child(i$2).nodeSize;return tr}(state.tr,range,wrap,doJoin,listType).scrollIntoView()),!0)}}function liftListItem(itemType){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to,(function(node){return node.childCount&&node.firstChild.type==itemType}));return!!range&&(!dispatch||($from.node(range.depth-1).type==itemType?function liftToOuterList(state,dispatch,itemType,range){var tr=state.tr,end=range.end,endOfList=range.$to.end(range.depth);end<endOfList&&(tr.step(new dist_index_es.b(end-1,endOfList,end,endOfList,new prosemirror_model_dist_index_es.j(prosemirror_model_dist_index_es.c.from(itemType.create(null,range.parent.copy())),1,0),1,!0)),range=new prosemirror_model_dist_index_es.g(tr.doc.resolve(range.$from.pos),tr.doc.resolve(endOfList),range.depth));return dispatch(tr.lift(range,Object(dist_index_es.j)(range)).scrollIntoView()),!0}(state,dispatch,itemType,range):function liftOutOfList(state,dispatch,range){for(var tr=state.tr,list=range.parent,pos=range.end,i=range.endIndex-1,e=range.startIndex;i>e;i--)pos-=list.child(i).nodeSize,tr.delete(pos-1,pos+1);var $start=tr.doc.resolve(range.start),item=$start.nodeAfter;if(tr.mapping.map(range.end)!=range.start+$start.nodeAfter.nodeSize)return!1;var atStart=0==range.startIndex,atEnd=range.endIndex==list.childCount,parent=$start.node(-1),indexBefore=$start.index(-1);if(!parent.canReplace(indexBefore+(atStart?0:1),indexBefore+1,item.content.append(atEnd?prosemirror_model_dist_index_es.c.empty:prosemirror_model_dist_index_es.c.from(list))))return!1;var start=$start.pos,end=start+item.nodeSize;return tr.step(new dist_index_es.b(start-(atStart?1:0),end+(atEnd?1:0),start+1,end-1,new prosemirror_model_dist_index_es.j((atStart?prosemirror_model_dist_index_es.c.empty:prosemirror_model_dist_index_es.c.from(list.copy(prosemirror_model_dist_index_es.c.empty))).append(atEnd?prosemirror_model_dist_index_es.c.empty:prosemirror_model_dist_index_es.c.from(list.copy(prosemirror_model_dist_index_es.c.empty))),atStart?0:1,atEnd?0:1),atStart?0:1)),dispatch(tr.scrollIntoView()),!0}(state,dispatch,range)))}}var prosemirror_view_dist_index_es=__webpack_require__(3585),prosemirror_keymap_dist_index_es=__webpack_require__(3607);function isPlainObject(value){return"Object"===function getType(value){return Object.prototype.toString.call(value).slice(8,-1)}(value)&&(value.constructor===Object&&Object.getPrototypeOf(value)===Object.prototype)}function mergeDeep(target,source){const output={...target};return isPlainObject(target)&&isPlainObject(source)&&Object.keys(source).forEach((key=>{isPlainObject(source[key])?key in target?output[key]=mergeDeep(target[key],source[key]):Object.assign(output,{[key]:source[key]}):Object.assign(output,{[key]:source[key]})})),output}function isFunction(value){return"function"==typeof value}function callOrReturn(value,context,...props){return isFunction(value)?context?value.bind(context)(...props):value(...props):value}function getExtensionField(extension,field,context){if(void 0===extension.config[field]&&extension.parent)return getExtensionField(extension.parent,field,context);if("function"==typeof extension.config[field]){return extension.config[field].bind({...context,parent:extension.parent?getExtensionField(extension.parent,field,context):null})}return extension.config[field]}class Extension{constructor(config={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...config},this.name=this.config.name,config.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(config={}){return new Extension(config)}configure(options={}){const extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}extend(extendedConfig={}){const extension=new Extension(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${extension.name}".`),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}function getTextBetween(startNode,range,options){const{from:from,to:to}=range,{blockSeparator:blockSeparator="\n\n",textSerializers:textSerializers={}}=options||{};let text="",separated=!0;return startNode.nodesBetween(from,to,((node,pos,parent,index)=>{var _a;const textSerializer=null==textSerializers?void 0:textSerializers[node.type.name];textSerializer?(node.isBlock&&!separated&&(text+=blockSeparator,separated=!0),text+=textSerializer({node:node,pos:pos,parent:parent,index:index})):node.isText?(text+=null===(_a=null==node?void 0:node.text)||void 0===_a?void 0:_a.slice(Math.max(from,pos)-pos,to-pos),separated=!1):node.isBlock&&!separated&&(text+=blockSeparator,separated=!0)})),text}function getTextSeralizersFromSchema(schema){return Object.fromEntries(Object.entries(schema.nodes).filter((([,node])=>node.spec.toText)).map((([name,node])=>[name,node.spec.toText])))}const ClipboardTextSerializer=Extension.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new index_es.d({key:new index_es.e("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:editor}=this,{state:state,schema:schema}=editor,{doc:doc,selection:selection}=state,{ranges:ranges}=selection,from=Math.min(...ranges.map((range=>range.$from.pos))),to=Math.max(...ranges.map((range=>range.$to.pos)));return getTextBetween(doc,{from:from,to:to},{textSerializers:getTextSeralizersFromSchema(schema)})}}})]}});var blur$1=Object.freeze({__proto__:null,blur:()=>({editor:editor,view:view})=>(requestAnimationFrame((()=>{editor.isDestroyed||view.dom.blur()})),!0)});var clearContent$1=Object.freeze({__proto__:null,clearContent:(emitUpdate=!1)=>({commands:commands})=>commands.setContent("",emitUpdate)});var clearNodes$1=Object.freeze({__proto__:null,clearNodes:()=>({state:state,tr:tr,dispatch:dispatch})=>{const{selection:selection}=tr,{ranges:ranges}=selection;return!dispatch||(ranges.forEach((({$from:$from,$to:$to})=>{state.doc.nodesBetween($from.pos,$to.pos,((node,pos)=>{if(node.type.isText)return;const{doc:doc,mapping:mapping}=tr,$mappedFrom=doc.resolve(mapping.map(pos)),$mappedTo=doc.resolve(mapping.map(pos+node.nodeSize)),nodeRange=$mappedFrom.blockRange($mappedTo);if(!nodeRange)return;const targetLiftDepth=Object(dist_index_es.j)(nodeRange);if(node.type.isTextblock){const{defaultType:defaultType}=$mappedFrom.parent.contentMatchAt($mappedFrom.index());tr.setNodeMarkup(nodeRange.start,defaultType)}(targetLiftDepth||0===targetLiftDepth)&&tr.lift(nodeRange,targetLiftDepth)}))})),!0)}});var command$1=Object.freeze({__proto__:null,command:fn=>props=>fn(props)});var createParagraphNear$1=Object.freeze({__proto__:null,createParagraphNear:()=>({state:state,dispatch:dispatch})=>createParagraphNear(state,dispatch)});function getNodeType(nameOrType,schema){if("string"==typeof nameOrType){if(!schema.nodes[nameOrType])throw Error(`There is no node type named '${nameOrType}'. Maybe you forgot to add the extension?`);return schema.nodes[nameOrType]}return nameOrType}var deleteNode$1=Object.freeze({__proto__:null,deleteNode:typeOrName=>({tr:tr,state:state,dispatch:dispatch})=>{const type=getNodeType(typeOrName,state.schema),$pos=tr.selection.$anchor;for(let depth=$pos.depth;depth>0;depth-=1){if($pos.node(depth).type===type){if(dispatch){const from=$pos.before(depth),to=$pos.after(depth);tr.delete(from,to).scrollIntoView()}return!0}}return!1}});var deleteRange$1=Object.freeze({__proto__:null,deleteRange:range=>({tr:tr,dispatch:dispatch})=>{const{from:from,to:to}=range;return dispatch&&tr.delete(from,to),!0}});var deleteSelection$1=Object.freeze({__proto__:null,deleteSelection:()=>({state:state,dispatch:dispatch})=>deleteSelection(state,dispatch)});var enter$1=Object.freeze({__proto__:null,enter:()=>({commands:commands})=>commands.keyboardShortcut("Enter")});var exitCode$1=Object.freeze({__proto__:null,exitCode:()=>({state:state,dispatch:dispatch})=>exitCode(state,dispatch)});function getMarkType(nameOrType,schema){if("string"==typeof nameOrType){if(!schema.marks[nameOrType])throw Error(`There is no mark type named '${nameOrType}'. Maybe you forgot to add the extension?`);return schema.marks[nameOrType]}return nameOrType}function isRegExp(value){return"[object RegExp]"===Object.prototype.toString.call(value)}function objectIncludes(object1,object2,options={strict:!0}){const keys=Object.keys(object2);return!keys.length||keys.every((key=>options.strict?object2[key]===object1[key]:isRegExp(object2[key])?object2[key].test(object1[key]):object2[key]===object1[key]))}function findMarkInSet(marks,type,attributes={}){return marks.find((item=>item.type===type&&objectIncludes(item.attrs,attributes)))}function isMarkInSet(marks,type,attributes={}){return!!findMarkInSet(marks,type,attributes)}function getMarkRange($pos,type,attributes={}){if(!$pos||!type)return;const start=$pos.parent.childAfter($pos.parentOffset);if(!start.node)return;const mark=findMarkInSet(start.node.marks,type,attributes);if(!mark)return;let startIndex=$pos.index(),startPos=$pos.start()+start.offset,endIndex=startIndex+1,endPos=startPos+start.node.nodeSize;for(findMarkInSet(start.node.marks,type,attributes);startIndex>0&&mark.isInSet($pos.parent.child(startIndex-1).marks);)startIndex-=1,startPos-=$pos.parent.child(startIndex).nodeSize;for(;endIndex<$pos.parent.childCount&&isMarkInSet($pos.parent.child(endIndex).marks,type,attributes);)endPos+=$pos.parent.child(endIndex).nodeSize,endIndex+=1;return{from:startPos,to:endPos}}var extendMarkRange$1=Object.freeze({__proto__:null,extendMarkRange:(typeOrName,attributes={})=>({tr:tr,state:state,dispatch:dispatch})=>{const type=getMarkType(typeOrName,state.schema),{doc:doc,selection:selection}=tr,{$from:$from,from:from,to:to}=selection;if(dispatch){const range=getMarkRange($from,type,attributes);if(range&&range.from<=from&&range.to>=to){const newSelection=index_es.g.create(doc,range.from,range.to);tr.setSelection(newSelection)}}return!0}});var first$1=Object.freeze({__proto__:null,first:commands=>props=>{const items="function"==typeof commands?commands(props):commands;for(let i=0;i<items.length;i+=1)if(items[i](props))return!0;return!1}});function isObject(value){return value&&"object"==typeof value&&!Array.isArray(value)&&!function isClass(value){var _a;return"class"===(null===(_a=value.constructor)||void 0===_a?void 0:_a.toString().substring(0,5))}(value)}function isTextSelection(value){return isObject(value)&&value instanceof index_es.g}function isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function minMax(value=0,min=0,max=0){return Math.min(Math.max(value,min),max)}function resolveFocusPosition(doc,position=null){if(!position)return null;if("start"===position||!0===position)return index_es.f.atStart(doc);if("end"===position)return index_es.f.atEnd(doc);if("all"===position)return index_es.g.create(doc,0,doc.content.size);const minPos=index_es.f.atStart(doc).from,maxPos=index_es.f.atEnd(doc).to,resolvedFrom=minMax(position,minPos,maxPos),resolvedEnd=minMax(position,minPos,maxPos);return index_es.g.create(doc,resolvedFrom,resolvedEnd)}var focus$1=Object.freeze({__proto__:null,focus:(position=null,options)=>({editor:editor,view:view,tr:tr,dispatch:dispatch})=>{options={scrollIntoView:!0,...options};const delayedFocus=()=>{isiOS()&&view.dom.focus(),requestAnimationFrame((()=>{editor.isDestroyed||(view.focus(),(null==options?void 0:options.scrollIntoView)&&editor.commands.scrollIntoView())}))};if(view.hasFocus()&&null===position||!1===position)return!0;if(dispatch&&null===position&&!isTextSelection(editor.state.selection))return delayedFocus(),!0;const selection=resolveFocusPosition(editor.state.doc,position)||editor.state.selection,isSameSelection=editor.state.selection.eq(selection);return dispatch&&(isSameSelection||tr.setSelection(selection),isSameSelection&&tr.storedMarks&&tr.setStoredMarks(tr.storedMarks),delayedFocus()),!0}});var forEach$1=Object.freeze({__proto__:null,forEach:(items,fn)=>props=>items.every(((item,index)=>fn(item,{...props,index:index})))});var insertContent$1=Object.freeze({__proto__:null,insertContent:(value,options)=>({tr:tr,commands:commands})=>commands.insertContentAt({from:tr.selection.from,to:tr.selection.to},value,options)});function elementFromString(value){const wrappedValue=`<body>${value}</body>`;return(new window.DOMParser).parseFromString(wrappedValue,"text/html").body}function createNodeFromContent(content,schema,options){if(options={slice:!0,parseOptions:{},...options},"object"==typeof content&&null!==content)try{return Array.isArray(content)?prosemirror_model_dist_index_es.c.fromArray(content.map((item=>schema.nodeFromJSON(item)))):schema.nodeFromJSON(content)}catch(error){return console.warn("[tiptap warn]: Invalid content.","Passed value:",content,"Error:",error),createNodeFromContent("",schema,options)}if("string"==typeof content){const parser=prosemirror_model_dist_index_es.a.fromSchema(schema);return options.slice?parser.parseSlice(elementFromString(content),options.parseOptions).content:parser.parse(elementFromString(content),options.parseOptions)}return createNodeFromContent("",schema,options)}var insertContentAt$1=Object.freeze({__proto__:null,insertContentAt:(position,value,options)=>({tr:tr,dispatch:dispatch,editor:editor})=>{if(dispatch){options={parseOptions:{},updateSelection:!0,...options};const content=createNodeFromContent(value,editor.schema,{parseOptions:{preserveWhitespace:"full",...options.parseOptions}});if("<>"===content.toString())return!0;let{from:from,to:to}="number"==typeof position?{from:position,to:position}:position,isOnlyBlockContent=!0;if((content.toString().startsWith("<")?content:[content]).forEach((node=>{node.check(),isOnlyBlockContent=!!isOnlyBlockContent&&node.isBlock})),from===to&&isOnlyBlockContent){const{parent:parent}=tr.doc.resolve(from);parent.isTextblock&&!parent.type.spec.code&&!parent.childCount&&(from-=1,to+=1)}tr.replaceWith(from,to,content),options.updateSelection&&function selectionToInsertionEnd(tr,startLen,bias){const last=tr.steps.length-1;if(last<startLen)return;const step=tr.steps[last];if(!(step instanceof dist_index_es.c||step instanceof dist_index_es.b))return;const map=tr.mapping.maps[last];let end=0;map.forEach(((_from,_to,_newFrom,newTo)=>{0===end&&(end=newTo)})),tr.setSelection(index_es.f.near(tr.doc.resolve(end),bias))}(tr,tr.steps.length-1,-1)}return!0}});var joinBackward$1=Object.freeze({__proto__:null,joinBackward:()=>({state:state,dispatch:dispatch})=>joinBackward(state,dispatch)});var joinForward$1=Object.freeze({__proto__:null,joinForward:()=>({state:state,dispatch:dispatch})=>joinForward(state,dispatch)});const tiptap_core_esm_mac="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);var keyboardShortcut$1=Object.freeze({__proto__:null,keyboardShortcut:name=>({editor:editor,view:view,tr:tr,dispatch:dispatch})=>{const keys=function normalizeKeyName(name){const parts=name.split(/-(?!$)/);let alt,ctrl,shift,meta,result=parts[parts.length-1];"Space"===result&&(result=" ");for(let i=0;i<parts.length-1;i+=1){const mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=!0;else{if(!/^mod$/i.test(mod))throw new Error(`Unrecognized modifier name: ${mod}`);tiptap_core_esm_mac?meta=!0:ctrl=!0}}return alt&&(result=`Alt-${result}`),ctrl&&(result=`Ctrl-${result}`),meta&&(result=`Meta-${result}`),shift&&(result=`Shift-${result}`),result}(name).split(/-(?!$)/),key=keys.find((item=>!["Alt","Ctrl","Meta","Shift"].includes(item))),event=new KeyboardEvent("keydown",{key:"Space"===key?" ":key,altKey:keys.includes("Alt"),ctrlKey:keys.includes("Ctrl"),metaKey:keys.includes("Meta"),shiftKey:keys.includes("Shift"),bubbles:!0,cancelable:!0}),capturedTransaction=editor.captureTransaction((()=>{view.someProp("handleKeyDown",(f=>f(view,event)))}));return null==capturedTransaction||capturedTransaction.steps.forEach((step=>{const newStep=step.map(tr.mapping);newStep&&dispatch&&tr.maybeStep(newStep)})),!0}});function isNodeActive(state,typeOrName,attributes={}){const{from:from,to:to,empty:empty}=state.selection,type=typeOrName?getNodeType(typeOrName,state.schema):null,nodeRanges=[];state.doc.nodesBetween(from,to,((node,pos)=>{if(node.isText)return;const relativeFrom=Math.max(from,pos),relativeTo=Math.min(to,pos+node.nodeSize);nodeRanges.push({node:node,from:relativeFrom,to:relativeTo})}));const selectionRange=to-from,matchedNodeRanges=nodeRanges.filter((nodeRange=>!type||type.name===nodeRange.node.type.name)).filter((nodeRange=>objectIncludes(nodeRange.node.attrs,attributes,{strict:!1})));if(empty)return!!matchedNodeRanges.length;return matchedNodeRanges.reduce(((sum,nodeRange)=>sum+nodeRange.to-nodeRange.from),0)>=selectionRange}var lift$1=Object.freeze({__proto__:null,lift:(typeOrName,attributes={})=>({state:state,dispatch:dispatch})=>!!isNodeActive(state,getNodeType(typeOrName,state.schema),attributes)&&function lift(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to),target=range&&Object(dist_index_es.j)(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}(state,dispatch)});var liftEmptyBlock$1=Object.freeze({__proto__:null,liftEmptyBlock:()=>({state:state,dispatch:dispatch})=>liftEmptyBlock(state,dispatch)});var liftListItem$1=Object.freeze({__proto__:null,liftListItem:typeOrName=>({state:state,dispatch:dispatch})=>liftListItem(getNodeType(typeOrName,state.schema))(state,dispatch)});var newlineInCode$1=Object.freeze({__proto__:null,newlineInCode:()=>({state:state,dispatch:dispatch})=>newlineInCode(state,dispatch)});function getSchemaTypeNameByName(name,schema){return schema.nodes[name]?"node":schema.marks[name]?"mark":null}function deleteProps(obj,propOrProps){const props="string"==typeof propOrProps?[propOrProps]:propOrProps;return Object.keys(obj).reduce(((newObj,prop)=>(props.includes(prop)||(newObj[prop]=obj[prop]),newObj)),{})}var resetAttributes$1=Object.freeze({__proto__:null,resetAttributes:(typeOrName,attributes)=>({tr:tr,state:state,dispatch:dispatch})=>{let nodeType=null,markType=null;const schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return!!schemaType&&("node"===schemaType&&(nodeType=getNodeType(typeOrName,state.schema)),"mark"===schemaType&&(markType=getMarkType(typeOrName,state.schema)),dispatch&&tr.selection.ranges.forEach((range=>{state.doc.nodesBetween(range.$from.pos,range.$to.pos,((node,pos)=>{nodeType&&nodeType===node.type&&tr.setNodeMarkup(pos,void 0,deleteProps(node.attrs,attributes)),markType&&node.marks.length&&node.marks.forEach((mark=>{markType===mark.type&&tr.addMark(pos,pos+node.nodeSize,markType.create(deleteProps(mark.attrs,attributes)))}))}))})),!0)}});var scrollIntoView$1=Object.freeze({__proto__:null,scrollIntoView:()=>({tr:tr,dispatch:dispatch})=>(dispatch&&tr.scrollIntoView(),!0)});var selectAll$1=Object.freeze({__proto__:null,selectAll:()=>({tr:tr,commands:commands})=>commands.setTextSelection({from:0,to:tr.doc.content.size})});var selectNodeBackward$1=Object.freeze({__proto__:null,selectNodeBackward:()=>({state:state,dispatch:dispatch})=>selectNodeBackward(state,dispatch)});var selectNodeForward$1=Object.freeze({__proto__:null,selectNodeForward:()=>({state:state,dispatch:dispatch})=>selectNodeForward(state,dispatch)});var selectParentNode$1=Object.freeze({__proto__:null,selectParentNode:()=>({state:state,dispatch:dispatch})=>function selectParentNode(state,dispatch){var pos,ref=state.selection,$from=ref.$from,to=ref.to,same=$from.sharedDepth(to);return 0!=same&&(pos=$from.before(same),dispatch&&dispatch(state.tr.setSelection(index_es.c.create(state.doc,pos))),!0)}(state,dispatch)});function createDocument(content,schema,parseOptions={}){return createNodeFromContent(content,schema,{slice:!1,parseOptions:parseOptions})}var setContent$1=Object.freeze({__proto__:null,setContent:(content,emitUpdate=!1,parseOptions={})=>({tr:tr,editor:editor,dispatch:dispatch})=>{const{doc:doc}=tr,document=createDocument(content,editor.schema,parseOptions),selection=index_es.g.create(doc,0,doc.content.size);return dispatch&&tr.setSelection(selection).replaceSelectionWith(document,!1).setMeta("preventUpdate",!emitUpdate),!0}});function getMarkAttributes(state,typeOrName){const type=getMarkType(typeOrName,state.schema),{from:from,to:to,empty:empty}=state.selection,marks=[];empty?(state.storedMarks&&marks.push(...state.storedMarks),marks.push(...state.selection.$head.marks())):state.doc.nodesBetween(from,to,(node=>{marks.push(...node.marks)}));const mark=marks.find((markItem=>markItem.type.name===type.name));return mark?{...mark.attrs}:{}}var setMark$1=Object.freeze({__proto__:null,setMark:(typeOrName,attributes={})=>({tr:tr,state:state,dispatch:dispatch})=>{const{selection:selection}=tr,{empty:empty,ranges:ranges}=selection,type=getMarkType(typeOrName,state.schema);if(dispatch)if(empty){const oldAttributes=getMarkAttributes(state,type);tr.addStoredMark(type.create({...oldAttributes,...attributes}))}else ranges.forEach((range=>{const from=range.$from.pos,to=range.$to.pos;state.doc.nodesBetween(from,to,((node,pos)=>{const trimmedFrom=Math.max(pos,from),trimmedTo=Math.min(pos+node.nodeSize,to);node.marks.find((mark=>mark.type===type))?node.marks.forEach((mark=>{type===mark.type&&tr.addMark(trimmedFrom,trimmedTo,type.create({...mark.attrs,...attributes}))})):tr.addMark(trimmedFrom,trimmedTo,type.create(attributes))}))}));return!0}});var setMeta$1=Object.freeze({__proto__:null,setMeta:(key,value)=>({tr:tr})=>(tr.setMeta(key,value),!0)});var setNode$1=Object.freeze({__proto__:null,setNode:(typeOrName,attributes={})=>({state:state,dispatch:dispatch,chain:chain})=>{const type=getNodeType(typeOrName,state.schema);return type.isTextblock?chain().command((({commands:commands})=>!!setBlockType(type,attributes)(state)||commands.clearNodes())).command((({state:updatedState})=>setBlockType(type,attributes)(updatedState,dispatch))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}});var setNodeSelection$1=Object.freeze({__proto__:null,setNodeSelection:position=>({tr:tr,dispatch:dispatch})=>{if(dispatch){const{doc:doc}=tr,minPos=index_es.f.atStart(doc).from,maxPos=index_es.f.atEnd(doc).to,resolvedPos=minMax(position,minPos,maxPos),selection=index_es.c.create(doc,resolvedPos);tr.setSelection(selection)}return!0}});var setTextSelection$1=Object.freeze({__proto__:null,setTextSelection:position=>({tr:tr,dispatch:dispatch})=>{if(dispatch){const{doc:doc}=tr,{from:from,to:to}="number"==typeof position?{from:position,to:position}:position,minPos=index_es.f.atStart(doc).from,maxPos=index_es.f.atEnd(doc).to,resolvedFrom=minMax(from,minPos,maxPos),resolvedEnd=minMax(to,minPos,maxPos),selection=index_es.g.create(doc,resolvedFrom,resolvedEnd);tr.setSelection(selection)}return!0}});var sinkListItem$1=Object.freeze({__proto__:null,sinkListItem:typeOrName=>({state:state,dispatch:dispatch})=>function sinkListItem(itemType){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to,(function(node){return node.childCount&&node.firstChild.type==itemType}));if(!range)return!1;var startIndex=range.startIndex;if(0==startIndex)return!1;var parent=range.parent,nodeBefore=parent.child(startIndex-1);if(nodeBefore.type!=itemType)return!1;if(dispatch){var nestedBefore=nodeBefore.lastChild&&nodeBefore.lastChild.type==parent.type,inner=prosemirror_model_dist_index_es.c.from(nestedBefore?itemType.create():null),slice=new prosemirror_model_dist_index_es.j(prosemirror_model_dist_index_es.c.from(itemType.create(null,prosemirror_model_dist_index_es.c.from(parent.type.create(null,inner)))),nestedBefore?3:1,0),before=range.start,after=range.end;dispatch(state.tr.step(new dist_index_es.b(before-(nestedBefore?3:1),after,before,after,slice,1,!0)).scrollIntoView())}return!0}}(getNodeType(typeOrName,state.schema))(state,dispatch)});function getSplittedAttributes(extensionAttributes,typeName,attributes){return Object.fromEntries(Object.entries(attributes).filter((([name])=>{const extensionAttribute=extensionAttributes.find((item=>item.type===typeName&&item.name===name));return!!extensionAttribute&&extensionAttribute.attribute.keepOnSplit})))}function ensureMarks(state,splittableMarks){const marks=state.storedMarks||state.selection.$to.parentOffset&&state.selection.$from.marks();if(marks){const filteredMarks=marks.filter((mark=>null==splittableMarks?void 0:splittableMarks.includes(mark.type.name)));state.tr.ensureMarks(filteredMarks)}}var splitBlock$1=Object.freeze({__proto__:null,splitBlock:({keepMarks:keepMarks=!0}={})=>({tr:tr,state:state,dispatch:dispatch,editor:editor})=>{const{selection:selection,doc:doc}=tr,{$from:$from,$to:$to}=selection,newAttributes=getSplittedAttributes(editor.extensionManager.attributes,$from.node().type.name,$from.node().attrs);if(selection instanceof index_es.c&&selection.node.isBlock)return!(!$from.parentOffset||!Object(dist_index_es.f)(doc,$from.pos))&&(dispatch&&(keepMarks&&ensureMarks(state,editor.extensionManager.splittableMarks),tr.split($from.pos).scrollIntoView()),!0);if(!$from.parent.isBlock)return!1;if(dispatch){const atEnd=$to.parentOffset===$to.parent.content.size;selection instanceof index_es.g&&tr.deleteSelection();const deflt=0===$from.depth?void 0:function defaultBlockAt$1(match){for(let i=0;i<match.edgeCount;i+=1){const{type:type}=match.edge(i);if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}($from.node(-1).contentMatchAt($from.indexAfter(-1)));let types=atEnd&&deflt?[{type:deflt,attrs:newAttributes}]:void 0,can=Object(dist_index_es.f)(tr.doc,tr.mapping.map($from.pos),1,types);if(types||can||!Object(dist_index_es.f)(tr.doc,tr.mapping.map($from.pos),1,deflt?[{type:deflt}]:void 0)||(can=!0,types=deflt?[{type:deflt,attrs:newAttributes}]:void 0),can&&(tr.split(tr.mapping.map($from.pos),1,types),deflt&&!atEnd&&!$from.parentOffset&&$from.parent.type!==deflt)){const first=tr.mapping.map($from.before()),$first=tr.doc.resolve(first);$from.node(-1).canReplaceWith($first.index(),$first.index()+1,deflt)&&tr.setNodeMarkup(tr.mapping.map($from.before()),deflt)}keepMarks&&ensureMarks(state,editor.extensionManager.splittableMarks),tr.scrollIntoView()}return!0}});var splitListItem$1=Object.freeze({__proto__:null,splitListItem:typeOrName=>({tr:tr,state:state,dispatch:dispatch,editor:editor})=>{var _a;const type=getNodeType(typeOrName,state.schema),{$from:$from,$to:$to}=state.selection,node=state.selection.node;if(node&&node.isBlock||$from.depth<2||!$from.sameParent($to))return!1;const grandParent=$from.node(-1);if(grandParent.type!==type)return!1;const extensionAttributes=editor.extensionManager.attributes;if(0===$from.parent.content.size&&$from.node(-1).childCount===$from.indexAfter(-1)){if(2===$from.depth||$from.node(-3).type!==type||$from.index(-2)!==$from.node(-2).childCount-1)return!1;if(dispatch){let wrap=prosemirror_model_dist_index_es.c.empty;const depthBefore=$from.index(-1)?1:$from.index(-2)?2:3;for(let d=$from.depth-depthBefore;d>=$from.depth-3;d-=1)wrap=prosemirror_model_dist_index_es.c.from($from.node(d).copy(wrap));const depthAfter=$from.indexAfter(-1)<$from.node(-2).childCount?1:$from.indexAfter(-2)<$from.node(-3).childCount?2:3,newNextTypeAttributes=getSplittedAttributes(extensionAttributes,$from.node().type.name,$from.node().attrs),nextType=(null===(_a=type.contentMatch.defaultType)||void 0===_a?void 0:_a.createAndFill(newNextTypeAttributes))||void 0;wrap=wrap.append(prosemirror_model_dist_index_es.c.from(type.createAndFill(null,nextType)||void 0));const start=$from.before($from.depth-(depthBefore-1));tr.replace(start,$from.after(-depthAfter),new prosemirror_model_dist_index_es.j(wrap,4-depthBefore,0));let sel=-1;tr.doc.nodesBetween(start,tr.doc.content.size,((n,pos)=>{if(sel>-1)return!1;n.isTextblock&&0===n.content.size&&(sel=pos+1)})),sel>-1&&tr.setSelection(index_es.g.near(tr.doc.resolve(sel))),tr.scrollIntoView()}return!0}const nextType=$to.pos===$from.end()?grandParent.contentMatchAt(0).defaultType:null,newTypeAttributes=getSplittedAttributes(extensionAttributes,grandParent.type.name,grandParent.attrs),newNextTypeAttributes=getSplittedAttributes(extensionAttributes,$from.node().type.name,$from.node().attrs);tr.delete($from.pos,$to.pos);const types=nextType?[{type:type,attrs:newTypeAttributes},{type:nextType,attrs:newNextTypeAttributes}]:[{type:type,attrs:newTypeAttributes}];return!!Object(dist_index_es.f)(tr.doc,$from.pos,2)&&(dispatch&&tr.split($from.pos,2,types).scrollIntoView(),!0)}});function findParentNodeClosestToPos($pos,predicate){for(let i=$pos.depth;i>0;i-=1){const node=$pos.node(i);if(predicate(node))return{pos:i>0?$pos.before(i):0,start:$pos.start(i),depth:i,node:node}}}function findParentNode(predicate){return selection=>findParentNodeClosestToPos(selection.$from,predicate)}function splitExtensions(extensions){return{baseExtensions:extensions.filter((extension=>"extension"===extension.type)),nodeExtensions:extensions.filter((extension=>"node"===extension.type)),markExtensions:extensions.filter((extension=>"mark"===extension.type))}}function isList(name,extensions){const{nodeExtensions:nodeExtensions}=splitExtensions(extensions),extension=nodeExtensions.find((item=>item.name===name));if(!extension)return!1;const group=callOrReturn(getExtensionField(extension,"group",{name:extension.name,options:extension.options,storage:extension.storage}));return"string"==typeof group&&group.split(" ").includes("list")}const joinListBackwards=(tr,listType)=>{const list=findParentNode((node=>node.type===listType))(tr.selection);if(!list)return!0;const before=tr.doc.resolve(Math.max(0,list.pos-1)).before(list.depth);if(void 0===before)return!0;const nodeBefore=tr.doc.nodeAt(before);return list.node.type!==(null==nodeBefore?void 0:nodeBefore.type)||!Object(dist_index_es.e)(tr.doc,list.pos)||(tr.join(list.pos),!0)},joinListForwards=(tr,listType)=>{const list=findParentNode((node=>node.type===listType))(tr.selection);if(!list)return!0;const after=tr.doc.resolve(list.start).after(list.depth);if(void 0===after)return!0;const nodeAfter=tr.doc.nodeAt(after);return list.node.type!==(null==nodeAfter?void 0:nodeAfter.type)||!Object(dist_index_es.e)(tr.doc,after)||(tr.join(after),!0)};var toggleList$1=Object.freeze({__proto__:null,toggleList:(listTypeOrName,itemTypeOrName)=>({editor:editor,tr:tr,state:state,dispatch:dispatch,chain:chain,commands:commands,can:can})=>{const{extensions:extensions}=editor.extensionManager,listType=getNodeType(listTypeOrName,state.schema),itemType=getNodeType(itemTypeOrName,state.schema),{selection:selection}=state,{$from:$from,$to:$to}=selection,range=$from.blockRange($to);if(!range)return!1;const parentList=findParentNode((node=>isList(node.type.name,extensions)))(selection);if(range.depth>=1&&parentList&&range.depth-parentList.depth<=1){if(parentList.node.type===listType)return commands.liftListItem(itemType);if(isList(parentList.node.type.name,extensions)&&listType.validContent(parentList.node.content)&&dispatch)return chain().command((()=>(tr.setNodeMarkup(parentList.pos,listType),!0))).command((()=>joinListBackwards(tr,listType))).command((()=>joinListForwards(tr,listType))).run()}return chain().command((()=>!!can().wrapInList(listType)||commands.clearNodes())).wrapInList(listType).command((()=>joinListBackwards(tr,listType))).command((()=>joinListForwards(tr,listType))).run()}});function isMarkActive(state,typeOrName,attributes={}){const{empty:empty,ranges:ranges}=state.selection,type=typeOrName?getMarkType(typeOrName,state.schema):null;if(empty)return!!(state.storedMarks||state.selection.$from.marks()).filter((mark=>!type||type.name===mark.type.name)).find((mark=>objectIncludes(mark.attrs,attributes,{strict:!1})));let selectionRange=0;const markRanges=[];if(ranges.forEach((({$from:$from,$to:$to})=>{const from=$from.pos,to=$to.pos;state.doc.nodesBetween(from,to,((node,pos)=>{if(!node.isText&&!node.marks.length)return;const relativeFrom=Math.max(from,pos),relativeTo=Math.min(to,pos+node.nodeSize);selectionRange+=relativeTo-relativeFrom,markRanges.push(...node.marks.map((mark=>({mark:mark,from:relativeFrom,to:relativeTo}))))}))})),0===selectionRange)return!1;const matchedRange=markRanges.filter((markRange=>!type||type.name===markRange.mark.type.name)).filter((markRange=>objectIncludes(markRange.mark.attrs,attributes,{strict:!1}))).reduce(((sum,markRange)=>sum+markRange.to-markRange.from),0),excludedRange=markRanges.filter((markRange=>!type||markRange.mark.type!==type&&markRange.mark.type.excludes(type))).reduce(((sum,markRange)=>sum+markRange.to-markRange.from),0);return(matchedRange>0?matchedRange+excludedRange:matchedRange)>=selectionRange}var toggleMark$1=Object.freeze({__proto__:null,toggleMark:(typeOrName,attributes={},options={})=>({state:state,commands:commands})=>{const{extendEmptyMarkRange:extendEmptyMarkRange=!1}=options,type=getMarkType(typeOrName,state.schema);return isMarkActive(state,type,attributes)?commands.unsetMark(type,{extendEmptyMarkRange:extendEmptyMarkRange}):commands.setMark(type,attributes)}});var toggleNode$1=Object.freeze({__proto__:null,toggleNode:(typeOrName,toggleTypeOrName,attributes={})=>({state:state,commands:commands})=>{const type=getNodeType(typeOrName,state.schema),toggleType=getNodeType(toggleTypeOrName,state.schema);return isNodeActive(state,type,attributes)?commands.setNode(toggleType):commands.setNode(type,attributes)}});var toggleWrap$1=Object.freeze({__proto__:null,toggleWrap:(typeOrName,attributes={})=>({state:state,commands:commands})=>{const type=getNodeType(typeOrName,state.schema);return isNodeActive(state,type,attributes)?commands.lift(type):commands.wrapIn(type,attributes)}});var undoInputRule$1=Object.freeze({__proto__:null,undoInputRule:()=>({state:state,dispatch:dispatch})=>{const plugins=state.plugins;for(let i=0;i<plugins.length;i+=1){const plugin=plugins[i];let undoable;if(plugin.spec.isInputRules&&(undoable=plugin.getState(state))){if(dispatch){const tr=state.tr,toUndo=undoable.transform;for(let j=toUndo.steps.length-1;j>=0;j-=1)tr.step(toUndo.steps[j].invert(toUndo.docs[j]));if(undoable.text){const marks=tr.doc.resolve(undoable.from).marks();tr.replaceWith(undoable.from,undoable.to,state.schema.text(undoable.text,marks))}else tr.delete(undoable.from,undoable.to)}return!0}}return!1}});var unsetAllMarks$1=Object.freeze({__proto__:null,unsetAllMarks:()=>({tr:tr,dispatch:dispatch})=>{const{selection:selection}=tr,{empty:empty,ranges:ranges}=selection;return empty||dispatch&&ranges.forEach((range=>{tr.removeMark(range.$from.pos,range.$to.pos)})),!0}});var unsetMark$1=Object.freeze({__proto__:null,unsetMark:(typeOrName,options={})=>({tr:tr,state:state,dispatch:dispatch})=>{var _a;const{extendEmptyMarkRange:extendEmptyMarkRange=!1}=options,{selection:selection}=tr,type=getMarkType(typeOrName,state.schema),{$from:$from,empty:empty,ranges:ranges}=selection;if(!dispatch)return!0;if(empty&&extendEmptyMarkRange){let{from:from,to:to}=selection;const attrs=null===(_a=$from.marks().find((mark=>mark.type===type)))||void 0===_a?void 0:_a.attrs,range=getMarkRange($from,type,attrs);range&&(from=range.from,to=range.to),tr.removeMark(from,to,type)}else ranges.forEach((range=>{tr.removeMark(range.$from.pos,range.$to.pos,type)}));return tr.removeStoredMark(type),!0}});var updateAttributes$1=Object.freeze({__proto__:null,updateAttributes:(typeOrName,attributes={})=>({tr:tr,state:state,dispatch:dispatch})=>{let nodeType=null,markType=null;const schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return!!schemaType&&("node"===schemaType&&(nodeType=getNodeType(typeOrName,state.schema)),"mark"===schemaType&&(markType=getMarkType(typeOrName,state.schema)),dispatch&&tr.selection.ranges.forEach((range=>{const from=range.$from.pos,to=range.$to.pos;state.doc.nodesBetween(from,to,((node,pos)=>{nodeType&&nodeType===node.type&&tr.setNodeMarkup(pos,void 0,{...node.attrs,...attributes}),markType&&node.marks.length&&node.marks.forEach((mark=>{if(markType===mark.type){const trimmedFrom=Math.max(pos,from),trimmedTo=Math.min(pos+node.nodeSize,to);tr.addMark(trimmedFrom,trimmedTo,markType.create({...mark.attrs,...attributes}))}}))}))})),!0)}});var wrapIn$1=Object.freeze({__proto__:null,wrapIn:(typeOrName,attributes={})=>({state:state,dispatch:dispatch})=>function wrapIn(nodeType,attrs){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to),wrapping=range&&Object(dist_index_es.h)(range,nodeType,attrs);return!!wrapping&&(dispatch&&dispatch(state.tr.wrap(range,wrapping).scrollIntoView()),!0)}}(getNodeType(typeOrName,state.schema),attributes)(state,dispatch)});var wrapInList$1=Object.freeze({__proto__:null,wrapInList:(typeOrName,attributes={})=>({state:state,dispatch:dispatch})=>wrapInList(getNodeType(typeOrName,state.schema),attributes)(state,dispatch)});const Commands=Extension.create({name:"commands",addCommands:()=>({...blur$1,...clearContent$1,...clearNodes$1,...command$1,...createParagraphNear$1,...deleteNode$1,...deleteRange$1,...deleteSelection$1,...enter$1,...exitCode$1,...extendMarkRange$1,...first$1,...focus$1,...forEach$1,...insertContent$1,...insertContentAt$1,...joinBackward$1,...joinForward$1,...keyboardShortcut$1,...lift$1,...liftEmptyBlock$1,...liftListItem$1,...newlineInCode$1,...resetAttributes$1,...scrollIntoView$1,...selectAll$1,...selectNodeBackward$1,...selectNodeForward$1,...selectParentNode$1,...setContent$1,...setMark$1,...setMeta$1,...setNode$1,...setNodeSelection$1,...setTextSelection$1,...sinkListItem$1,...splitBlock$1,...splitListItem$1,...toggleList$1,...toggleMark$1,...toggleNode$1,...toggleWrap$1,...undoInputRule$1,...unsetAllMarks$1,...unsetMark$1,...updateAttributes$1,...wrapIn$1,...wrapInList$1})}),Editable=Extension.create({name:"editable",addProseMirrorPlugins(){return[new index_es.d({key:new index_es.e("editable"),props:{editable:()=>this.editor.options.editable}})]}}),FocusEvents=Extension.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:editor}=this;return[new index_es.d({key:new index_es.e("focusEvents"),props:{handleDOMEvents:{focus:(view,event)=>{editor.isFocused=!0;const transaction=editor.state.tr.setMeta("focus",{event:event}).setMeta("addToHistory",!1);return view.dispatch(transaction),!1},blur:(view,event)=>{editor.isFocused=!1;const transaction=editor.state.tr.setMeta("blur",{event:event}).setMeta("addToHistory",!1);return view.dispatch(transaction),!1}}}})]}});function createChainableState(config){const{state:state,transaction:transaction}=config;let{selection:selection}=transaction,{doc:doc}=transaction,{storedMarks:storedMarks}=transaction;return{...state,schema:state.schema,plugins:state.plugins,apply:state.apply.bind(state),applyTransaction:state.applyTransaction.bind(state),reconfigure:state.reconfigure.bind(state),toJSON:state.toJSON.bind(state),get storedMarks(){return storedMarks},get selection(){return selection},get doc(){return doc},get tr(){return selection=transaction.selection,doc=transaction.doc,storedMarks=transaction.storedMarks,transaction}}}class CommandManager{constructor(props){this.editor=props.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=props.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:rawCommands,editor:editor,state:state}=this,{view:view}=editor,{tr:tr}=state,props=this.buildProps(tr);return Object.fromEntries(Object.entries(rawCommands).map((([name,command])=>[name,(...args)=>{const callback=command(...args)(props);return tr.getMeta("preventDispatch")||this.hasCustomState||view.dispatch(tr),callback}])))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(startTr,shouldDispatch=!0){const{rawCommands:rawCommands,editor:editor,state:state}=this,{view:view}=editor,callbacks=[],hasStartTransaction=!!startTr,tr=startTr||state.tr,chain={...Object.fromEntries(Object.entries(rawCommands).map((([name,command])=>[name,(...args)=>{const props=this.buildProps(tr,shouldDispatch),callback=command(...args)(props);return callbacks.push(callback),chain}]))),run:()=>(hasStartTransaction||!shouldDispatch||tr.getMeta("preventDispatch")||this.hasCustomState||view.dispatch(tr),callbacks.every((callback=>!0===callback)))};return chain}createCan(startTr){const{rawCommands:rawCommands,state:state}=this,tr=startTr||state.tr,props=this.buildProps(tr,undefined),formattedCommands=Object.fromEntries(Object.entries(rawCommands).map((([name,command])=>[name,(...args)=>command(...args)({...props,dispatch:undefined})])));return{...formattedCommands,chain:()=>this.createChain(tr,undefined)}}buildProps(tr,shouldDispatch=!0){const{rawCommands:rawCommands,editor:editor,state:state}=this,{view:view}=editor;state.storedMarks&&tr.setStoredMarks(state.storedMarks);const props={tr:tr,editor:editor,view:view,state:createChainableState({state:state,transaction:tr}),dispatch:shouldDispatch?()=>{}:void 0,chain:()=>this.createChain(tr),can:()=>this.createCan(tr),get commands(){return Object.fromEntries(Object.entries(rawCommands).map((([name,command])=>[name,(...args)=>command(...args)(props)])))}};return props}}const Keymap=Extension.create({name:"keymap",addKeyboardShortcuts(){const handleBackspace=()=>this.editor.commands.first((({commands:commands})=>[()=>commands.undoInputRule(),()=>commands.command((({tr:tr})=>{const{selection:selection,doc:doc}=tr,{empty:empty,$anchor:$anchor}=selection,{pos:pos,parent:parent}=$anchor,isAtStart=index_es.f.atStart(doc).from===pos;return!(!(empty&&isAtStart&&parent.type.isTextblock)||parent.textContent.length)&&commands.clearNodes()})),()=>commands.deleteSelection(),()=>commands.joinBackward(),()=>commands.selectNodeBackward()])),handleDelete=()=>this.editor.commands.first((({commands:commands})=>[()=>commands.deleteSelection(),()=>commands.joinForward(),()=>commands.selectNodeForward()]));return{Enter:()=>this.editor.commands.first((({commands:commands})=>[()=>commands.newlineInCode(),()=>commands.createParagraphNear(),()=>commands.liftEmptyBlock(),()=>commands.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:handleBackspace,"Mod-Backspace":handleBackspace,"Shift-Backspace":handleBackspace,Delete:handleDelete,"Mod-Delete":handleDelete,"Mod-a":()=>this.editor.commands.selectAll()}},addProseMirrorPlugins(){return[new index_es.d({key:new index_es.e("clearDocument"),appendTransaction:(transactions,oldState,newState)=>{if(!(transactions.some((transaction=>transaction.docChanged))&&!oldState.doc.eq(newState.doc)))return;const{empty:empty,from:from,to:to}=oldState.selection,allFrom=index_es.f.atStart(oldState.doc).from,allEnd=index_es.f.atEnd(oldState.doc).to,allWasSelected=from===allFrom&&to===allEnd,isEmpty=0===newState.doc.textBetween(0,newState.doc.content.size," "," ").length;if(empty||!allWasSelected||!isEmpty)return;const tr=newState.tr,state=createChainableState({state:newState,transaction:tr}),{commands:commands}=new CommandManager({editor:this.editor,state:state});return commands.clearNodes(),tr.steps.length?tr:void 0}})]}}),Tabindex=Extension.create({name:"tabindex",addProseMirrorPlugins:()=>[new index_es.d({key:new index_es.e("tabindex"),props:{attributes:{tabindex:"0"}}})]});var tiptap_core_esm_extensions=Object.freeze({__proto__:null,ClipboardTextSerializer:ClipboardTextSerializer,Commands:Commands,Editable:Editable,FocusEvents:FocusEvents,Keymap:Keymap,Tabindex:Tabindex});function getNodeAttributes(state,typeOrName){const type=getNodeType(typeOrName,state.schema),{from:from,to:to}=state.selection,nodes=[];state.doc.nodesBetween(from,to,(node=>{nodes.push(node)}));const node=nodes.reverse().find((nodeItem=>nodeItem.type.name===type.name));return node?{...node.attrs}:{}}function getAttributes(state,typeOrName){const schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return"node"===schemaType?getNodeAttributes(state,typeOrName):"mark"===schemaType?getMarkAttributes(state,typeOrName):{}}function tiptap_core_esm_isActive(state,name,attributes={}){if(!name)return isNodeActive(state,null,attributes)||isMarkActive(state,null,attributes);const schemaType=getSchemaTypeNameByName(name,state.schema);return"node"===schemaType?isNodeActive(state,name,attributes):"mark"===schemaType&&isMarkActive(state,name,attributes)}function getHTMLFromFragment(fragment,schema){const documentFragment=prosemirror_model_dist_index_es.b.fromSchema(schema).serializeFragment(fragment),container=document.implementation.createHTMLDocument().createElement("div");return container.appendChild(documentFragment),container.innerHTML}function getText(node,options){return getTextBetween(node,{from:0,to:node.content.size},options)}function isNodeEmpty(node){var _a;const defaultContent=null===(_a=node.type.createAndFill())||void 0===_a?void 0:_a.toJSON(),content=node.toJSON();return JSON.stringify(defaultContent)===JSON.stringify(content)}class InputRule{constructor(config){this.find=config.find,this.handler=config.handler}}function run$1(config){var _a;const{editor:editor,from:from,to:to,text:text,rules:rules,plugin:plugin}=config,{view:view}=editor;if(view.composing)return!1;const $from=view.state.doc.resolve(from);if($from.parent.type.spec.code||(null===(_a=$from.nodeBefore||$from.nodeAfter)||void 0===_a?void 0:_a.marks.find((mark=>mark.type.spec.code))))return!1;let matched=!1;const textBefore=$from.parent.textBetween(Math.max(0,$from.parentOffset-500),$from.parentOffset,void 0," ")+text;return rules.forEach((rule=>{if(matched)return;const match=((text,find)=>{if(isRegExp(find))return find.exec(text);const inputRuleMatch=find(text);if(!inputRuleMatch)return null;const result=[];return result.push(inputRuleMatch.text),result.index=inputRuleMatch.index,result.input=text,result.data=inputRuleMatch.data,inputRuleMatch.replaceWith&&(inputRuleMatch.text.includes(inputRuleMatch.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),result.push(inputRuleMatch.replaceWith)),result})(textBefore,rule.find);if(!match)return;const tr=view.state.tr,state=createChainableState({state:view.state,transaction:tr}),range={from:from-(match[0].length-text.length),to:to},{commands:commands,chain:chain,can:can}=new CommandManager({editor:editor,state:state});null!==rule.handler({state:state,range:range,match:match,commands:commands,chain:chain,can:can})&&tr.steps.length&&(tr.setMeta(plugin,{transform:tr,from:from,to:to,text:text}),view.dispatch(tr),matched=!0)})),matched}function inputRulesPlugin(props){const{editor:editor,rules:rules}=props,plugin=new index_es.d({state:{init:()=>null,apply(tr,prev){const stored=tr.getMeta(this);return stored||(tr.selectionSet||tr.docChanged?null:prev)}},props:{handleTextInput:(view,from,to,text)=>run$1({editor:editor,from:from,to:to,text:text,rules:rules,plugin:plugin}),handleDOMEvents:{compositionend:view=>(setTimeout((()=>{const{$cursor:$cursor}=view.state.selection;$cursor&&run$1({editor:editor,from:$cursor.pos,to:$cursor.pos,text:"",rules:rules,plugin:plugin})})),!1)},handleKeyDown(view,event){if("Enter"!==event.key)return!1;const{$cursor:$cursor}=view.state.selection;return!!$cursor&&run$1({editor:editor,from:$cursor.pos,to:$cursor.pos,text:"\n",rules:rules,plugin:plugin})}},isInputRules:!0});return plugin}class PasteRule{constructor(config){this.find=config.find,this.handler=config.handler}}function run(config){const{editor:editor,state:state,from:from,to:to,rule:rule}=config,{commands:commands,chain:chain,can:can}=new CommandManager({editor:editor,state:state}),handlers=[];state.doc.nodesBetween(from,to,((node,pos)=>{if(!node.isTextblock||node.type.spec.code)return;const resolvedFrom=Math.max(from,pos),resolvedTo=Math.min(to,pos+node.content.size);((text,find)=>{if(isRegExp(find))return[...text.matchAll(find)];const matches=find(text);return matches?matches.map((pasteRuleMatch=>{const result=[];return result.push(pasteRuleMatch.text),result.index=pasteRuleMatch.index,result.input=text,result.data=pasteRuleMatch.data,pasteRuleMatch.replaceWith&&(pasteRuleMatch.text.includes(pasteRuleMatch.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),result.push(pasteRuleMatch.replaceWith)),result})):[]})(node.textBetween(resolvedFrom-pos,resolvedTo-pos,void 0,"￼"),rule.find).forEach((match=>{if(void 0===match.index)return;const start=resolvedFrom+match.index+1,end=start+match[0].length,range={from:state.tr.mapping.map(start),to:state.tr.mapping.map(end)},handler=rule.handler({state:state,range:range,match:match,commands:commands,chain:chain,can:can});handlers.push(handler)}))}));return handlers.every((handler=>null!==handler))}function pasteRulesPlugin(props){const{editor:editor,rules:rules}=props;let isProseMirrorHTML=!1;return rules.map((rule=>new index_es.d({props:{handlePaste:(view,event)=>{var _a;const html=null===(_a=event.clipboardData)||void 0===_a?void 0:_a.getData("text/html");return isProseMirrorHTML=!!(null==html?void 0:html.includes("data-pm-slice")),!1}},appendTransaction:(transactions,oldState,state)=>{if(!transactions[0].getMeta("paste")||isProseMirrorHTML)return;const from=oldState.doc.content.findDiffStart(state.doc.content),to=oldState.doc.content.findDiffEnd(state.doc.content);if(!function isNumber(value){return"number"==typeof value}(from)||!to||from===to.b)return;const tr=state.tr,chainableState=createChainableState({state:state,transaction:tr});return run({editor:editor,state:chainableState,from:Math.max(from-1,0),to:to.b,rule:rule})&&tr.steps.length?tr:void 0}})))}function getAttributesFromExtensions(extensions){const extensionAttributes=[],{nodeExtensions:nodeExtensions,markExtensions:markExtensions}=splitExtensions(extensions),nodeAndMarkExtensions=[...nodeExtensions,...markExtensions],defaultAttribute={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return extensions.forEach((extension=>{const addGlobalAttributes=getExtensionField(extension,"addGlobalAttributes",{name:extension.name,options:extension.options,storage:extension.storage});if(!addGlobalAttributes)return;addGlobalAttributes().forEach((globalAttribute=>{globalAttribute.types.forEach((type=>{Object.entries(globalAttribute.attributes).forEach((([name,attribute])=>{extensionAttributes.push({type:type,name:name,attribute:{...defaultAttribute,...attribute}})}))}))}))})),nodeAndMarkExtensions.forEach((extension=>{const context={name:extension.name,options:extension.options,storage:extension.storage},addAttributes=getExtensionField(extension,"addAttributes",context);if(!addAttributes)return;const attributes=addAttributes();Object.entries(attributes).forEach((([name,attribute])=>{extensionAttributes.push({type:extension.name,name:name,attribute:{...defaultAttribute,...attribute}})}))})),extensionAttributes}function mergeAttributes(...objects){return objects.filter((item=>!!item)).reduce(((items,item)=>{const mergedAttributes={...items};return Object.entries(item).forEach((([key,value])=>{mergedAttributes[key]?mergedAttributes[key]="class"===key?[mergedAttributes[key],value].join(" "):"style"===key?[mergedAttributes[key],value].join("; "):value:mergedAttributes[key]=value})),mergedAttributes}),{})}function getRenderedAttributes(nodeOrMark,extensionAttributes){return extensionAttributes.filter((item=>item.attribute.rendered)).map((item=>item.attribute.renderHTML?item.attribute.renderHTML(nodeOrMark.attrs)||{}:{[item.name]:nodeOrMark.attrs[item.name]})).reduce(((attributes,attribute)=>mergeAttributes(attributes,attribute)),{})}function injectExtensionAttributesToParseRule(parseRule,extensionAttributes){return parseRule.style?parseRule:{...parseRule,getAttrs:node=>{const oldAttributes=parseRule.getAttrs?parseRule.getAttrs(node):parseRule.attrs;if(!1===oldAttributes)return!1;const newAttributes=extensionAttributes.filter((item=>item.attribute.rendered)).reduce(((items,item)=>{const value=item.attribute.parseHTML?item.attribute.parseHTML(node):function fromString(value){return"string"!=typeof value?value:value.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(value):"true"===value||"false"!==value&&value}(node.getAttribute(item.name));return isObject(value)&&console.warn(`[tiptap warn]: BREAKING CHANGE: "parseHTML" for your attribute "${item.name}" returns an object but should return the value itself. If this is expected you can ignore this message. This warning will be removed in one of the next releases. Further information: https://github.com/ueberdosis/tiptap/issues/1863`),null==value?items:{...items,[item.name]:value}}),{});return{...oldAttributes,...newAttributes}}}}function cleanUpSchemaItem(data){return Object.fromEntries(Object.entries(data).filter((([key,value])=>("attrs"!==key||!function isEmptyObject(value={}){return 0===Object.keys(value).length&&value.constructor===Object}(value))&&null!=value)))}function getSchemaByResolvedExtensions(extensions){var _a;const allAttributes=getAttributesFromExtensions(extensions),{nodeExtensions:nodeExtensions,markExtensions:markExtensions}=splitExtensions(extensions),topNode=null===(_a=nodeExtensions.find((extension=>getExtensionField(extension,"topNode"))))||void 0===_a?void 0:_a.name,nodes=Object.fromEntries(nodeExtensions.map((extension=>{const extensionAttributes=allAttributes.filter((attribute=>attribute.type===extension.name)),context={name:extension.name,options:extension.options,storage:extension.storage},schema=cleanUpSchemaItem({...extensions.reduce(((fields,e)=>{const extendNodeSchema=getExtensionField(e,"extendNodeSchema",context);return{...fields,...extendNodeSchema?extendNodeSchema(extension):{}}}),{}),content:callOrReturn(getExtensionField(extension,"content",context)),marks:callOrReturn(getExtensionField(extension,"marks",context)),group:callOrReturn(getExtensionField(extension,"group",context)),inline:callOrReturn(getExtensionField(extension,"inline",context)),atom:callOrReturn(getExtensionField(extension,"atom",context)),selectable:callOrReturn(getExtensionField(extension,"selectable",context)),draggable:callOrReturn(getExtensionField(extension,"draggable",context)),code:callOrReturn(getExtensionField(extension,"code",context)),defining:callOrReturn(getExtensionField(extension,"defining",context)),isolating:callOrReturn(getExtensionField(extension,"isolating",context)),attrs:Object.fromEntries(extensionAttributes.map((extensionAttribute=>{var _a;return[extensionAttribute.name,{default:null===(_a=null==extensionAttribute?void 0:extensionAttribute.attribute)||void 0===_a?void 0:_a.default}]})))}),parseHTML=callOrReturn(getExtensionField(extension,"parseHTML",context));parseHTML&&(schema.parseDOM=parseHTML.map((parseRule=>injectExtensionAttributesToParseRule(parseRule,extensionAttributes))));const renderHTML=getExtensionField(extension,"renderHTML",context);renderHTML&&(schema.toDOM=node=>renderHTML({node:node,HTMLAttributes:getRenderedAttributes(node,extensionAttributes)}));const renderText=getExtensionField(extension,"renderText",context);return renderText&&(schema.toText=renderText),[extension.name,schema]}))),marks=Object.fromEntries(markExtensions.map((extension=>{const extensionAttributes=allAttributes.filter((attribute=>attribute.type===extension.name)),context={name:extension.name,options:extension.options,storage:extension.storage},schema=cleanUpSchemaItem({...extensions.reduce(((fields,e)=>{const extendMarkSchema=getExtensionField(e,"extendMarkSchema",context);return{...fields,...extendMarkSchema?extendMarkSchema(extension):{}}}),{}),inclusive:callOrReturn(getExtensionField(extension,"inclusive",context)),excludes:callOrReturn(getExtensionField(extension,"excludes",context)),group:callOrReturn(getExtensionField(extension,"group",context)),spanning:callOrReturn(getExtensionField(extension,"spanning",context)),code:callOrReturn(getExtensionField(extension,"code",context)),attrs:Object.fromEntries(extensionAttributes.map((extensionAttribute=>{var _a;return[extensionAttribute.name,{default:null===(_a=null==extensionAttribute?void 0:extensionAttribute.attribute)||void 0===_a?void 0:_a.default}]})))}),parseHTML=callOrReturn(getExtensionField(extension,"parseHTML",context));parseHTML&&(schema.parseDOM=parseHTML.map((parseRule=>injectExtensionAttributesToParseRule(parseRule,extensionAttributes))));const renderHTML=getExtensionField(extension,"renderHTML",context);return renderHTML&&(schema.toDOM=mark=>renderHTML({mark:mark,HTMLAttributes:getRenderedAttributes(mark,extensionAttributes)})),[extension.name,schema]})));return new prosemirror_model_dist_index_es.i({topNode:topNode,nodes:nodes,marks:marks})}function getSchemaTypeByName(name,schema){return schema.nodes[name]||schema.marks[name]||null}function isExtensionRulesEnabled(extension,enabled){return Array.isArray(enabled)?enabled.some((enabledExtension=>("string"==typeof enabledExtension?enabledExtension:enabledExtension.name)===extension.name)):enabled}class tiptap_core_esm_ExtensionManager{constructor(extensions,editor){this.splittableMarks=[],this.editor=editor,this.extensions=tiptap_core_esm_ExtensionManager.resolve(extensions),this.schema=getSchemaByResolvedExtensions(this.extensions),this.extensions.forEach((extension=>{var _a;this.editor.extensionStorage[extension.name]=extension.storage;const context={name:extension.name,options:extension.options,storage:extension.storage,editor:this.editor,type:getSchemaTypeByName(extension.name,this.schema)};if("mark"===extension.type){(null===(_a=callOrReturn(getExtensionField(extension,"keepOnSplit",context)))||void 0===_a||_a)&&this.splittableMarks.push(extension.name)}const onBeforeCreate=getExtensionField(extension,"onBeforeCreate",context);onBeforeCreate&&this.editor.on("beforeCreate",onBeforeCreate);const onCreate=getExtensionField(extension,"onCreate",context);onCreate&&this.editor.on("create",onCreate);const onUpdate=getExtensionField(extension,"onUpdate",context);onUpdate&&this.editor.on("update",onUpdate);const onSelectionUpdate=getExtensionField(extension,"onSelectionUpdate",context);onSelectionUpdate&&this.editor.on("selectionUpdate",onSelectionUpdate);const onTransaction=getExtensionField(extension,"onTransaction",context);onTransaction&&this.editor.on("transaction",onTransaction);const onFocus=getExtensionField(extension,"onFocus",context);onFocus&&this.editor.on("focus",onFocus);const onBlur=getExtensionField(extension,"onBlur",context);onBlur&&this.editor.on("blur",onBlur);const onDestroy=getExtensionField(extension,"onDestroy",context);onDestroy&&this.editor.on("destroy",onDestroy)}))}static resolve(extensions){const resolvedExtensions=tiptap_core_esm_ExtensionManager.sort(tiptap_core_esm_ExtensionManager.flatten(extensions)),duplicatedNames=function findDuplicates(items){const filtered=items.filter(((el,index)=>items.indexOf(el)!==index));return[...new Set(filtered)]}(resolvedExtensions.map((extension=>extension.name)));return duplicatedNames.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${duplicatedNames.map((item=>`'${item}'`)).join(", ")}]. This can lead to issues.`),resolvedExtensions}static flatten(extensions){return extensions.map((extension=>{const addExtensions=getExtensionField(extension,"addExtensions",{name:extension.name,options:extension.options,storage:extension.storage});return addExtensions?[extension,...this.flatten(addExtensions())]:extension})).flat(10)}static sort(extensions){return extensions.sort(((a,b)=>{const priorityA=getExtensionField(a,"priority")||100,priorityB=getExtensionField(b,"priority")||100;return priorityA>priorityB?-1:priorityA<priorityB?1:0}))}get commands(){return this.extensions.reduce(((commands,extension)=>{const addCommands=getExtensionField(extension,"addCommands",{name:extension.name,options:extension.options,storage:extension.storage,editor:this.editor,type:getSchemaTypeByName(extension.name,this.schema)});return addCommands?{...commands,...addCommands()}:commands}),{})}get plugins(){const{editor:editor}=this,extensions=tiptap_core_esm_ExtensionManager.sort([...this.extensions].reverse()),inputRules=[],pasteRules=[],allPlugins=extensions.map((extension=>{const context={name:extension.name,options:extension.options,storage:extension.storage,editor:editor,type:getSchemaTypeByName(extension.name,this.schema)},plugins=[],addKeyboardShortcuts=getExtensionField(extension,"addKeyboardShortcuts",context);if(addKeyboardShortcuts){const bindings=Object.fromEntries(Object.entries(addKeyboardShortcuts()).map((([shortcut,method])=>[shortcut,()=>method({editor:editor})]))),keyMapPlugin=Object(prosemirror_keymap_dist_index_es.b)(bindings);plugins.push(keyMapPlugin)}const addInputRules=getExtensionField(extension,"addInputRules",context);isExtensionRulesEnabled(extension,editor.options.enableInputRules)&&addInputRules&&inputRules.push(...addInputRules());const addPasteRules=getExtensionField(extension,"addPasteRules",context);isExtensionRulesEnabled(extension,editor.options.enablePasteRules)&&addPasteRules&&pasteRules.push(...addPasteRules());const addProseMirrorPlugins=getExtensionField(extension,"addProseMirrorPlugins",context);if(addProseMirrorPlugins){const proseMirrorPlugins=addProseMirrorPlugins();plugins.push(...proseMirrorPlugins)}return plugins})).flat();return[inputRulesPlugin({editor:editor,rules:inputRules}),...pasteRulesPlugin({editor:editor,rules:pasteRules}),...allPlugins]}get attributes(){return getAttributesFromExtensions(this.extensions)}get nodeViews(){const{editor:editor}=this,{nodeExtensions:nodeExtensions}=splitExtensions(this.extensions);return Object.fromEntries(nodeExtensions.filter((extension=>!!getExtensionField(extension,"addNodeView"))).map((extension=>{const extensionAttributes=this.attributes.filter((attribute=>attribute.type===extension.name)),context={name:extension.name,options:extension.options,storage:extension.storage,editor:editor,type:getNodeType(extension.name,this.schema)},addNodeView=getExtensionField(extension,"addNodeView",context);if(!addNodeView)return[];return[extension.name,(node,view,getPos,decorations)=>{const HTMLAttributes=getRenderedAttributes(node,extensionAttributes);return addNodeView()({editor:editor,node:node,getPos:getPos,decorations:decorations,HTMLAttributes:HTMLAttributes,extension:extension})}]})))}}class tiptap_core_esm_Editor extends class EventEmitter{constructor(){this.callbacks={}}on(event,fn){return this.callbacks[event]||(this.callbacks[event]=[]),this.callbacks[event].push(fn),this}emit(event,...args){const callbacks=this.callbacks[event];return callbacks&&callbacks.forEach((callback=>callback.apply(this,args))),this}off(event,fn){const callbacks=this.callbacks[event];return callbacks&&(fn?this.callbacks[event]=callbacks.filter((callback=>callback!==fn)):delete this.callbacks[event]),this}removeAllListeners(){this.callbacks={}}}{constructor(options={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(options),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function createStyleTag(style){const tipTapStyleTag=document.querySelector("style[data-tiptap-style]");if(null!==tipTapStyleTag)return tipTapStyleTag;const styleNode=document.createElement("style");return styleNode.setAttribute("data-tiptap-style",""),styleNode.innerHTML=style,document.getElementsByTagName("head")[0].appendChild(styleNode),styleNode}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}'))}setOptions(options={}){this.options={...this.options,...options},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(editable){this.setOptions({editable:editable})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(plugin,handlePlugins){const plugins=isFunction(handlePlugins)?handlePlugins(plugin,this.state.plugins):[...this.state.plugins,plugin],state=this.state.reconfigure({plugins:plugins});this.view.updateState(state)}unregisterPlugin(nameOrPluginKey){if(this.isDestroyed)return;const name="string"==typeof nameOrPluginKey?`${nameOrPluginKey}$`:nameOrPluginKey.key,state=this.state.reconfigure({plugins:this.state.plugins.filter((plugin=>!plugin.key.startsWith(name)))});this.view.updateState(state)}createExtensionManager(){const allExtensions=[...this.options.enableCoreExtensions?Object.values(tiptap_core_esm_extensions):[],...this.options.extensions].filter((extension=>["extension","node","mark"].includes(null==extension?void 0:extension.type)));this.extensionManager=new tiptap_core_esm_ExtensionManager(allExtensions,this)}createCommandManager(){this.commandManager=new CommandManager({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const doc=createDocument(this.options.content,this.schema,this.options.parseOptions),selection=resolveFocusPosition(doc,this.options.autofocus);this.view=new prosemirror_view_dist_index_es.c(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:index_es.b.create({doc:doc,selection:selection})});const newState=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(newState),this.createNodeViews();this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(fn){this.isCapturingTransaction=!0,fn(),this.isCapturingTransaction=!1;const tr=this.capturedTransaction;return this.capturedTransaction=null,tr}dispatchTransaction(transaction){if(this.isCapturingTransaction)return this.capturedTransaction?void transaction.steps.forEach((step=>{var _a;return null===(_a=this.capturedTransaction)||void 0===_a?void 0:_a.step(step)})):void(this.capturedTransaction=transaction);const state=this.state.apply(transaction),selectionHasChanged=!this.state.selection.eq(state.selection);this.view.updateState(state),this.emit("transaction",{editor:this,transaction:transaction}),selectionHasChanged&&this.emit("selectionUpdate",{editor:this,transaction:transaction});const focus=transaction.getMeta("focus"),blur=transaction.getMeta("blur");focus&&this.emit("focus",{editor:this,event:focus.event,transaction:transaction}),blur&&this.emit("blur",{editor:this,event:blur.event,transaction:transaction}),transaction.docChanged&&!transaction.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:transaction})}getAttributes(nameOrType){return getAttributes(this.state,nameOrType)}isActive(nameOrAttributes,attributesOrUndefined){const name="string"==typeof nameOrAttributes?nameOrAttributes:null,attributes="string"==typeof nameOrAttributes?attributesOrUndefined:nameOrAttributes;return tiptap_core_esm_isActive(this.state,name,attributes)}getJSON(){return this.state.doc.toJSON()}getHTML(){return getHTMLFromFragment(this.state.doc.content,this.schema)}getText(options){const{blockSeparator:blockSeparator="\n\n",textSerializers:textSerializers={}}=options||{};return getText(this.state.doc,{blockSeparator:blockSeparator,textSerializers:{...textSerializers,...getTextSeralizersFromSchema(this.schema)}})}get isEmpty(){return isNodeEmpty(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var _a;return!(null===(_a=this.view)||void 0===_a?void 0:_a.docView)}}class Node{constructor(config={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...config},this.name=this.config.name,config.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(config={}){return new Node(config)}configure(options={}){const extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}extend(extendedConfig={}){const extension=new Node(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${extension.name}".`),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}class Mark{constructor(config={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...config},this.name=this.config.name,config.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(config={}){return new Mark(config)}configure(options={}){const extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}extend(extendedConfig={}){const extension=new Mark(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${extension.name}".`),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}class tiptap_core_esm_NodeView{constructor(component,props,options){this.isDragging=!1,this.component=component,this.editor=props.editor,this.options={stopEvent:null,ignoreMutation:null,...options},this.extension=props.extension,this.node=props.node,this.decorations=props.decorations,this.getPos=props.getPos,this.mount()}mount(){}get dom(){return null}get contentDOM(){return null}onDragStart(event){var _a,_b,_c;const{view:view}=this.editor,target=event.target,dragHandle=3===target.nodeType?null===(_a=target.parentElement)||void 0===_a?void 0:_a.closest("[data-drag-handle]"):target.closest("[data-drag-handle]");if(!this.dom||(null===(_b=this.contentDOM)||void 0===_b?void 0:_b.contains(target))||!dragHandle)return;let x=0,y=0;if(this.dom!==dragHandle){const domBox=this.dom.getBoundingClientRect(),handleBox=dragHandle.getBoundingClientRect();x=handleBox.x-domBox.x+event.offsetX,y=handleBox.y-domBox.y+event.offsetY}null===(_c=event.dataTransfer)||void 0===_c||_c.setDragImage(this.dom,x,y);const selection=index_es.c.create(view.state.doc,this.getPos()),transaction=view.state.tr.setSelection(selection);view.dispatch(transaction)}stopEvent(event){var _a;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:event});const target=event.target;if(!(this.dom.contains(target)&&!(null===(_a=this.contentDOM)||void 0===_a?void 0:_a.contains(target))))return!1;const isDropEvent="drop"===event.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(target.tagName)||target.isContentEditable)&&!isDropEvent)return!0;const{isEditable:isEditable}=this.editor,{isDragging:isDragging}=this,isDraggable=!!this.node.type.spec.draggable,isSelectable=index_es.c.isSelectable(this.node),isCopyEvent="copy"===event.type,isPasteEvent="paste"===event.type,isCutEvent="cut"===event.type,isClickEvent="mousedown"===event.type,isDragEvent=event.type.startsWith("drag");if(!isDraggable&&isSelectable&&isDragEvent&&event.preventDefault(),isDraggable&&isDragEvent&&!isDragging)return event.preventDefault(),!1;if(isDraggable&&isEditable&&!isDragging&&isClickEvent){const dragHandle=target.closest("[data-drag-handle]");dragHandle&&(this.dom===dragHandle||this.dom.contains(dragHandle))&&(this.isDragging=!0,document.addEventListener("dragend",(()=>{this.isDragging=!1}),{once:!0}),document.addEventListener("mouseup",(()=>{this.isDragging=!1}),{once:!0}))}return!(isDragging||isDropEvent||isCopyEvent||isPasteEvent||isCutEvent||isClickEvent&&isSelectable)}ignoreMutation(mutation){if(!this.dom||!this.contentDOM)return!0;if("function"==typeof this.options.ignoreMutation)return this.options.ignoreMutation({mutation:mutation});if(this.node.isLeaf||this.node.isAtom)return!0;if("selection"===mutation.type)return!1;if(this.dom.contains(mutation.target)&&"childList"===mutation.type&&isiOS()&&this.editor.isFocused){if([...Array.from(mutation.addedNodes),...Array.from(mutation.removedNodes)].every((node=>node.isContentEditable)))return!1}return this.contentDOM===mutation.target&&"attributes"===mutation.type||!this.contentDOM.contains(mutation.target)}updateAttributes(attributes){this.editor.commands.command((({tr:tr})=>{const pos=this.getPos();return tr.setNodeMarkup(pos,void 0,{...this.node.attrs,...attributes}),!0}))}deleteNode(){const from=this.getPos(),to=from+this.node.nodeSize;this.editor.commands.deleteRange({from:from,to:to})}}class Tracker{constructor(transaction){this.transaction=transaction,this.currentStep=this.transaction.steps.length}map(position){let deleted=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce(((newPosition,step)=>{const mapResult=step.getMap().mapResult(newPosition);return mapResult.deleted&&(deleted=!0),mapResult.pos}),position),deleted:deleted}}}function nodeInputRule(config){return new InputRule({find:config.find,handler:({state:state,range:range,match:match})=>{const attributes=callOrReturn(config.getAttributes,void 0,match)||{},{tr:tr}=state,start=range.from;let end=range.to;if(match[1]){let matchStart=start+match[0].lastIndexOf(match[1]);matchStart>end?matchStart=end:end=matchStart+match[1].length;const lastChar=match[0][match[0].length-1];tr.insertText(lastChar,start+match[0].length-1),tr.replaceWith(matchStart,end,config.type.create(attributes))}else match[0]&&tr.replaceWith(start,end,config.type.create(attributes))}})}function getMarksBetween(from,to,doc){const marks=[];return from===to?doc.resolve(from).marks().forEach((mark=>{const range=getMarkRange(doc.resolve(from-1),mark.type);range&&marks.push({mark:mark,...range})})):doc.nodesBetween(from,to,((node,pos)=>{marks.push(...node.marks.map((mark=>({from:pos,to:pos+node.nodeSize,mark:mark}))))})),marks}function markInputRule(config){return new InputRule({find:config.find,handler:({state:state,range:range,match:match})=>{const attributes=callOrReturn(config.getAttributes,void 0,match);if(!1===attributes||null===attributes)return null;const{tr:tr}=state,captureGroup=match[match.length-1],fullMatch=match[0];let markEnd=range.to;if(captureGroup){const startSpaces=fullMatch.search(/\S/),textStart=range.from+fullMatch.indexOf(captureGroup),textEnd=textStart+captureGroup.length;if(getMarksBetween(range.from,range.to,state.doc).filter((item=>item.mark.type.excluded.find((type=>type===config.type&&type!==item.mark.type)))).filter((item=>item.to>textStart)).length)return null;textEnd<range.to&&tr.delete(textEnd,range.to),textStart>range.from&&tr.delete(range.from+startSpaces,textStart),markEnd=range.from+startSpaces+captureGroup.length,tr.addMark(range.from+startSpaces,markEnd,config.type.create(attributes||{})),tr.removeStoredMark(config.type)}}})}function textblockTypeInputRule(config){return new InputRule({find:config.find,handler:({state:state,range:range,match:match})=>{const $start=state.doc.resolve(range.from),attributes=callOrReturn(config.getAttributes,void 0,match)||{};if(!$start.node(-1).canReplaceWith($start.index(-1),$start.indexAfter(-1),config.type))return null;state.tr.delete(range.from,range.to).setBlockType(range.from,range.from,config.type,attributes)}})}function textInputRule(config){return new InputRule({find:config.find,handler:({state:state,range:range,match:match})=>{let insert=config.replace,start=range.from;const end=range.to;if(match[1]){const offset=match[0].lastIndexOf(match[1]);insert+=match[0].slice(offset+match[1].length),start+=offset;const cutOff=start-end;cutOff>0&&(insert=match[0].slice(offset-cutOff,offset)+insert,start=end)}state.tr.insertText(insert,start,end)}})}function wrappingInputRule(config){return new InputRule({find:config.find,handler:({state:state,range:range,match:match})=>{const attributes=callOrReturn(config.getAttributes,void 0,match)||{},tr=state.tr.delete(range.from,range.to),blockRange=tr.doc.resolve(range.from).blockRange(),wrapping=blockRange&&Object(dist_index_es.h)(blockRange,config.type,attributes);if(!wrapping)return null;tr.wrap(blockRange,wrapping);const before=tr.doc.resolve(range.from-1).nodeBefore;before&&before.type===config.type&&Object(dist_index_es.e)(tr.doc,range.from-1)&&(!config.joinPredicate||config.joinPredicate(match,before))&&tr.join(range.from-1)}})}function markPasteRule(config){return new PasteRule({find:config.find,handler:({state:state,range:range,match:match})=>{const attributes=callOrReturn(config.getAttributes,void 0,match);if(!1===attributes||null===attributes)return null;const{tr:tr}=state,captureGroup=match[match.length-1],fullMatch=match[0];let markEnd=range.to;if(captureGroup){const startSpaces=fullMatch.search(/\S/),textStart=range.from+fullMatch.indexOf(captureGroup),textEnd=textStart+captureGroup.length;if(getMarksBetween(range.from,range.to,state.doc).filter((item=>item.mark.type.excluded.find((type=>type===config.type&&type!==item.mark.type)))).filter((item=>item.to>textStart)).length)return null;textEnd<range.to&&tr.delete(textEnd,range.to),textStart>range.from&&tr.delete(range.from+startSpaces,textStart),markEnd=range.from+startSpaces+captureGroup.length,tr.addMark(range.from+startSpaces,markEnd,config.type.create(attributes||{})),tr.removeStoredMark(config.type)}}})}function textPasteRule(config){return new PasteRule({find:config.find,handler:({state:state,range:range,match:match})=>{let insert=config.replace,start=range.from;const end=range.to;if(match[1]){const offset=match[0].lastIndexOf(match[1]);insert+=match[0].slice(offset+match[1].length),start+=offset;const cutOff=start-end;cutOff>0&&(insert=match[0].slice(offset-cutOff,offset)+insert,start=end)}state.tr.insertText(insert,start,end)}})}function escapeForRegEx(string){return string.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function combineTransactionSteps(oldDoc,transactions){const transform=new dist_index_es.d(oldDoc);return transactions.forEach((transaction=>{transaction.steps.forEach((step=>{transform.step(step)}))})),transform}function tiptap_core_esm_defaultBlockAt(match){for(let i=0;i<match.edgeCount;i+=1){const{type:type}=match.edge(i);if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}function findChildren(node,predicate){const nodesWithPos=[];return node.descendants(((child,pos)=>{predicate(child)&&nodesWithPos.push({node:child,pos:pos})})),nodesWithPos}function findChildrenInRange(node,range,predicate){const nodesWithPos=[];return node.nodesBetween(range.from,range.to,((child,pos)=>{predicate(child)&&nodesWithPos.push({node:child,pos:pos})})),nodesWithPos}function getSchema(extensions){return getSchemaByResolvedExtensions(tiptap_core_esm_ExtensionManager.resolve(extensions))}function generateHTML(doc,extensions){const schema=getSchema(extensions);return getHTMLFromFragment(prosemirror_model_dist_index_es.f.fromJSON(schema,doc).content,schema)}function generateJSON(html,extensions){const schema=getSchema(extensions),dom=elementFromString(html);return prosemirror_model_dist_index_es.a.fromSchema(schema).parse(dom).toJSON()}function generateText(doc,extensions,options){const{blockSeparator:blockSeparator="\n\n",textSerializers:textSerializers={}}=options||{},schema=getSchema(extensions);return getText(prosemirror_model_dist_index_es.f.fromJSON(schema,doc),{blockSeparator:blockSeparator,textSerializers:{...textSerializers,...getTextSeralizersFromSchema(schema)}})}function simplifyChangedRanges(changes){const uniqueChanges=function removeDuplicates(array,by=JSON.stringify){const seen={};return array.filter((item=>{const key=by(item);return!Object.prototype.hasOwnProperty.call(seen,key)&&(seen[key]=!0)}))}(changes);return 1===uniqueChanges.length?uniqueChanges:uniqueChanges.filter(((change,index)=>!uniqueChanges.filter(((_,i)=>i!==index)).some((otherChange=>change.oldRange.from>=otherChange.oldRange.from&&change.oldRange.to<=otherChange.oldRange.to&&change.newRange.from>=otherChange.newRange.from&&change.newRange.to<=otherChange.newRange.to))))}function getChangedRanges(transform){const{mapping:mapping,steps:steps}=transform,changes=[];return mapping.maps.forEach(((stepMap,index)=>{const ranges=[];if(stepMap.ranges.length)stepMap.forEach(((from,to)=>{ranges.push({from:from,to:to})}));else{const{from:from,to:to}=steps[index];if(void 0===from||void 0===to)return;ranges.push({from:from,to:to})}ranges.forEach((({from:from,to:to})=>{const newStart=mapping.slice(index).map(from,-1),newEnd=mapping.slice(index).map(to),oldStart=mapping.invert().map(newStart,-1),oldEnd=mapping.invert().map(newEnd);changes.push({oldRange:{from:oldStart,to:oldEnd},newRange:{from:newStart,to:newEnd}})}))})),simplifyChangedRanges(changes)}function getDebugJSON(node,startOffset=0){const increment=node.type===node.type.schema.topNodeType?0:1,from=startOffset,to=from+node.nodeSize,marks=node.marks.map((mark=>{const output={type:mark.type.name};return Object.keys(mark.attrs).length&&(output.attrs={...mark.attrs}),output})),attrs={...node.attrs},output={type:node.type.name,from:from,to:to};return Object.keys(attrs).length&&(output.attrs=attrs),marks.length&&(output.marks=marks),node.content.childCount&&(output.content=[],node.forEach(((child,offset)=>{var _a;null===(_a=output.content)||void 0===_a||_a.push(getDebugJSON(child,startOffset+offset+increment))}))),node.text&&(output.text=node.text),output}function isNodeSelection(value){return isObject(value)&&value instanceof index_es.c}function posToDOMRect(view,from,to){const maxPos=view.state.doc.content.size,resolvedFrom=minMax(from,0,maxPos),resolvedEnd=minMax(to,0,maxPos),start=view.coordsAtPos(resolvedFrom),end=view.coordsAtPos(resolvedEnd,-1),top=Math.min(start.top,end.top),bottom=Math.max(start.bottom,end.bottom),left=Math.min(start.left,end.left),right=Math.max(start.right,end.right),data={top:top,bottom:bottom,left:left,right:right,width:right-left,height:bottom-top,x:left,y:top};return{...data,toJSON:()=>data}}},2432:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Blockquote",(function(){return Blockquote})),__webpack_require__.d(__webpack_exports__,"default",(function(){return Blockquote})),__webpack_require__.d(__webpack_exports__,"inputRegex",(function(){return inputRegex}));var _tiptap_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2339);const inputRegex=/^\s*>\s$/,Blockquote=_tiptap_core__WEBPACK_IMPORTED_MODULE_0__.f.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["blockquote",Object(_tiptap_core__WEBPACK_IMPORTED_MODULE_0__.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{setBlockquote:()=>({commands:commands})=>commands.wrapIn(this.name),toggleBlockquote:()=>({commands:commands})=>commands.toggleWrap(this.name),unsetBlockquote:()=>({commands:commands})=>commands.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Object(_tiptap_core__WEBPACK_IMPORTED_MODULE_0__.ab)({find:inputRegex,type:this.type})]}})},2494:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return StarterKit}));var tiptap_core_esm=__webpack_require__(2339),tiptap_extension_blockquote_esm=__webpack_require__(2432);const starInputRegex=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,starPasteRegex=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,underscoreInputRegex=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,underscorePasteRegex=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Bold=tiptap_core_esm.e.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:node=>"normal"!==node.style.fontWeight&&null},{style:"font-weight",getAttrs:value=>/^(bold(er)?|[5-9]\d{2,})$/.test(value)&&null}],renderHTML({HTMLAttributes:HTMLAttributes}){return["strong",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{setBold:()=>({commands:commands})=>commands.setMark(this.name),toggleBold:()=>({commands:commands})=>commands.toggleMark(this.name),unsetBold:()=>({commands:commands})=>commands.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Object(tiptap_core_esm.R)({find:starInputRegex,type:this.type}),Object(tiptap_core_esm.R)({find:underscoreInputRegex,type:this.type})]},addPasteRules(){return[Object(tiptap_core_esm.S)({find:starPasteRegex,type:this.type}),Object(tiptap_core_esm.S)({find:underscorePasteRegex,type:this.type})]}}),inputRegex=/^\s*([-+*])\s$/,BulletList=tiptap_core_esm.f.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["ul",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{toggleBulletList:()=>({commands:commands})=>commands.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[Object(tiptap_core_esm.ab)({find:inputRegex,type:this.type})]}}),tiptap_extension_code_esm_inputRegex=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,pasteRegex=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Code=tiptap_core_esm.e.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["code",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{setCode:()=>({commands:commands})=>commands.setMark(this.name),toggleCode:()=>({commands:commands})=>commands.toggleMark(this.name),unsetCode:()=>({commands:commands})=>commands.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Object(tiptap_core_esm.R)({find:tiptap_extension_code_esm_inputRegex,type:this.type})]},addPasteRules(){return[Object(tiptap_core_esm.S)({find:pasteRegex,type:this.type})]}});var index_es=__webpack_require__(2686);const backtickInputRegex=/^```([a-z]+)?[\s\n]$/,tildeInputRegex=/^~~~([a-z]+)?[\s\n]$/,CodeBlock=tiptap_core_esm.f.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:element=>{var _a;const{languageClassPrefix:languageClassPrefix}=this.options,language=[...(null===(_a=element.firstElementChild)||void 0===_a?void 0:_a.classList)||[]].filter((className=>className.startsWith(languageClassPrefix))).map((className=>className.replace(languageClassPrefix,"")))[0];return language||null},renderHTML:attributes=>attributes.language?{class:this.options.languageClassPrefix+attributes.language}:null}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["pre",this.options.HTMLAttributes,["code",HTMLAttributes,0]]},addCommands(){return{setCodeBlock:attributes=>({commands:commands})=>commands.setNode(this.name,attributes),toggleCodeBlock:attributes=>({commands:commands})=>commands.toggleNode(this.name,"paragraph",attributes)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:empty,$anchor:$anchor}=this.editor.state.selection,isAtStart=1===$anchor.pos;return!(!empty||$anchor.parent.type.name!==this.name)&&(!(!isAtStart&&$anchor.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:({editor:editor})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:state}=editor,{selection:selection}=state,{$from:$from,empty:empty}=selection;if(!empty||$from.parent.type!==this.type)return!1;const isAtEnd=$from.parentOffset===$from.parent.nodeSize-2,endsWithDoubleNewline=$from.parent.textContent.endsWith("\n\n");return!(!isAtEnd||!endsWithDoubleNewline)&&editor.chain().command((({tr:tr})=>(tr.delete($from.pos-2,$from.pos),!0))).exitCode().run()},ArrowDown:({editor:editor})=>{if(!this.options.exitOnArrowDown)return!1;const{state:state}=editor,{selection:selection,doc:doc}=state,{$from:$from,empty:empty}=selection;if(!empty||$from.parent.type!==this.type)return!1;if(!($from.parentOffset===$from.parent.nodeSize-2))return!1;const after=$from.after();if(void 0===after)return!1;return!doc.nodeAt(after)&&editor.commands.exitCode()}}},addInputRules(){return[Object(tiptap_core_esm.Z)({find:backtickInputRegex,type:this.type,getAttributes:match=>({language:match[1]})}),Object(tiptap_core_esm.Z)({find:tildeInputRegex,type:this.type,getAttributes:match=>({language:match[1]})})]},addProseMirrorPlugins(){return[new index_es.d({key:new index_es.e("codeBlockVSCodeHandler"),props:{handlePaste:(view,event)=>{if(!event.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const text=event.clipboardData.getData("text/plain"),vscode=event.clipboardData.getData("vscode-editor-data"),vscodeData=vscode?JSON.parse(vscode):void 0,language=null==vscodeData?void 0:vscodeData.mode;if(!text||!language)return!1;const{tr:tr}=view.state;return tr.replaceSelectionWith(this.type.create({language:language})),tr.setSelection(index_es.g.near(tr.doc.resolve(Math.max(0,tr.selection.from-2)))),tr.insertText(text.replace(/\r\n?/g,"\n")),tr.setMeta("paste",!0),view.dispatch(tr),!0}}})]}}),Document=tiptap_core_esm.f.create({name:"doc",topNode:!0,content:"block+"});var dist_index_es=__webpack_require__(2892);var DropCursorView=function DropCursorView(editorView,options){var this$1=this;this.editorView=editorView,this.width=options.width||1,this.color=options.color||"black",this.class=options.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(name){var handler=function(e){return this$1[name](e)};return editorView.dom.addEventListener(name,handler),{name:name,handler:handler}}))};DropCursorView.prototype.destroy=function destroy(){var this$1=this;this.handlers.forEach((function(ref){var name=ref.name,handler=ref.handler;return this$1.editorView.dom.removeEventListener(name,handler)}))},DropCursorView.prototype.update=function update(editorView,prevState){null!=this.cursorPos&&prevState.doc!=editorView.state.doc&&(this.cursorPos>editorView.state.doc.content.size?this.setCursor(null):this.updateOverlay())},DropCursorView.prototype.setCursor=function setCursor(pos){pos!=this.cursorPos&&(this.cursorPos=pos,null==pos?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},DropCursorView.prototype.updateOverlay=function updateOverlay(){var rect,$pos=this.editorView.state.doc.resolve(this.cursorPos);if(!$pos.parent.inlineContent){var before=$pos.nodeBefore,after=$pos.nodeAfter;if(before||after){var nodeRect=this.editorView.nodeDOM(this.cursorPos-(before?before.nodeSize:0)).getBoundingClientRect(),top=before?nodeRect.bottom:nodeRect.top;before&&after&&(top=(top+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),rect={left:nodeRect.left,right:nodeRect.right,top:top-this.width/2,bottom:top+this.width/2}}}if(!rect){var coords=this.editorView.coordsAtPos(this.cursorPos);rect={left:coords.left-this.width/2,right:coords.left+this.width/2,top:coords.top,bottom:coords.bottom}}var parentLeft,parentTop,parent=this.editorView.dom.offsetParent;if(this.element||(this.element=parent.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!parent||parent==document.body&&"static"==getComputedStyle(parent).position)parentLeft=-pageXOffset,parentTop=-pageYOffset;else{var rect$1=parent.getBoundingClientRect();parentLeft=rect$1.left-parent.scrollLeft,parentTop=rect$1.top-parent.scrollTop}this.element.style.left=rect.left-parentLeft+"px",this.element.style.top=rect.top-parentTop+"px",this.element.style.width=rect.right-rect.left+"px",this.element.style.height=rect.bottom-rect.top+"px"},DropCursorView.prototype.scheduleRemoval=function scheduleRemoval(timeout){var this$1=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return this$1.setCursor(null)}),timeout)},DropCursorView.prototype.dragover=function dragover(event){if(this.editorView.editable){var pos=this.editorView.posAtCoords({left:event.clientX,top:event.clientY}),node=pos&&pos.inside>=0&&this.editorView.state.doc.nodeAt(pos.inside),disableDropCursor=node&&node.type.spec.disableDropCursor,disabled="function"==typeof disableDropCursor?disableDropCursor(this.editorView,pos):disableDropCursor;if(pos&&!disabled){var target=pos.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(target=Object(dist_index_es.g)(this.editorView.state.doc,target,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(target),this.scheduleRemoval(5e3)}}},DropCursorView.prototype.dragend=function dragend(){this.scheduleRemoval(20)},DropCursorView.prototype.drop=function drop(){this.scheduleRemoval(20)},DropCursorView.prototype.dragleave=function dragleave(event){event.target!=this.editorView.dom&&this.editorView.dom.contains(event.relatedTarget)||this.setCursor(null)};const Dropcursor=tiptap_core_esm.c.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:null}),addProseMirrorPlugins(){return[(options=this.options,void 0===options&&(options={}),new index_es.d({view:function view(editorView){return new DropCursorView(editorView,options)}}))];var options}});var prosemirror_keymap_dist_index_es=__webpack_require__(3607),prosemirror_view_dist_index_es=__webpack_require__(3585),prosemirror_model_dist_index_es=__webpack_require__(3057),index_es_GapCursor=function(Selection){function GapCursor($pos){Selection.call(this,$pos,$pos)}return Selection&&(GapCursor.__proto__=Selection),GapCursor.prototype=Object.create(Selection&&Selection.prototype),GapCursor.prototype.constructor=GapCursor,GapCursor.prototype.map=function map(doc,mapping){var $pos=doc.resolve(mapping.map(this.head));return GapCursor.valid($pos)?new GapCursor($pos):Selection.near($pos)},GapCursor.prototype.content=function content(){return prosemirror_model_dist_index_es.j.empty},GapCursor.prototype.eq=function eq(other){return other instanceof GapCursor&&other.head==this.head},GapCursor.prototype.toJSON=function toJSON(){return{type:"gapcursor",pos:this.head}},GapCursor.fromJSON=function fromJSON(doc,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new GapCursor(doc.resolve(json.pos))},GapCursor.prototype.getBookmark=function getBookmark(){return new GapBookmark(this.anchor)},GapCursor.valid=function valid($pos){var parent=$pos.parent;if(parent.isTextblock||!function closedBefore($pos){for(var d=$pos.depth;d>=0;d--){var index=$pos.index(d),parent=$pos.node(d);if(0!=index)for(var before=parent.child(index-1);;before=before.lastChild){if(0==before.childCount&&!before.inlineContent||before.isAtom||before.type.spec.isolating)return!0;if(before.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos)||!function closedAfter($pos){for(var d=$pos.depth;d>=0;d--){var index=$pos.indexAfter(d),parent=$pos.node(d);if(index!=parent.childCount)for(var after=parent.child(index);;after=after.firstChild){if(0==after.childCount&&!after.inlineContent||after.isAtom||after.type.spec.isolating)return!0;if(after.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos))return!1;var override=parent.type.spec.allowGapCursor;if(null!=override)return override;var deflt=parent.contentMatchAt($pos.index()).defaultType;return deflt&&deflt.isTextblock},GapCursor.findFrom=function findFrom($pos,dir,mustMove){search:for(;;){if(!mustMove&&GapCursor.valid($pos))return $pos;for(var pos=$pos.pos,next=null,d=$pos.depth;;d--){var parent=$pos.node(d);if(dir>0?$pos.indexAfter(d)<parent.childCount:$pos.index(d)>0){next=parent.child(dir>0?$pos.indexAfter(d):$pos.index(d)-1);break}if(0==d)return null;pos+=dir;var $cur=$pos.doc.resolve(pos);if(GapCursor.valid($cur))return $cur}for(;;){var inside=dir>0?next.firstChild:next.lastChild;if(!inside){if(next.isAtom&&!next.isText&&!index_es.c.isSelectable(next)){$pos=$pos.doc.resolve(pos+next.nodeSize*dir),mustMove=!1;continue search}break}next=inside,pos+=dir;var $cur$1=$pos.doc.resolve(pos);if(GapCursor.valid($cur$1))return $cur$1}return null}},GapCursor}(index_es.f);index_es_GapCursor.prototype.visible=!1,index_es.f.jsonID("gapcursor",index_es_GapCursor);var GapBookmark=function GapBookmark(pos){this.pos=pos};GapBookmark.prototype.map=function map(mapping){return new GapBookmark(mapping.map(this.pos))},GapBookmark.prototype.resolve=function resolve(doc){var $pos=doc.resolve(this.pos);return index_es_GapCursor.valid($pos)?new index_es_GapCursor($pos):index_es.f.near($pos)};var handleKeyDown=Object(prosemirror_keymap_dist_index_es.a)({ArrowLeft:arrow("horiz",-1),ArrowRight:arrow("horiz",1),ArrowUp:arrow("vert",-1),ArrowDown:arrow("vert",1)});function arrow(axis,dir){var dirStr="vert"==axis?dir>0?"down":"up":dir>0?"right":"left";return function(state,dispatch,view){var sel=state.selection,$start=dir>0?sel.$to:sel.$from,mustMove=sel.empty;if(sel instanceof index_es.g){if(!view.endOfTextblock(dirStr)||0==$start.depth)return!1;mustMove=!1,$start=state.doc.resolve(dir>0?$start.after():$start.before())}var $found=index_es_GapCursor.findFrom($start,dir,mustMove);return!!$found&&(dispatch&&dispatch(state.tr.setSelection(new index_es_GapCursor($found))),!0)}}function handleClick(view,pos,event){if(!view.editable)return!1;var $pos=view.state.doc.resolve(pos);if(!index_es_GapCursor.valid($pos))return!1;var inside=view.posAtCoords({left:event.clientX,top:event.clientY}).inside;return!(inside>-1&&index_es.c.isSelectable(view.state.doc.nodeAt(inside)))&&(view.dispatch(view.state.tr.setSelection(new index_es_GapCursor($pos))),!0)}function drawGapCursor(state){if(!(state.selection instanceof index_es_GapCursor))return null;var node=document.createElement("div");return node.className="ProseMirror-gapcursor",prosemirror_view_dist_index_es.b.create(state.doc,[prosemirror_view_dist_index_es.a.widget(state.selection.head,node,{key:"gapcursor"})])}const Gapcursor=tiptap_core_esm.c.create({name:"gapCursor",addProseMirrorPlugins:()=>[new index_es.d({props:{decorations:drawGapCursor,createSelectionBetween:function createSelectionBetween(_view,$anchor,$head){if($anchor.pos==$head.pos&&index_es_GapCursor.valid($head))return new index_es_GapCursor($head)},handleClick:handleClick,handleKeyDown:handleKeyDown}})],extendNodeSchema(extension){var _a;const context={name:extension.name,options:extension.options,storage:extension.storage};return{allowGapCursor:null!==(_a=Object(tiptap_core_esm.j)(Object(tiptap_core_esm.y)(extension,"allowGapCursor",context)))&&void 0!==_a?_a:null}}}),HardBreak=tiptap_core_esm.f.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["br",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:commands,chain:chain,state:state,editor:editor})=>commands.first([()=>commands.exitCode(),()=>commands.command((()=>{const{selection:selection,storedMarks:storedMarks}=state;if(selection.$from.parent.type.spec.isolating)return!1;const{keepMarks:keepMarks}=this.options,{splittableMarks:splittableMarks}=editor.extensionManager,marks=storedMarks||selection.$to.parentOffset&&selection.$from.marks();return chain().insertContent({type:this.name}).command((({tr:tr,dispatch:dispatch})=>{if(dispatch&&marks&&keepMarks){const filteredMarks=marks.filter((mark=>splittableMarks.includes(mark.type.name)));tr.ensureMarks(filteredMarks)}return!0})).run()}))])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Heading=tiptap_core_esm.f.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map((level=>({tag:`h${level}`,attrs:{level:level}})))},renderHTML({node:node,HTMLAttributes:HTMLAttributes}){return[`h${this.options.levels.includes(node.attrs.level)?node.attrs.level:this.options.levels[0]}`,Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{setHeading:attributes=>({commands:commands})=>!!this.options.levels.includes(attributes.level)&&commands.setNode(this.name,attributes),toggleHeading:attributes=>({commands:commands})=>!!this.options.levels.includes(attributes.level)&&commands.toggleNode(this.name,"paragraph",attributes)}},addKeyboardShortcuts(){return this.options.levels.reduce(((items,level)=>({...items,[`Mod-Alt-${level}`]:()=>this.editor.commands.toggleHeading({level:level})})),{})},addInputRules(){return this.options.levels.map((level=>Object(tiptap_core_esm.Z)({find:new RegExp(`^(#{1,${level}})\\s$`),type:this.type,getAttributes:{level:level}})))}});var RopeSequence=function RopeSequence(){};RopeSequence.prototype.append=function append(other){return other.length?(other=RopeSequence.from(other),!this.length&&other||other.length<200&&this.leafAppend(other)||this.length<200&&other.leafPrepend(this)||this.appendInner(other)):this},RopeSequence.prototype.prepend=function prepend(other){return other.length?RopeSequence.from(other).append(this):this},RopeSequence.prototype.appendInner=function appendInner(other){return new Append(this,other)},RopeSequence.prototype.slice=function slice(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.length),from>=to?RopeSequence.empty:this.sliceInner(Math.max(0,from),Math.min(this.length,to))},RopeSequence.prototype.get=function get(i){if(!(i<0||i>=this.length))return this.getInner(i)},RopeSequence.prototype.forEach=function forEach(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length),from<=to?this.forEachInner(f,from,to,0):this.forEachInvertedInner(f,from,to,0)},RopeSequence.prototype.map=function map(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length);var result=[];return this.forEach((function(elt,i){return result.push(f(elt,i))}),from,to),result},RopeSequence.from=function from(values){return values instanceof RopeSequence?values:values&&values.length?new Leaf(values):RopeSequence.empty};var Leaf=function(RopeSequence){function Leaf(values){RopeSequence.call(this),this.values=values}RopeSequence&&(Leaf.__proto__=RopeSequence),Leaf.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Leaf.prototype.constructor=Leaf;var prototypeAccessors={length:{configurable:!0},depth:{configurable:!0}};return Leaf.prototype.flatten=function flatten(){return this.values},Leaf.prototype.sliceInner=function sliceInner(from,to){return 0==from&&to==this.length?this:new Leaf(this.values.slice(from,to))},Leaf.prototype.getInner=function getInner(i){return this.values[i]},Leaf.prototype.forEachInner=function forEachInner(f,from,to,start){for(var i=from;i<to;i++)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){for(var i=from-1;i>=to;i--)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.leafAppend=function leafAppend(other){if(this.length+other.length<=200)return new Leaf(this.values.concat(other.flatten()))},Leaf.prototype.leafPrepend=function leafPrepend(other){if(this.length+other.length<=200)return new Leaf(other.flatten().concat(this.values))},prototypeAccessors.length.get=function(){return this.values.length},prototypeAccessors.depth.get=function(){return 0},Object.defineProperties(Leaf.prototype,prototypeAccessors),Leaf}(RopeSequence);RopeSequence.empty=new Leaf([]);var Append=function(RopeSequence){function Append(left,right){RopeSequence.call(this),this.left=left,this.right=right,this.length=left.length+right.length,this.depth=Math.max(left.depth,right.depth)+1}return RopeSequence&&(Append.__proto__=RopeSequence),Append.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Append.prototype.constructor=Append,Append.prototype.flatten=function flatten(){return this.left.flatten().concat(this.right.flatten())},Append.prototype.getInner=function getInner(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},Append.prototype.forEachInner=function forEachInner(f,from,to,start){var leftLen=this.left.length;return!(from<leftLen&&!1===this.left.forEachInner(f,from,Math.min(to,leftLen),start))&&(!(to>leftLen&&!1===this.right.forEachInner(f,Math.max(from-leftLen,0),Math.min(this.length,to)-leftLen,start+leftLen))&&void 0)},Append.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){var leftLen=this.left.length;return!(from>leftLen&&!1===this.right.forEachInvertedInner(f,from-leftLen,Math.max(to,leftLen)-leftLen,start+leftLen))&&(!(to<leftLen&&!1===this.left.forEachInvertedInner(f,Math.min(from,leftLen),to,start))&&void 0)},Append.prototype.sliceInner=function sliceInner(from,to){if(0==from&&to==this.length)return this;var leftLen=this.left.length;return to<=leftLen?this.left.slice(from,to):from>=leftLen?this.right.slice(from-leftLen,to-leftLen):this.left.slice(from,leftLen).append(this.right.slice(0,to-leftLen))},Append.prototype.leafAppend=function leafAppend(other){var inner=this.right.leafAppend(other);if(inner)return new Append(this.left,inner)},Append.prototype.leafPrepend=function leafPrepend(other){var inner=this.left.leafPrepend(other);if(inner)return new Append(inner,this.right)},Append.prototype.appendInner=function appendInner(other){return this.left.depth>=Math.max(this.right.depth,other.depth)+1?new Append(this.left,new Append(this.right,other)):new Append(this,other)},Append}(RopeSequence),rope_sequence_dist_index_es=RopeSequence,Branch=function Branch(items,eventCount){this.items=items,this.eventCount=eventCount};Branch.prototype.popEvent=function popEvent(state,preserveItems){var this$1=this;if(0==this.eventCount)return null;for(var remap,mapFrom,end=this.items.length;;end--){if(this.items.get(end-1).selection){--end;break}}preserveItems&&(remap=this.remapping(end,this.items.length),mapFrom=remap.maps.length);var selection,remaining,transform=state.tr,addAfter=[],addBefore=[];return this.items.forEach((function(item,i){if(!item.step)return remap||(remap=this$1.remapping(end,i+1),mapFrom=remap.maps.length),mapFrom--,void addBefore.push(item);if(remap){addBefore.push(new Item(item.map));var map,step=item.step.map(remap.slice(mapFrom));step&&transform.maybeStep(step).doc&&(map=transform.mapping.maps[transform.mapping.maps.length-1],addAfter.push(new Item(map,null,null,addAfter.length+addBefore.length))),mapFrom--,map&&remap.appendMap(map,mapFrom)}else transform.maybeStep(item.step);return item.selection?(selection=remap?item.selection.map(remap.slice(mapFrom)):item.selection,remaining=new Branch(this$1.items.slice(0,end).append(addBefore.reverse().concat(addAfter)),this$1.eventCount-1),!1):void 0}),this.items.length,0),{remaining:remaining,transform:transform,selection:selection}},Branch.prototype.addTransform=function addTransform(transform,selection,histOptions,preserveItems){for(var newItems=[],eventCount=this.eventCount,oldItems=this.items,lastItem=!preserveItems&&oldItems.length?oldItems.get(oldItems.length-1):null,i=0;i<transform.steps.length;i++){var merged,step=transform.steps[i].invert(transform.docs[i]),item=new Item(transform.mapping.maps[i],step,selection);(merged=lastItem&&lastItem.merge(item))&&(item=merged,i?newItems.pop():oldItems=oldItems.slice(0,oldItems.length-1)),newItems.push(item),selection&&(eventCount++,selection=null),preserveItems||(lastItem=item)}var overflow=eventCount-histOptions.depth;return overflow>DEPTH_OVERFLOW&&(oldItems=function cutOffEvents(items,n){var cutPoint;return items.forEach((function(item,i){if(item.selection&&0==n--)return cutPoint=i,!1})),items.slice(cutPoint)}(oldItems,overflow),eventCount-=overflow),new Branch(oldItems.append(newItems),eventCount)},Branch.prototype.remapping=function remapping(from,to){var maps=new dist_index_es.a;return this.items.forEach((function(item,i){var mirrorPos=null!=item.mirrorOffset&&i-item.mirrorOffset>=from?maps.maps.length-item.mirrorOffset:null;maps.appendMap(item.map,mirrorPos)}),from,to),maps},Branch.prototype.addMaps=function addMaps(array){return 0==this.eventCount?this:new Branch(this.items.append(array.map((function(map){return new Item(map)}))),this.eventCount)},Branch.prototype.rebased=function rebased(rebasedTransform,rebasedCount){if(!this.eventCount)return this;var rebasedItems=[],start=Math.max(0,this.items.length-rebasedCount),mapping=rebasedTransform.mapping,newUntil=rebasedTransform.steps.length,eventCount=this.eventCount;this.items.forEach((function(item){item.selection&&eventCount--}),start);var iRebased=rebasedCount;this.items.forEach((function(item){var pos=mapping.getMirror(--iRebased);if(null!=pos){newUntil=Math.min(newUntil,pos);var map=mapping.maps[pos];if(item.step){var step=rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos]),selection=item.selection&&item.selection.map(mapping.slice(iRebased+1,pos));selection&&eventCount++,rebasedItems.push(new Item(map,step,selection))}else rebasedItems.push(new Item(map))}}),start);for(var newMaps=[],i=rebasedCount;i<newUntil;i++)newMaps.push(new Item(mapping.maps[i]));var items=this.items.slice(0,start).append(newMaps).append(rebasedItems),branch=new Branch(items,eventCount);return branch.emptyItemCount()>500&&(branch=branch.compress(this.items.length-rebasedItems.length)),branch},Branch.prototype.emptyItemCount=function emptyItemCount(){var count=0;return this.items.forEach((function(item){item.step||count++})),count},Branch.prototype.compress=function compress(upto){void 0===upto&&(upto=this.items.length);var remap=this.remapping(0,upto),mapFrom=remap.maps.length,items=[],events=0;return this.items.forEach((function(item,i){if(i>=upto)items.push(item),item.selection&&events++;else if(item.step){var step=item.step.map(remap.slice(mapFrom)),map=step&&step.getMap();if(mapFrom--,map&&remap.appendMap(map,mapFrom),step){var selection=item.selection&&item.selection.map(remap.slice(mapFrom));selection&&events++;var merged,newItem=new Item(map.invert(),step,selection),last=items.length-1;(merged=items.length&&items[last].merge(newItem))?items[last]=merged:items.push(newItem)}}else item.map&&mapFrom--}),this.items.length,0),new Branch(rope_sequence_dist_index_es.from(items.reverse()),events)},Branch.empty=new Branch(rope_sequence_dist_index_es.empty,0);var Item=function Item(map,step,selection,mirrorOffset){this.map=map,this.step=step,this.selection=selection,this.mirrorOffset=mirrorOffset};Item.prototype.merge=function merge(other){if(this.step&&other.step&&!other.selection){var step=other.step.merge(this.step);if(step)return new Item(step.getMap().invert(),step,this.selection)}};var HistoryState=function HistoryState(done,undone,prevRanges,prevTime){this.done=done,this.undone=undone,this.prevRanges=prevRanges,this.prevTime=prevTime},DEPTH_OVERFLOW=20;function rangesFor(map){var result=[];return map.forEach((function(_from,_to,from,to){return result.push(from,to)})),result}function mapRanges(ranges,mapping){if(!ranges)return null;for(var result=[],i=0;i<ranges.length;i+=2){var from=mapping.map(ranges[i],1),to=mapping.map(ranges[i+1],-1);from<=to&&result.push(from,to)}return result}function histTransaction(history,state,dispatch,redo){var preserveItems=mustPreserveItems(state),histOptions=historyKey.get(state).spec.config,pop=(redo?history.undone:history.done).popEvent(state,preserveItems);if(pop){var selection=pop.selection.resolve(pop.transform.doc),added=(redo?history.done:history.undone).addTransform(pop.transform,state.selection.getBookmark(),histOptions,preserveItems),newHist=new HistoryState(redo?added:pop.remaining,redo?pop.remaining:added,null,0);dispatch(pop.transform.setSelection(selection).setMeta(historyKey,{redo:redo,historyState:newHist}).scrollIntoView())}}var cachedPreserveItems=!1,cachedPreserveItemsPlugins=null;function mustPreserveItems(state){var plugins=state.plugins;if(cachedPreserveItemsPlugins!=plugins){cachedPreserveItems=!1,cachedPreserveItemsPlugins=plugins;for(var i=0;i<plugins.length;i++)if(plugins[i].spec.historyPreserveItems){cachedPreserveItems=!0;break}}return cachedPreserveItems}var historyKey=new index_es.e("history"),closeHistoryKey=new index_es.e("closeHistory");function index_es_history(config){return config={depth:config&&config.depth||100,newGroupDelay:config&&config.newGroupDelay||500},new index_es.d({key:historyKey,state:{init:function init(){return new HistoryState(Branch.empty,Branch.empty,null,0)},apply:function apply(tr,hist,state){return function applyTransaction(history,state,tr,options){var rebased,historyTr=tr.getMeta(historyKey);if(historyTr)return historyTr.historyState;tr.getMeta(closeHistoryKey)&&(history=new HistoryState(history.done,history.undone,null,0));var appended=tr.getMeta("appendedTransaction");if(0==tr.steps.length)return history;if(appended&&appended.getMeta(historyKey))return appended.getMeta(historyKey).redo?new HistoryState(history.done.addTransform(tr,null,options,mustPreserveItems(state)),history.undone,rangesFor(tr.mapping.maps[tr.steps.length-1]),history.prevTime):new HistoryState(history.done,history.undone.addTransform(tr,null,options,mustPreserveItems(state)),null,history.prevTime);if(!1===tr.getMeta("addToHistory")||appended&&!1===appended.getMeta("addToHistory"))return(rebased=tr.getMeta("rebased"))?new HistoryState(history.done.rebased(tr,rebased),history.undone.rebased(tr,rebased),mapRanges(history.prevRanges,tr.mapping),history.prevTime):new HistoryState(history.done.addMaps(tr.mapping.maps),history.undone.addMaps(tr.mapping.maps),mapRanges(history.prevRanges,tr.mapping),history.prevTime);var newGroup=0==history.prevTime||!appended&&(history.prevTime<(tr.time||0)-options.newGroupDelay||!function isAdjacentTo(transform,prevRanges){if(!prevRanges)return!1;if(!transform.docChanged)return!0;var adjacent=!1;return transform.mapping.maps[0].forEach((function(start,end){for(var i=0;i<prevRanges.length;i+=2)start<=prevRanges[i+1]&&end>=prevRanges[i]&&(adjacent=!0)})),adjacent}(tr,history.prevRanges)),prevRanges=appended?mapRanges(history.prevRanges,tr.mapping):rangesFor(tr.mapping.maps[tr.steps.length-1]);return new HistoryState(history.done.addTransform(tr,newGroup?state.selection.getBookmark():null,options,mustPreserveItems(state)),Branch.empty,prevRanges,tr.time)}(hist,state,tr,config)}},config:config,props:{handleDOMEvents:{beforeinput:function beforeinput(view,e){var handled="historyUndo"==e.inputType?undo(view.state,view.dispatch):"historyRedo"==e.inputType&&redo(view.state,view.dispatch);return handled&&e.preventDefault(),handled}}}})}function undo(state,dispatch){var hist=historyKey.getState(state);return!(!hist||0==hist.done.eventCount)&&(dispatch&&histTransaction(hist,state,dispatch,!1),!0)}function redo(state,dispatch){var hist=historyKey.getState(state);return!(!hist||0==hist.undone.eventCount)&&(dispatch&&histTransaction(hist,state,dispatch,!0),!0)}const History=tiptap_core_esm.c.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:state,dispatch:dispatch})=>undo(state,dispatch),redo:()=>({state:state,dispatch:dispatch})=>redo(state,dispatch)}),addProseMirrorPlugins(){return[index_es_history(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),HorizontalRule=tiptap_core_esm.f.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["hr",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes)]},addCommands(){return{setHorizontalRule:()=>({chain:chain})=>chain().insertContent({type:this.name}).command((({tr:tr,dispatch:dispatch})=>{var _a;if(dispatch){const{parent:parent,pos:pos}=tr.selection.$from,posAfter=pos+1;if(tr.doc.nodeAt(posAfter))tr.setSelection(index_es.g.create(tr.doc,posAfter));else{const node=null===(_a=parent.type.contentMatch.defaultType)||void 0===_a?void 0:_a.create();node&&(tr.insert(posAfter,node),tr.setSelection(index_es.g.create(tr.doc,posAfter)))}tr.scrollIntoView()}return!0})).run()}},addInputRules(){return[Object(tiptap_core_esm.U)({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),tiptap_extension_italic_esm_starInputRegex=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,tiptap_extension_italic_esm_starPasteRegex=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,tiptap_extension_italic_esm_underscoreInputRegex=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,tiptap_extension_italic_esm_underscorePasteRegex=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Italic=tiptap_core_esm.e.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:node=>"normal"!==node.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["em",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{setItalic:()=>({commands:commands})=>commands.setMark(this.name),toggleItalic:()=>({commands:commands})=>commands.toggleMark(this.name),unsetItalic:()=>({commands:commands})=>commands.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Object(tiptap_core_esm.R)({find:tiptap_extension_italic_esm_starInputRegex,type:this.type}),Object(tiptap_core_esm.R)({find:tiptap_extension_italic_esm_underscoreInputRegex,type:this.type})]},addPasteRules(){return[Object(tiptap_core_esm.S)({find:tiptap_extension_italic_esm_starPasteRegex,type:this.type}),Object(tiptap_core_esm.S)({find:tiptap_extension_italic_esm_underscorePasteRegex,type:this.type})]}}),ListItem=tiptap_core_esm.f.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["li",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),tiptap_extension_ordered_list_esm_inputRegex=/^(\d+)\.\s$/,OrderedList=tiptap_core_esm.f.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:element=>element.hasAttribute("start")?parseInt(element.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:HTMLAttributes}){const{start:start,...attributesWithoutStart}=HTMLAttributes;return 1===start?["ol",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,attributesWithoutStart),0]:["ol",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{toggleOrderedList:()=>({commands:commands})=>commands.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Object(tiptap_core_esm.ab)({find:tiptap_extension_ordered_list_esm_inputRegex,type:this.type,getAttributes:match=>({start:+match[1]}),joinPredicate:(match,node)=>node.childCount+node.attrs.start===+match[1]})]}}),Paragraph=tiptap_core_esm.f.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:HTMLAttributes}){return["p",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{setParagraph:()=>({commands:commands})=>commands.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),tiptap_extension_strike_esm_inputRegex=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,tiptap_extension_strike_esm_pasteRegex=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Strike=tiptap_core_esm.e.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:style=>!!style.includes("line-through")&&{}}],renderHTML({HTMLAttributes:HTMLAttributes}){return["s",Object(tiptap_core_esm.T)(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands(){return{setStrike:()=>({commands:commands})=>commands.setMark(this.name),toggleStrike:()=>({commands:commands})=>commands.toggleMark(this.name),unsetStrike:()=>({commands:commands})=>commands.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Object(tiptap_core_esm.R)({find:tiptap_extension_strike_esm_inputRegex,type:this.type})]},addPasteRules(){return[Object(tiptap_core_esm.S)({find:tiptap_extension_strike_esm_pasteRegex,type:this.type})]}}),Text=tiptap_core_esm.f.create({name:"text",group:"inline"}),StarterKit=tiptap_core_esm.c.create({name:"starterKit",addExtensions(){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t;const extensions=[];return!1!==this.options.blockquote&&extensions.push(tiptap_extension_blockquote_esm.default.configure(null===(_a=this.options)||void 0===_a?void 0:_a.blockquote)),!1!==this.options.bold&&extensions.push(Bold.configure(null===(_b=this.options)||void 0===_b?void 0:_b.bold)),!1!==this.options.bulletList&&extensions.push(BulletList.configure(null===(_c=this.options)||void 0===_c?void 0:_c.bulletList)),!1!==this.options.code&&extensions.push(Code.configure(null===(_d=this.options)||void 0===_d?void 0:_d.code)),!1!==this.options.codeBlock&&extensions.push(CodeBlock.configure(null===(_e=this.options)||void 0===_e?void 0:_e.codeBlock)),!1!==this.options.document&&extensions.push(Document.configure(null===(_f=this.options)||void 0===_f?void 0:_f.document)),!1!==this.options.dropcursor&&extensions.push(Dropcursor.configure(null===(_g=this.options)||void 0===_g?void 0:_g.dropcursor)),!1!==this.options.gapcursor&&extensions.push(Gapcursor.configure(null===(_h=this.options)||void 0===_h?void 0:_h.gapcursor)),!1!==this.options.hardBreak&&extensions.push(HardBreak.configure(null===(_j=this.options)||void 0===_j?void 0:_j.hardBreak)),!1!==this.options.heading&&extensions.push(Heading.configure(null===(_k=this.options)||void 0===_k?void 0:_k.heading)),!1!==this.options.history&&extensions.push(History.configure(null===(_l=this.options)||void 0===_l?void 0:_l.history)),!1!==this.options.horizontalRule&&extensions.push(HorizontalRule.configure(null===(_m=this.options)||void 0===_m?void 0:_m.horizontalRule)),!1!==this.options.italic&&extensions.push(Italic.configure(null===(_o=this.options)||void 0===_o?void 0:_o.italic)),!1!==this.options.listItem&&extensions.push(ListItem.configure(null===(_p=this.options)||void 0===_p?void 0:_p.listItem)),!1!==this.options.orderedList&&extensions.push(OrderedList.configure(null===(_q=this.options)||void 0===_q?void 0:_q.orderedList)),!1!==this.options.paragraph&&extensions.push(Paragraph.configure(null===(_r=this.options)||void 0===_r?void 0:_r.paragraph)),!1!==this.options.strike&&extensions.push(Strike.configure(null===(_s=this.options)||void 0===_s?void 0:_s.strike)),!1!==this.options.text&&extensions.push(Text.configure(null===(_t=this.options)||void 0===_t?void 0:_t.text)),extensions}})},2495:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CommandManager",(function(){return tiptap_core_esm.a})),__webpack_require__.d(__webpack_exports__,"Extension",(function(){return tiptap_core_esm.c})),__webpack_require__.d(__webpack_exports__,"InputRule",(function(){return tiptap_core_esm.d})),__webpack_require__.d(__webpack_exports__,"Mark",(function(){return tiptap_core_esm.e})),__webpack_require__.d(__webpack_exports__,"Node",(function(){return tiptap_core_esm.f})),__webpack_require__.d(__webpack_exports__,"NodeView",(function(){return tiptap_core_esm.g})),__webpack_require__.d(__webpack_exports__,"PasteRule",(function(){return tiptap_core_esm.h})),__webpack_require__.d(__webpack_exports__,"Tracker",(function(){return tiptap_core_esm.i})),__webpack_require__.d(__webpack_exports__,"callOrReturn",(function(){return tiptap_core_esm.j})),__webpack_require__.d(__webpack_exports__,"combineTransactionSteps",(function(){return tiptap_core_esm.k})),__webpack_require__.d(__webpack_exports__,"defaultBlockAt",(function(){return tiptap_core_esm.l})),__webpack_require__.d(__webpack_exports__,"escapeForRegEx",(function(){return tiptap_core_esm.m})),__webpack_require__.d(__webpack_exports__,"extensions",(function(){return tiptap_core_esm.n})),__webpack_require__.d(__webpack_exports__,"findChildren",(function(){return tiptap_core_esm.o})),__webpack_require__.d(__webpack_exports__,"findChildrenInRange",(function(){return tiptap_core_esm.p})),__webpack_require__.d(__webpack_exports__,"findParentNode",(function(){return tiptap_core_esm.q})),__webpack_require__.d(__webpack_exports__,"findParentNodeClosestToPos",(function(){return tiptap_core_esm.r})),__webpack_require__.d(__webpack_exports__,"generateHTML",(function(){return tiptap_core_esm.s})),__webpack_require__.d(__webpack_exports__,"generateJSON",(function(){return tiptap_core_esm.t})),__webpack_require__.d(__webpack_exports__,"generateText",(function(){return tiptap_core_esm.u})),__webpack_require__.d(__webpack_exports__,"getAttributes",(function(){return tiptap_core_esm.v})),__webpack_require__.d(__webpack_exports__,"getChangedRanges",(function(){return tiptap_core_esm.w})),__webpack_require__.d(__webpack_exports__,"getDebugJSON",(function(){return tiptap_core_esm.x})),__webpack_require__.d(__webpack_exports__,"getExtensionField",(function(){return tiptap_core_esm.y})),__webpack_require__.d(__webpack_exports__,"getHTMLFromFragment",(function(){return tiptap_core_esm.z})),__webpack_require__.d(__webpack_exports__,"getMarkAttributes",(function(){return tiptap_core_esm.A})),__webpack_require__.d(__webpack_exports__,"getMarkRange",(function(){return tiptap_core_esm.B})),__webpack_require__.d(__webpack_exports__,"getMarkType",(function(){return tiptap_core_esm.C})),__webpack_require__.d(__webpack_exports__,"getMarksBetween",(function(){return tiptap_core_esm.D})),__webpack_require__.d(__webpack_exports__,"getNodeAttributes",(function(){return tiptap_core_esm.E})),__webpack_require__.d(__webpack_exports__,"getNodeType",(function(){return tiptap_core_esm.F})),__webpack_require__.d(__webpack_exports__,"getSchema",(function(){return tiptap_core_esm.G})),__webpack_require__.d(__webpack_exports__,"getText",(function(){return tiptap_core_esm.H})),__webpack_require__.d(__webpack_exports__,"getTextBetween",(function(){return tiptap_core_esm.I})),__webpack_require__.d(__webpack_exports__,"inputRulesPlugin",(function(){return tiptap_core_esm.J})),__webpack_require__.d(__webpack_exports__,"isActive",(function(){return tiptap_core_esm.K})),__webpack_require__.d(__webpack_exports__,"isList",(function(){return tiptap_core_esm.L})),__webpack_require__.d(__webpack_exports__,"isMarkActive",(function(){return tiptap_core_esm.M})),__webpack_require__.d(__webpack_exports__,"isNodeActive",(function(){return tiptap_core_esm.N})),__webpack_require__.d(__webpack_exports__,"isNodeEmpty",(function(){return tiptap_core_esm.O})),__webpack_require__.d(__webpack_exports__,"isNodeSelection",(function(){return tiptap_core_esm.P})),__webpack_require__.d(__webpack_exports__,"isTextSelection",(function(){return tiptap_core_esm.Q})),__webpack_require__.d(__webpack_exports__,"markInputRule",(function(){return tiptap_core_esm.R})),__webpack_require__.d(__webpack_exports__,"markPasteRule",(function(){return tiptap_core_esm.S})),__webpack_require__.d(__webpack_exports__,"mergeAttributes",(function(){return tiptap_core_esm.T})),__webpack_require__.d(__webpack_exports__,"nodeInputRule",(function(){return tiptap_core_esm.U})),__webpack_require__.d(__webpack_exports__,"pasteRulesPlugin",(function(){return tiptap_core_esm.V})),__webpack_require__.d(__webpack_exports__,"posToDOMRect",(function(){return tiptap_core_esm.W})),__webpack_require__.d(__webpack_exports__,"textInputRule",(function(){return tiptap_core_esm.X})),__webpack_require__.d(__webpack_exports__,"textPasteRule",(function(){return tiptap_core_esm.Y})),__webpack_require__.d(__webpack_exports__,"textblockTypeInputRule",(function(){return tiptap_core_esm.Z})),__webpack_require__.d(__webpack_exports__,"wrappingInputRule",(function(){return tiptap_core_esm.ab})),__webpack_require__.d(__webpack_exports__,"BubbleMenu",(function(){return tiptap_vue_2_esm_BubbleMenu})),__webpack_require__.d(__webpack_exports__,"Editor",(function(){return tiptap_vue_2_esm_Editor})),__webpack_require__.d(__webpack_exports__,"EditorContent",(function(){return EditorContent})),__webpack_require__.d(__webpack_exports__,"FloatingMenu",(function(){return tiptap_vue_2_esm_FloatingMenu})),__webpack_require__.d(__webpack_exports__,"NodeViewContent",(function(){return NodeViewContent})),__webpack_require__.d(__webpack_exports__,"NodeViewWrapper",(function(){return NodeViewWrapper})),__webpack_require__.d(__webpack_exports__,"VueNodeViewRenderer",(function(){return VueNodeViewRenderer})),__webpack_require__.d(__webpack_exports__,"VueRenderer",(function(){return tiptap_vue_2_esm_VueRenderer})),__webpack_require__.d(__webpack_exports__,"nodeViewProps",(function(){return nodeViewProps}));var tiptap_core_esm=__webpack_require__(2339),index_es=__webpack_require__(2686),lib_popper=__webpack_require__(896),applyStyles=__webpack_require__(234),TOUCH_OPTIONS={passive:!0,capture:!0},TIPPY_DEFAULT_APPEND_TO=function TIPPY_DEFAULT_APPEND_TO(){return document.body};function getValueAtIndexOrReturn(value,index,defaultValue){if(Array.isArray(value)){var v=value[index];return null==v?Array.isArray(defaultValue)?defaultValue[index]:defaultValue:v}return value}function isType(value,type){var str={}.toString.call(value);return 0===str.indexOf("[object")&&str.indexOf(type+"]")>-1}function invokeWithArgsOrReturn(value,args){return"function"==typeof value?value.apply(void 0,args):value}function debounce(fn,ms){return 0===ms?fn:function(arg){clearTimeout(timeout),timeout=setTimeout((function(){fn(arg)}),ms)};var timeout}function normalizeToArray(value){return[].concat(value)}function pushIfUnique(arr,value){-1===arr.indexOf(value)&&arr.push(value)}function getBasePlacement(placement){return placement.split("-")[0]}function arrayFrom(value){return[].slice.call(value)}function removeUndefinedProps(obj){return Object.keys(obj).reduce((function(acc,key){return void 0!==obj[key]&&(acc[key]=obj[key]),acc}),{})}function div(){return document.createElement("div")}function isElement(value){return["Element","Fragment"].some((function(type){return isType(value,type)}))}function isMouseEvent(value){return isType(value,"MouseEvent")}function isReferenceElement(value){return!(!value||!value._tippy||value._tippy.reference!==value)}function getArrayOfElements(value){return isElement(value)?[value]:function isNodeList(value){return isType(value,"NodeList")}(value)?arrayFrom(value):Array.isArray(value)?value:arrayFrom(document.querySelectorAll(value))}function setTransitionDuration(els,value){els.forEach((function(el){el&&(el.style.transitionDuration=value+"ms")}))}function setVisibilityState(els,state){els.forEach((function(el){el&&el.setAttribute("data-state",state)}))}function getOwnerDocument(elementOrElements){var _element$ownerDocumen,element=normalizeToArray(elementOrElements)[0];return null!=element&&null!=(_element$ownerDocumen=element.ownerDocument)&&_element$ownerDocumen.body?element.ownerDocument:document}function updateTransitionEndListener(box,action,listener){var method=action+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(event){box[method](event,listener)}))}function actualContains(parent,child){for(var target=child;target;){var _target$getRootNode;if(parent.contains(target))return!0;target=null==target.getRootNode||null==(_target$getRootNode=target.getRootNode())?void 0:_target$getRootNode.host}return!1}var currentInput={isTouch:!1},lastMouseMoveTime=0;function onDocumentTouchStart(){currentInput.isTouch||(currentInput.isTouch=!0,window.performance&&document.addEventListener("mousemove",onDocumentMouseMove))}function onDocumentMouseMove(){var now=performance.now();now-lastMouseMoveTime<20&&(currentInput.isTouch=!1,document.removeEventListener("mousemove",onDocumentMouseMove)),lastMouseMoveTime=now}function onWindowBlur(){var activeElement=document.activeElement;if(isReferenceElement(activeElement)){var instance=activeElement._tippy;activeElement.blur&&!instance.state.isVisible&&activeElement.blur()}}var isIE11=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto;var pluginProps={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},defaultProps=Object.assign({appendTo:TIPPY_DEFAULT_APPEND_TO,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function onAfterUpdate(){},onBeforeUpdate:function onBeforeUpdate(){},onCreate:function onCreate(){},onDestroy:function onDestroy(){},onHidden:function onHidden(){},onHide:function onHide(){},onMount:function onMount(){},onShow:function onShow(){},onShown:function onShown(){},onTrigger:function onTrigger(){},onUntrigger:function onUntrigger(){},onClickOutside:function onClickOutside(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},pluginProps,{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),defaultKeys=Object.keys(defaultProps);function getExtendedPassedProps(passedProps){var pluginProps=(passedProps.plugins||[]).reduce((function(acc,plugin){var _name,name=plugin.name,defaultValue=plugin.defaultValue;name&&(acc[name]=void 0!==passedProps[name]?passedProps[name]:null!=(_name=defaultProps[name])?_name:defaultValue);return acc}),{});return Object.assign({},passedProps,pluginProps)}function evaluateProps(reference,props){var out=Object.assign({},props,{content:invokeWithArgsOrReturn(props.content,[reference])},props.ignoreAttributes?{}:function getDataAttributeProps(reference,plugins){return(plugins?Object.keys(getExtendedPassedProps(Object.assign({},defaultProps,{plugins:plugins}))):defaultKeys).reduce((function(acc,key){var valueAsString=(reference.getAttribute("data-tippy-"+key)||"").trim();if(!valueAsString)return acc;if("content"===key)acc[key]=valueAsString;else try{acc[key]=JSON.parse(valueAsString)}catch(e){acc[key]=valueAsString}return acc}),{})}(reference,props.plugins));return out.aria=Object.assign({},defaultProps.aria,out.aria),out.aria={expanded:"auto"===out.aria.expanded?props.interactive:out.aria.expanded,content:"auto"===out.aria.content?props.interactive?null:"describedby":out.aria.content},out}function dangerouslySetInnerHTML(element,html){element.innerHTML=html}function createArrowElement(value){var arrow=div();return!0===value?arrow.className="tippy-arrow":(arrow.className="tippy-svg-arrow",isElement(value)?arrow.appendChild(value):dangerouslySetInnerHTML(arrow,value)),arrow}function tippy_esm_setContent(content,props){isElement(props.content)?(dangerouslySetInnerHTML(content,""),content.appendChild(props.content)):"function"!=typeof props.content&&(props.allowHTML?dangerouslySetInnerHTML(content,props.content):content.textContent=props.content)}function getChildren(popper){var box=popper.firstElementChild,boxChildren=arrayFrom(box.children);return{box:box,content:boxChildren.find((function(node){return node.classList.contains("tippy-content")})),arrow:boxChildren.find((function(node){return node.classList.contains("tippy-arrow")||node.classList.contains("tippy-svg-arrow")})),backdrop:boxChildren.find((function(node){return node.classList.contains("tippy-backdrop")}))}}function render(instance){var popper=div(),box=div();box.className="tippy-box",box.setAttribute("data-state","hidden"),box.setAttribute("tabindex","-1");var content=div();function onUpdate(prevProps,nextProps){var _getChildren=getChildren(popper),box=_getChildren.box,content=_getChildren.content,arrow=_getChildren.arrow;nextProps.theme?box.setAttribute("data-theme",nextProps.theme):box.removeAttribute("data-theme"),"string"==typeof nextProps.animation?box.setAttribute("data-animation",nextProps.animation):box.removeAttribute("data-animation"),nextProps.inertia?box.setAttribute("data-inertia",""):box.removeAttribute("data-inertia"),box.style.maxWidth="number"==typeof nextProps.maxWidth?nextProps.maxWidth+"px":nextProps.maxWidth,nextProps.role?box.setAttribute("role",nextProps.role):box.removeAttribute("role"),prevProps.content===nextProps.content&&prevProps.allowHTML===nextProps.allowHTML||tippy_esm_setContent(content,instance.props),nextProps.arrow?arrow?prevProps.arrow!==nextProps.arrow&&(box.removeChild(arrow),box.appendChild(createArrowElement(nextProps.arrow))):box.appendChild(createArrowElement(nextProps.arrow)):arrow&&box.removeChild(arrow)}return content.className="tippy-content",content.setAttribute("data-state","hidden"),tippy_esm_setContent(content,instance.props),popper.appendChild(box),box.appendChild(content),onUpdate(instance.props,instance.props),{popper:popper,onUpdate:onUpdate}}render.$$tippy=!0;var idCounter=1,mouseMoveListeners=[],mountedInstances=[];function createTippy(reference,passedProps){var showTimeout,hideTimeout,scheduleHideAnimationFrame,lastTriggerEvent,currentTransitionEndListener,onFirstUpdate,currentTarget,props=evaluateProps(reference,Object.assign({},defaultProps,getExtendedPassedProps(removeUndefinedProps(passedProps)))),isVisibleFromClick=!1,didHideDueToDocumentMouseDown=!1,didTouchMove=!1,ignoreOnFirstUpdate=!1,listeners=[],debouncedOnMouseMove=debounce(onMouseMove,props.interactiveDebounce),id=idCounter++,plugins=function unique(arr){return arr.filter((function(item,index){return arr.indexOf(item)===index}))}(props.plugins),instance={id:id,reference:reference,popper:div(),popperInstance:null,props:props,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:plugins,clearDelayTimeouts:function clearDelayTimeouts(){clearTimeout(showTimeout),clearTimeout(hideTimeout),cancelAnimationFrame(scheduleHideAnimationFrame)},setProps:function setProps(partialProps){0;if(instance.state.isDestroyed)return;invokeHook("onBeforeUpdate",[instance,partialProps]),removeListeners();var prevProps=instance.props,nextProps=evaluateProps(reference,Object.assign({},prevProps,removeUndefinedProps(partialProps),{ignoreAttributes:!0}));instance.props=nextProps,addListeners(),prevProps.interactiveDebounce!==nextProps.interactiveDebounce&&(cleanupInteractiveMouseListeners(),debouncedOnMouseMove=debounce(onMouseMove,nextProps.interactiveDebounce));prevProps.triggerTarget&&!nextProps.triggerTarget?normalizeToArray(prevProps.triggerTarget).forEach((function(node){node.removeAttribute("aria-expanded")})):nextProps.triggerTarget&&reference.removeAttribute("aria-expanded");handleAriaExpandedAttribute(),handleStyles(),onUpdate&&onUpdate(prevProps,nextProps);instance.popperInstance&&(createPopperInstance(),getNestedPopperTree().forEach((function(nestedPopper){requestAnimationFrame(nestedPopper._tippy.popperInstance.forceUpdate)})));invokeHook("onAfterUpdate",[instance,partialProps])},setContent:function setContent(content){instance.setProps({content:content})},show:function show(){0;var isAlreadyVisible=instance.state.isVisible,isDestroyed=instance.state.isDestroyed,isDisabled=!instance.state.isEnabled,isTouchAndTouchDisabled=currentInput.isTouch&&!instance.props.touch,duration=getValueAtIndexOrReturn(instance.props.duration,0,defaultProps.duration);if(isAlreadyVisible||isDestroyed||isDisabled||isTouchAndTouchDisabled)return;if(getCurrentTarget().hasAttribute("disabled"))return;if(invokeHook("onShow",[instance],!1),!1===instance.props.onShow(instance))return;instance.state.isVisible=!0,getIsDefaultRenderFn()&&(popper.style.visibility="visible");handleStyles(),addDocumentPress(),instance.state.isMounted||(popper.style.transition="none");if(getIsDefaultRenderFn()){var _getDefaultTemplateCh2=getDefaultTemplateChildren(),box=_getDefaultTemplateCh2.box,content=_getDefaultTemplateCh2.content;setTransitionDuration([box,content],0)}onFirstUpdate=function onFirstUpdate(){var _instance$popperInsta2;if(instance.state.isVisible&&!ignoreOnFirstUpdate){if(ignoreOnFirstUpdate=!0,popper.offsetHeight,popper.style.transition=instance.props.moveTransition,getIsDefaultRenderFn()&&instance.props.animation){var _getDefaultTemplateCh3=getDefaultTemplateChildren(),_box=_getDefaultTemplateCh3.box,_content=_getDefaultTemplateCh3.content;setTransitionDuration([_box,_content],duration),setVisibilityState([_box,_content],"visible")}handleAriaContentAttribute(),handleAriaExpandedAttribute(),pushIfUnique(mountedInstances,instance),null==(_instance$popperInsta2=instance.popperInstance)||_instance$popperInsta2.forceUpdate(),invokeHook("onMount",[instance]),instance.props.animation&&getIsDefaultRenderFn()&&function onTransitionedIn(duration,callback){onTransitionEnd(duration,callback)}(duration,(function(){instance.state.isShown=!0,invokeHook("onShown",[instance])}))}},function mount(){var parentNode,appendTo=instance.props.appendTo,node=getCurrentTarget();parentNode=instance.props.interactive&&appendTo===TIPPY_DEFAULT_APPEND_TO||"parent"===appendTo?node.parentNode:invokeWithArgsOrReturn(appendTo,[node]);parentNode.contains(popper)||parentNode.appendChild(popper);instance.state.isMounted=!0,createPopperInstance(),!1}()},hide:function hide(){0;var isAlreadyHidden=!instance.state.isVisible,isDestroyed=instance.state.isDestroyed,isDisabled=!instance.state.isEnabled,duration=getValueAtIndexOrReturn(instance.props.duration,1,defaultProps.duration);if(isAlreadyHidden||isDestroyed||isDisabled)return;if(invokeHook("onHide",[instance],!1),!1===instance.props.onHide(instance))return;instance.state.isVisible=!1,instance.state.isShown=!1,ignoreOnFirstUpdate=!1,isVisibleFromClick=!1,getIsDefaultRenderFn()&&(popper.style.visibility="hidden");if(cleanupInteractiveMouseListeners(),removeDocumentPress(),handleStyles(!0),getIsDefaultRenderFn()){var _getDefaultTemplateCh4=getDefaultTemplateChildren(),box=_getDefaultTemplateCh4.box,content=_getDefaultTemplateCh4.content;instance.props.animation&&(setTransitionDuration([box,content],duration),setVisibilityState([box,content],"hidden"))}handleAriaContentAttribute(),handleAriaExpandedAttribute(),instance.props.animation?getIsDefaultRenderFn()&&function onTransitionedOut(duration,callback){onTransitionEnd(duration,(function(){!instance.state.isVisible&&popper.parentNode&&popper.parentNode.contains(popper)&&callback()}))}(duration,instance.unmount):instance.unmount()},hideWithInteractivity:function hideWithInteractivity(event){0;getDocument().addEventListener("mousemove",debouncedOnMouseMove),pushIfUnique(mouseMoveListeners,debouncedOnMouseMove),debouncedOnMouseMove(event)},enable:function enable(){instance.state.isEnabled=!0},disable:function disable(){instance.hide(),instance.state.isEnabled=!1},unmount:function unmount(){0;instance.state.isVisible&&instance.hide();if(!instance.state.isMounted)return;destroyPopperInstance(),getNestedPopperTree().forEach((function(nestedPopper){nestedPopper._tippy.unmount()})),popper.parentNode&&popper.parentNode.removeChild(popper);mountedInstances=mountedInstances.filter((function(i){return i!==instance})),instance.state.isMounted=!1,invokeHook("onHidden",[instance])},destroy:function destroy(){0;if(instance.state.isDestroyed)return;instance.clearDelayTimeouts(),instance.unmount(),removeListeners(),delete reference._tippy,instance.state.isDestroyed=!0,invokeHook("onDestroy",[instance])}};if(!props.render)return instance;var _props$render=props.render(instance),popper=_props$render.popper,onUpdate=_props$render.onUpdate;popper.setAttribute("data-tippy-root",""),popper.id="tippy-"+instance.id,instance.popper=popper,reference._tippy=instance,popper._tippy=instance;var pluginsHooks=plugins.map((function(plugin){return plugin.fn(instance)})),hasAriaExpanded=reference.hasAttribute("aria-expanded");return addListeners(),handleAriaExpandedAttribute(),handleStyles(),invokeHook("onCreate",[instance]),props.showOnCreate&&scheduleShow(),popper.addEventListener("mouseenter",(function(){instance.props.interactive&&instance.state.isVisible&&instance.clearDelayTimeouts()})),popper.addEventListener("mouseleave",(function(){instance.props.interactive&&instance.props.trigger.indexOf("mouseenter")>=0&&getDocument().addEventListener("mousemove",debouncedOnMouseMove)})),instance;function getNormalizedTouchSettings(){var touch=instance.props.touch;return Array.isArray(touch)?touch:[touch,0]}function getIsCustomTouchBehavior(){return"hold"===getNormalizedTouchSettings()[0]}function getIsDefaultRenderFn(){var _instance$props$rende;return!(null==(_instance$props$rende=instance.props.render)||!_instance$props$rende.$$tippy)}function getCurrentTarget(){return currentTarget||reference}function getDocument(){var parent=getCurrentTarget().parentNode;return parent?getOwnerDocument(parent):document}function getDefaultTemplateChildren(){return getChildren(popper)}function getDelay(isShow){return instance.state.isMounted&&!instance.state.isVisible||currentInput.isTouch||lastTriggerEvent&&"focus"===lastTriggerEvent.type?0:getValueAtIndexOrReturn(instance.props.delay,isShow?0:1,defaultProps.delay)}function handleStyles(fromHide){void 0===fromHide&&(fromHide=!1),popper.style.pointerEvents=instance.props.interactive&&!fromHide?"":"none",popper.style.zIndex=""+instance.props.zIndex}function invokeHook(hook,args,shouldInvokePropsHook){var _instance$props;(void 0===shouldInvokePropsHook&&(shouldInvokePropsHook=!0),pluginsHooks.forEach((function(pluginHooks){pluginHooks[hook]&&pluginHooks[hook].apply(pluginHooks,args)})),shouldInvokePropsHook)&&(_instance$props=instance.props)[hook].apply(_instance$props,args)}function handleAriaContentAttribute(){var aria=instance.props.aria;if(aria.content){var attr="aria-"+aria.content,id=popper.id;normalizeToArray(instance.props.triggerTarget||reference).forEach((function(node){var currentValue=node.getAttribute(attr);if(instance.state.isVisible)node.setAttribute(attr,currentValue?currentValue+" "+id:id);else{var nextValue=currentValue&&currentValue.replace(id,"").trim();nextValue?node.setAttribute(attr,nextValue):node.removeAttribute(attr)}}))}}function handleAriaExpandedAttribute(){!hasAriaExpanded&&instance.props.aria.expanded&&normalizeToArray(instance.props.triggerTarget||reference).forEach((function(node){instance.props.interactive?node.setAttribute("aria-expanded",instance.state.isVisible&&node===getCurrentTarget()?"true":"false"):node.removeAttribute("aria-expanded")}))}function cleanupInteractiveMouseListeners(){getDocument().removeEventListener("mousemove",debouncedOnMouseMove),mouseMoveListeners=mouseMoveListeners.filter((function(listener){return listener!==debouncedOnMouseMove}))}function onDocumentPress(event){if(!currentInput.isTouch||!didTouchMove&&"mousedown"!==event.type){var actualTarget=event.composedPath&&event.composedPath()[0]||event.target;if(!instance.props.interactive||!actualContains(popper,actualTarget)){if(normalizeToArray(instance.props.triggerTarget||reference).some((function(el){return actualContains(el,actualTarget)}))){if(currentInput.isTouch)return;if(instance.state.isVisible&&instance.props.trigger.indexOf("click")>=0)return}else invokeHook("onClickOutside",[instance,event]);!0===instance.props.hideOnClick&&(instance.clearDelayTimeouts(),instance.hide(),didHideDueToDocumentMouseDown=!0,setTimeout((function(){didHideDueToDocumentMouseDown=!1})),instance.state.isMounted||removeDocumentPress())}}}function onTouchMove(){didTouchMove=!0}function onTouchStart(){didTouchMove=!1}function addDocumentPress(){var doc=getDocument();doc.addEventListener("mousedown",onDocumentPress,!0),doc.addEventListener("touchend",onDocumentPress,TOUCH_OPTIONS),doc.addEventListener("touchstart",onTouchStart,TOUCH_OPTIONS),doc.addEventListener("touchmove",onTouchMove,TOUCH_OPTIONS)}function removeDocumentPress(){var doc=getDocument();doc.removeEventListener("mousedown",onDocumentPress,!0),doc.removeEventListener("touchend",onDocumentPress,TOUCH_OPTIONS),doc.removeEventListener("touchstart",onTouchStart,TOUCH_OPTIONS),doc.removeEventListener("touchmove",onTouchMove,TOUCH_OPTIONS)}function onTransitionEnd(duration,callback){var box=getDefaultTemplateChildren().box;function listener(event){event.target===box&&(updateTransitionEndListener(box,"remove",listener),callback())}if(0===duration)return callback();updateTransitionEndListener(box,"remove",currentTransitionEndListener),updateTransitionEndListener(box,"add",listener),currentTransitionEndListener=listener}function on(eventType,handler,options){void 0===options&&(options=!1),normalizeToArray(instance.props.triggerTarget||reference).forEach((function(node){node.addEventListener(eventType,handler,options),listeners.push({node:node,eventType:eventType,handler:handler,options:options})}))}function addListeners(){getIsCustomTouchBehavior()&&(on("touchstart",onTrigger,{passive:!0}),on("touchend",onMouseLeave,{passive:!0})),function splitBySpaces(value){return value.split(/\s+/).filter(Boolean)}(instance.props.trigger).forEach((function(eventType){if("manual"!==eventType)switch(on(eventType,onTrigger),eventType){case"mouseenter":on("mouseleave",onMouseLeave);break;case"focus":on(isIE11?"focusout":"blur",onBlurOrFocusOut);break;case"focusin":on("focusout",onBlurOrFocusOut)}}))}function removeListeners(){listeners.forEach((function(_ref){var node=_ref.node,eventType=_ref.eventType,handler=_ref.handler,options=_ref.options;node.removeEventListener(eventType,handler,options)})),listeners=[]}function onTrigger(event){var _lastTriggerEvent,shouldScheduleClickHide=!1;if(instance.state.isEnabled&&!isEventListenerStopped(event)&&!didHideDueToDocumentMouseDown){var wasFocused="focus"===(null==(_lastTriggerEvent=lastTriggerEvent)?void 0:_lastTriggerEvent.type);lastTriggerEvent=event,currentTarget=event.currentTarget,handleAriaExpandedAttribute(),!instance.state.isVisible&&isMouseEvent(event)&&mouseMoveListeners.forEach((function(listener){return listener(event)})),"click"===event.type&&(instance.props.trigger.indexOf("mouseenter")<0||isVisibleFromClick)&&!1!==instance.props.hideOnClick&&instance.state.isVisible?shouldScheduleClickHide=!0:scheduleShow(event),"click"===event.type&&(isVisibleFromClick=!shouldScheduleClickHide),shouldScheduleClickHide&&!wasFocused&&scheduleHide(event)}}function onMouseMove(event){var target=event.target,isCursorOverReferenceOrPopper=getCurrentTarget().contains(target)||popper.contains(target);if("mousemove"!==event.type||!isCursorOverReferenceOrPopper){var popperTreeData=getNestedPopperTree().concat(popper).map((function(popper){var _instance$popperInsta,state=null==(_instance$popperInsta=popper._tippy.popperInstance)?void 0:_instance$popperInsta.state;return state?{popperRect:popper.getBoundingClientRect(),popperState:state,props:props}:null})).filter(Boolean);(function isCursorOutsideInteractiveBorder(popperTreeData,event){var clientX=event.clientX,clientY=event.clientY;return popperTreeData.every((function(_ref){var popperRect=_ref.popperRect,popperState=_ref.popperState,interactiveBorder=_ref.props.interactiveBorder,basePlacement=getBasePlacement(popperState.placement),offsetData=popperState.modifiersData.offset;if(!offsetData)return!0;var topDistance="bottom"===basePlacement?offsetData.top.y:0,bottomDistance="top"===basePlacement?offsetData.bottom.y:0,leftDistance="right"===basePlacement?offsetData.left.x:0,rightDistance="left"===basePlacement?offsetData.right.x:0,exceedsTop=popperRect.top-clientY+topDistance>interactiveBorder,exceedsBottom=clientY-popperRect.bottom-bottomDistance>interactiveBorder,exceedsLeft=popperRect.left-clientX+leftDistance>interactiveBorder,exceedsRight=clientX-popperRect.right-rightDistance>interactiveBorder;return exceedsTop||exceedsBottom||exceedsLeft||exceedsRight}))})(popperTreeData,event)&&(cleanupInteractiveMouseListeners(),scheduleHide(event))}}function onMouseLeave(event){isEventListenerStopped(event)||instance.props.trigger.indexOf("click")>=0&&isVisibleFromClick||(instance.props.interactive?instance.hideWithInteractivity(event):scheduleHide(event))}function onBlurOrFocusOut(event){instance.props.trigger.indexOf("focusin")<0&&event.target!==getCurrentTarget()||instance.props.interactive&&event.relatedTarget&&popper.contains(event.relatedTarget)||scheduleHide(event)}function isEventListenerStopped(event){return!!currentInput.isTouch&&getIsCustomTouchBehavior()!==event.type.indexOf("touch")>=0}function createPopperInstance(){destroyPopperInstance();var _instance$props2=instance.props,popperOptions=_instance$props2.popperOptions,placement=_instance$props2.placement,offset=_instance$props2.offset,getReferenceClientRect=_instance$props2.getReferenceClientRect,moveTransition=_instance$props2.moveTransition,arrow=getIsDefaultRenderFn()?getChildren(popper).arrow:null,computedReference=getReferenceClientRect?{getBoundingClientRect:getReferenceClientRect,contextElement:getReferenceClientRect.contextElement||getCurrentTarget()}:reference,tippyModifier={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function fn(_ref2){var state=_ref2.state;if(getIsDefaultRenderFn()){var box=getDefaultTemplateChildren().box;["placement","reference-hidden","escaped"].forEach((function(attr){"placement"===attr?box.setAttribute("data-placement",state.placement):state.attributes.popper["data-popper-"+attr]?box.setAttribute("data-"+attr,""):box.removeAttribute("data-"+attr)})),state.attributes.popper={}}}},modifiers=[{name:"offset",options:{offset:offset}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!moveTransition}},tippyModifier];getIsDefaultRenderFn()&&arrow&&modifiers.push({name:"arrow",options:{element:arrow,padding:3}}),modifiers.push.apply(modifiers,(null==popperOptions?void 0:popperOptions.modifiers)||[]),instance.popperInstance=Object(lib_popper.a)(computedReference,popper,Object.assign({},popperOptions,{placement:placement,onFirstUpdate:onFirstUpdate,modifiers:modifiers}))}function destroyPopperInstance(){instance.popperInstance&&(instance.popperInstance.destroy(),instance.popperInstance=null)}function getNestedPopperTree(){return arrayFrom(popper.querySelectorAll("[data-tippy-root]"))}function scheduleShow(event){instance.clearDelayTimeouts(),event&&invokeHook("onTrigger",[instance,event]),addDocumentPress();var delay=getDelay(!0),_getNormalizedTouchSe=getNormalizedTouchSettings(),touchValue=_getNormalizedTouchSe[0],touchDelay=_getNormalizedTouchSe[1];currentInput.isTouch&&"hold"===touchValue&&touchDelay&&(delay=touchDelay),delay?showTimeout=setTimeout((function(){instance.show()}),delay):instance.show()}function scheduleHide(event){if(instance.clearDelayTimeouts(),invokeHook("onUntrigger",[instance,event]),instance.state.isVisible){if(!(instance.props.trigger.indexOf("mouseenter")>=0&&instance.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(event.type)>=0&&isVisibleFromClick)){var delay=getDelay(!1);delay?hideTimeout=setTimeout((function(){instance.state.isVisible&&instance.hide()}),delay):scheduleHideAnimationFrame=requestAnimationFrame((function(){instance.hide()}))}}else removeDocumentPress()}}function tippy(targets,optionalProps){void 0===optionalProps&&(optionalProps={});var plugins=defaultProps.plugins.concat(optionalProps.plugins||[]);(function bindGlobalEventListeners(){document.addEventListener("touchstart",onDocumentTouchStart,TOUCH_OPTIONS),window.addEventListener("blur",onWindowBlur)})();var passedProps=Object.assign({},optionalProps,{plugins:plugins}),instances=getArrayOfElements(targets).reduce((function(acc,reference){var instance=reference&&createTippy(reference,passedProps);return instance&&acc.push(instance),acc}),[]);return isElement(targets)?instances[0]:instances}tippy.defaultProps=defaultProps,tippy.setDefaultProps=function setDefaultProps(partialProps){Object.keys(partialProps).forEach((function(key){defaultProps[key]=partialProps[key]}))},tippy.currentInput=currentInput;Object.assign({},applyStyles.a,{effect:function effect(_ref){var state=_ref.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow)}});tippy.setDefaultProps({render:render});var tippy_esm=tippy;class tiptap_extension_bubble_menu_esm_BubbleMenuView{constructor({editor:editor,element:element,view:view,tippyOptions:tippyOptions={},shouldShow:shouldShow}){this.preventHide=!1,this.shouldShow=({view:view,state:state,from:from,to:to})=>{const{doc:doc,selection:selection}=state,{empty:empty}=selection,isEmptyTextBlock=!doc.textBetween(from,to).length&&Object(tiptap_core_esm.Q)(state.selection);return!(!view.hasFocus()||empty||isEmptyTextBlock)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout((()=>this.update(this.editor.view)))},this.blurHandler=({event:event})=>{var _a;this.preventHide?this.preventHide=!1:(null==event?void 0:event.relatedTarget)&&(null===(_a=this.element.parentNode)||void 0===_a?void 0:_a.contains(event.relatedTarget))||this.hide()},this.editor=editor,this.element=element,this.view=view,shouldShow&&(this.shouldShow=shouldShow),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=tippyOptions,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:editorElement}=this.editor.options,editorIsAttached=!!editorElement.parentElement;!this.tippy&&editorIsAttached&&(this.tippy=tippy_esm(editorElement,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",(event=>{this.blurHandler({event:event})})))}update(view,oldState){var _a,_b;const{state:state,composing:composing}=view,{doc:doc,selection:selection}=state,isSame=oldState&&oldState.doc.eq(doc)&&oldState.selection.eq(selection);if(composing||isSame)return;this.createTooltip();const{ranges:ranges}=selection,from=Math.min(...ranges.map((range=>range.$from.pos))),to=Math.max(...ranges.map((range=>range.$to.pos)));(null===(_a=this.shouldShow)||void 0===_a?void 0:_a.call(this,{editor:this.editor,view:view,state:state,oldState:oldState,from:from,to:to}))?(null===(_b=this.tippy)||void 0===_b||_b.setProps({getReferenceClientRect:()=>{if(Object(tiptap_core_esm.P)(state.selection)){const node=view.nodeDOM(from);if(node)return node.getBoundingClientRect()}return Object(tiptap_core_esm.W)(view,from,to)}}),this.show()):this.hide()}show(){var _a;null===(_a=this.tippy)||void 0===_a||_a.show()}hide(){var _a;null===(_a=this.tippy)||void 0===_a||_a.hide()}destroy(){var _a;null===(_a=this.tippy)||void 0===_a||_a.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const BubbleMenuPlugin=options=>new index_es.d({key:"string"==typeof options.pluginKey?new index_es.e(options.pluginKey):options.pluginKey,view:view=>new tiptap_extension_bubble_menu_esm_BubbleMenuView({view:view,...options})});tiptap_core_esm.c.create({name:"bubbleMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"bubbleMenu",shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[BubbleMenuPlugin({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});class tiptap_extension_floating_menu_esm_FloatingMenuView{constructor({editor:editor,element:element,view:view,tippyOptions:tippyOptions={},shouldShow:shouldShow}){this.preventHide=!1,this.shouldShow=({view:view,state:state})=>{const{selection:selection}=state,{$anchor:$anchor,empty:empty}=selection,isRootDepth=1===$anchor.depth,isEmptyTextBlock=$anchor.parent.isTextblock&&!$anchor.parent.type.spec.code&&!$anchor.parent.textContent;return!!(view.hasFocus()&&empty&&isRootDepth&&isEmptyTextBlock)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout((()=>this.update(this.editor.view)))},this.blurHandler=({event:event})=>{var _a;this.preventHide?this.preventHide=!1:(null==event?void 0:event.relatedTarget)&&(null===(_a=this.element.parentNode)||void 0===_a?void 0:_a.contains(event.relatedTarget))||this.hide()},this.editor=editor,this.element=element,this.view=view,shouldShow&&(this.shouldShow=shouldShow),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=tippyOptions,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:editorElement}=this.editor.options,editorIsAttached=!!editorElement.parentElement;!this.tippy&&editorIsAttached&&(this.tippy=tippy_esm(editorElement,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",(event=>{this.blurHandler({event:event})})))}update(view,oldState){var _a,_b;const{state:state}=view,{doc:doc,selection:selection}=state,{from:from,to:to}=selection;if(oldState&&oldState.doc.eq(doc)&&oldState.selection.eq(selection))return;this.createTooltip();(null===(_a=this.shouldShow)||void 0===_a?void 0:_a.call(this,{editor:this.editor,view:view,state:state,oldState:oldState}))?(null===(_b=this.tippy)||void 0===_b||_b.setProps({getReferenceClientRect:()=>Object(tiptap_core_esm.W)(view,from,to)}),this.show()):this.hide()}show(){var _a;null===(_a=this.tippy)||void 0===_a||_a.show()}hide(){var _a;null===(_a=this.tippy)||void 0===_a||_a.hide()}destroy(){var _a;null===(_a=this.tippy)||void 0===_a||_a.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const FloatingMenuPlugin=options=>new index_es.d({key:"string"==typeof options.pluginKey?new index_es.e(options.pluginKey):options.pluginKey,view:view=>new tiptap_extension_floating_menu_esm_FloatingMenuView({view:view,...options})});tiptap_core_esm.c.create({name:"floatingMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[FloatingMenuPlugin({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});var vue_esm=__webpack_require__(7);const tiptap_vue_2_esm_BubbleMenu={name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},watch:{editor:{immediate:!0,handler(editor){editor&&this.$nextTick((()=>{editor.registerPlugin(BubbleMenuPlugin({pluginKey:this.pluginKey,editor:editor,element:this.$el,tippyOptions:this.tippyOptions,shouldShow:this.shouldShow}))}))}}},render(createElement){return createElement("div",{style:{visibility:"hidden"}},this.$slots.default)},beforeDestroy(){this.editor.unregisterPlugin(this.pluginKey)}};class tiptap_vue_2_esm_Editor extends tiptap_core_esm.b{constructor(){super(...arguments),this.contentComponent=null}}const EditorContent={name:"EditorContent",props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler(editor){editor&&editor.options.element&&this.$nextTick((()=>{const element=this.$el;element&&editor.options.element.firstChild&&(element.append(...editor.options.element.childNodes),editor.contentComponent=this,editor.setOptions({element:element}),editor.createNodeViews())}))}}},render:createElement=>createElement("div"),beforeDestroy(){const{editor:editor}=this;if(!editor)return;if(editor.isDestroyed||editor.view.setProps({nodeViews:{}}),editor.contentComponent=null,!editor.options.element.firstChild)return;const newElement=document.createElement("div");newElement.append(...editor.options.element.childNodes),editor.setOptions({element:newElement})}},tiptap_vue_2_esm_FloatingMenu={name:"FloatingMenu",props:{pluginKey:{type:[String,Object],default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},watch:{editor:{immediate:!0,handler(editor){editor&&this.$nextTick((()=>{editor.registerPlugin(FloatingMenuPlugin({pluginKey:this.pluginKey,editor:editor,element:this.$el,tippyOptions:this.tippyOptions,shouldShow:this.shouldShow}))}))}}},render(createElement){return createElement("div",{style:{visibility:"hidden"}},this.$slots.default)},beforeDestroy(){this.editor.unregisterPlugin(this.pluginKey)}};class tiptap_vue_2_esm_VueRenderer{constructor(component,props){const Component=vue_esm.default.extend(component);this.ref=new Component(props).$mount()}get element(){return this.ref.$el}updateProps(props={}){if(!this.ref.$props)return;const originalSilent=vue_esm.default.config.silent;vue_esm.default.config.silent=!0,Object.entries(props).forEach((([key,value])=>{this.ref.$props[key]=value})),vue_esm.default.config.silent=originalSilent}destroy(){this.ref.$destroy()}}const nodeViewProps={editor:{type:Object,required:!0},node:{type:Object,required:!0},decorations:{type:Object,required:!0},selected:{type:Boolean,required:!0},extension:{type:Object,required:!0},getPos:{type:Function,required:!0},updateAttributes:{type:Function,required:!0},deleteNode:{type:Function,required:!0}};class tiptap_vue_2_esm_VueNodeView extends tiptap_core_esm.g{mount(){const props={editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(attributes={})=>this.updateAttributes(attributes),deleteNode:()=>this.deleteNode()},onDragStart=this.onDragStart.bind(this);this.decorationClasses=vue_esm.default.observable({value:this.getDecorationClasses()});const Component=vue_esm.default.extend(this.component).extend({props:Object.keys(props),provide:()=>({onDragStart:onDragStart,decorationClasses:this.decorationClasses})});this.renderer=new tiptap_vue_2_esm_VueRenderer(Component,{parent:this.editor.contentComponent,propsData:props})}get dom(){if(!this.renderer.element.hasAttribute("data-node-view-wrapper"))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){if(this.node.isLeaf)return null;return this.dom.querySelector("[data-node-view-content]")||this.dom}update(node,decorations){const updateProps=props=>{this.decorationClasses.value=this.getDecorationClasses(),this.renderer.updateProps(props)};if("function"==typeof this.options.update){const oldNode=this.node,oldDecorations=this.decorations;return this.node=node,this.decorations=decorations,this.options.update({oldNode:oldNode,oldDecorations:oldDecorations,newNode:node,newDecorations:decorations,updateProps:()=>updateProps({node:node,decorations:decorations})})}return node.type===this.node.type&&(node===this.node&&this.decorations===decorations||(this.node=node,this.decorations=decorations,updateProps({node:node,decorations:decorations})),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}getDecorationClasses(){return this.decorations.map((item=>item.type.attrs.class)).flat().join(" ")}destroy(){this.renderer.destroy()}}function VueNodeViewRenderer(component,options){return props=>props.editor.contentComponent?new tiptap_vue_2_esm_VueNodeView(component,props,options):{}}const NodeViewWrapper={props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(createElement){return createElement(this.as,{class:this.decorationClasses.value,style:{whiteSpace:"normal"},attrs:{"data-node-view-wrapper":""},on:{dragstart:this.onDragStart}},this.$slots.default)}},NodeViewContent={props:{as:{type:String,default:"div"}},render(createElement){return createElement(this.as,{style:{whiteSpace:"pre-wrap"},attrs:{"data-node-view-content":""}})}}},2686:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AllSelection})),__webpack_require__.d(__webpack_exports__,"b",(function(){return EditorState})),__webpack_require__.d(__webpack_exports__,"c",(function(){return NodeSelection})),__webpack_require__.d(__webpack_exports__,"d",(function(){return Plugin})),__webpack_require__.d(__webpack_exports__,"e",(function(){return PluginKey})),__webpack_require__.d(__webpack_exports__,"f",(function(){return Selection})),__webpack_require__.d(__webpack_exports__,"g",(function(){return TextSelection}));var prosemirror_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3057),prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2892),classesById=Object.create(null),Selection=function Selection($anchor,$head,ranges){this.ranges=ranges||[new SelectionRange($anchor.min($head),$anchor.max($head))],this.$anchor=$anchor,this.$head=$head},prototypeAccessors={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};prototypeAccessors.anchor.get=function(){return this.$anchor.pos},prototypeAccessors.head.get=function(){return this.$head.pos},prototypeAccessors.from.get=function(){return this.$from.pos},prototypeAccessors.to.get=function(){return this.$to.pos},prototypeAccessors.$from.get=function(){return this.ranges[0].$from},prototypeAccessors.$to.get=function(){return this.ranges[0].$to},prototypeAccessors.empty.get=function(){for(var ranges=this.ranges,i=0;i<ranges.length;i++)if(ranges[i].$from.pos!=ranges[i].$to.pos)return!1;return!0},Selection.prototype.content=function content(){return this.$from.node(0).slice(this.from,this.to,!0)},Selection.prototype.replace=function replace(tr,content){void 0===content&&(content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty);for(var lastNode=content.content.lastChild,lastParent=null,i=0;i<content.openEnd;i++)lastParent=lastNode,lastNode=lastNode.lastChild;for(var mapFrom=tr.steps.length,ranges=this.ranges,i$1=0;i$1<ranges.length;i$1++){var ref=ranges[i$1],$from=ref.$from,$to=ref.$to,mapping=tr.mapping.slice(mapFrom);tr.replaceRange(mapping.map($from.pos),mapping.map($to.pos),i$1?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty:content),0==i$1&&selectionToInsertionEnd(tr,mapFrom,(lastNode?lastNode.isInline:lastParent&&lastParent.isTextblock)?-1:1)}},Selection.prototype.replaceWith=function replaceWith(tr,node){for(var mapFrom=tr.steps.length,ranges=this.ranges,i=0;i<ranges.length;i++){var ref=ranges[i],$from=ref.$from,$to=ref.$to,mapping=tr.mapping.slice(mapFrom),from=mapping.map($from.pos),to=mapping.map($to.pos);i?tr.deleteRange(from,to):(tr.replaceRangeWith(from,to,node),selectionToInsertionEnd(tr,mapFrom,node.isInline?-1:1))}},Selection.findFrom=function findFrom($pos,dir,textOnly){var inner=$pos.parent.inlineContent?new TextSelection($pos):findSelectionIn($pos.node(0),$pos.parent,$pos.pos,$pos.index(),dir,textOnly);if(inner)return inner;for(var depth=$pos.depth-1;depth>=0;depth--){var found=dir<0?findSelectionIn($pos.node(0),$pos.node(depth),$pos.before(depth+1),$pos.index(depth),dir,textOnly):findSelectionIn($pos.node(0),$pos.node(depth),$pos.after(depth+1),$pos.index(depth)+1,dir,textOnly);if(found)return found}},Selection.near=function near($pos,bias){return void 0===bias&&(bias=1),this.findFrom($pos,bias)||this.findFrom($pos,-bias)||new AllSelection($pos.node(0))},Selection.atStart=function atStart(doc){return findSelectionIn(doc,doc,0,0,1)||new AllSelection(doc)},Selection.atEnd=function atEnd(doc){return findSelectionIn(doc,doc,doc.content.size,doc.childCount,-1)||new AllSelection(doc)},Selection.fromJSON=function fromJSON(doc,json){if(!json||!json.type)throw new RangeError("Invalid input for Selection.fromJSON");var cls=classesById[json.type];if(!cls)throw new RangeError("No selection type "+json.type+" defined");return cls.fromJSON(doc,json)},Selection.jsonID=function jsonID(id,selectionClass){if(id in classesById)throw new RangeError("Duplicate use of selection JSON ID "+id);return classesById[id]=selectionClass,selectionClass.prototype.jsonID=id,selectionClass},Selection.prototype.getBookmark=function getBookmark(){return TextSelection.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Selection.prototype,prototypeAccessors),Selection.prototype.visible=!0;var SelectionRange=function SelectionRange($from,$to){this.$from=$from,this.$to=$to},TextSelection=function(Selection){function TextSelection($anchor,$head){void 0===$head&&($head=$anchor),Selection.call(this,$anchor,$head)}Selection&&(TextSelection.__proto__=Selection),TextSelection.prototype=Object.create(Selection&&Selection.prototype),TextSelection.prototype.constructor=TextSelection;var prototypeAccessors$1={$cursor:{configurable:!0}};return prototypeAccessors$1.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},TextSelection.prototype.map=function map(doc,mapping){var $head=doc.resolve(mapping.map(this.head));if(!$head.parent.inlineContent)return Selection.near($head);var $anchor=doc.resolve(mapping.map(this.anchor));return new TextSelection($anchor.parent.inlineContent?$anchor:$head,$head)},TextSelection.prototype.replace=function replace(tr,content){if(void 0===content&&(content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty),Selection.prototype.replace.call(this,tr,content),content==prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty){var marks=this.$from.marksAcross(this.$to);marks&&tr.ensureMarks(marks)}},TextSelection.prototype.eq=function eq(other){return other instanceof TextSelection&&other.anchor==this.anchor&&other.head==this.head},TextSelection.prototype.getBookmark=function getBookmark(){return new TextBookmark(this.anchor,this.head)},TextSelection.prototype.toJSON=function toJSON(){return{type:"text",anchor:this.anchor,head:this.head}},TextSelection.fromJSON=function fromJSON(doc,json){if("number"!=typeof json.anchor||"number"!=typeof json.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new TextSelection(doc.resolve(json.anchor),doc.resolve(json.head))},TextSelection.create=function create(doc,anchor,head){void 0===head&&(head=anchor);var $anchor=doc.resolve(anchor);return new this($anchor,head==anchor?$anchor:doc.resolve(head))},TextSelection.between=function between($anchor,$head,bias){var dPos=$anchor.pos-$head.pos;if(bias&&!dPos||(bias=dPos>=0?1:-1),!$head.parent.inlineContent){var found=Selection.findFrom($head,bias,!0)||Selection.findFrom($head,-bias,!0);if(!found)return Selection.near($head,bias);$head=found.$head}return $anchor.parent.inlineContent||(0==dPos||($anchor=(Selection.findFrom($anchor,-bias,!0)||Selection.findFrom($anchor,bias,!0)).$anchor).pos<$head.pos!=dPos<0)&&($anchor=$head),new TextSelection($anchor,$head)},Object.defineProperties(TextSelection.prototype,prototypeAccessors$1),TextSelection}(Selection);Selection.jsonID("text",TextSelection);var TextBookmark=function TextBookmark(anchor,head){this.anchor=anchor,this.head=head};TextBookmark.prototype.map=function map(mapping){return new TextBookmark(mapping.map(this.anchor),mapping.map(this.head))},TextBookmark.prototype.resolve=function resolve(doc){return TextSelection.between(doc.resolve(this.anchor),doc.resolve(this.head))};var NodeSelection=function(Selection){function NodeSelection($pos){var node=$pos.nodeAfter,$end=$pos.node(0).resolve($pos.pos+node.nodeSize);Selection.call(this,$pos,$end),this.node=node}return Selection&&(NodeSelection.__proto__=Selection),NodeSelection.prototype=Object.create(Selection&&Selection.prototype),NodeSelection.prototype.constructor=NodeSelection,NodeSelection.prototype.map=function map(doc,mapping){var ref=mapping.mapResult(this.anchor),deleted=ref.deleted,pos=ref.pos,$pos=doc.resolve(pos);return deleted?Selection.near($pos):new NodeSelection($pos)},NodeSelection.prototype.content=function content(){return new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(this.node),0,0)},NodeSelection.prototype.eq=function eq(other){return other instanceof NodeSelection&&other.anchor==this.anchor},NodeSelection.prototype.toJSON=function toJSON(){return{type:"node",anchor:this.anchor}},NodeSelection.prototype.getBookmark=function getBookmark(){return new NodeBookmark(this.anchor)},NodeSelection.fromJSON=function fromJSON(doc,json){if("number"!=typeof json.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new NodeSelection(doc.resolve(json.anchor))},NodeSelection.create=function create(doc,from){return new this(doc.resolve(from))},NodeSelection.isSelectable=function isSelectable(node){return!node.isText&&!1!==node.type.spec.selectable},NodeSelection}(Selection);NodeSelection.prototype.visible=!1,Selection.jsonID("node",NodeSelection);var NodeBookmark=function NodeBookmark(anchor){this.anchor=anchor};NodeBookmark.prototype.map=function map(mapping){var ref=mapping.mapResult(this.anchor),deleted=ref.deleted,pos=ref.pos;return deleted?new TextBookmark(pos,pos):new NodeBookmark(pos)},NodeBookmark.prototype.resolve=function resolve(doc){var $pos=doc.resolve(this.anchor),node=$pos.nodeAfter;return node&&NodeSelection.isSelectable(node)?new NodeSelection($pos):Selection.near($pos)};var AllSelection=function(Selection){function AllSelection(doc){Selection.call(this,doc.resolve(0),doc.resolve(doc.content.size))}return Selection&&(AllSelection.__proto__=Selection),AllSelection.prototype=Object.create(Selection&&Selection.prototype),AllSelection.prototype.constructor=AllSelection,AllSelection.prototype.replace=function replace(tr,content){if(void 0===content&&(content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty),content==prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty){tr.delete(0,tr.doc.content.size);var sel=Selection.atStart(tr.doc);sel.eq(tr.selection)||tr.setSelection(sel)}else Selection.prototype.replace.call(this,tr,content)},AllSelection.prototype.toJSON=function toJSON(){return{type:"all"}},AllSelection.fromJSON=function fromJSON(doc){return new AllSelection(doc)},AllSelection.prototype.map=function map(doc){return new AllSelection(doc)},AllSelection.prototype.eq=function eq(other){return other instanceof AllSelection},AllSelection.prototype.getBookmark=function getBookmark(){return AllBookmark},AllSelection}(Selection);Selection.jsonID("all",AllSelection);var AllBookmark={map:function map(){return this},resolve:function resolve(doc){return new AllSelection(doc)}};function findSelectionIn(doc,node,pos,index,dir,text){if(node.inlineContent)return TextSelection.create(doc,pos);for(var i=index-(dir>0?0:1);dir>0?i<node.childCount:i>=0;i+=dir){var child=node.child(i);if(child.isAtom){if(!text&&NodeSelection.isSelectable(child))return NodeSelection.create(doc,pos-(dir<0?child.nodeSize:0))}else{var inner=findSelectionIn(doc,child,pos+dir,dir<0?child.childCount:0,dir,text);if(inner)return inner}pos+=child.nodeSize*dir}}function selectionToInsertionEnd(tr,startLen,bias){var last=tr.steps.length-1;if(!(last<startLen)){var end,step=tr.steps[last];if(step instanceof prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.c||step instanceof prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.b)tr.mapping.maps[last].forEach((function(_from,_to,_newFrom,newTo){null==end&&(end=newTo)})),tr.setSelection(Selection.near(tr.doc.resolve(end),bias))}}var Transaction=function(Transform){function Transaction(state){Transform.call(this,state.doc),this.time=Date.now(),this.curSelection=state.selection,this.curSelectionFor=0,this.storedMarks=state.storedMarks,this.updated=0,this.meta=Object.create(null)}Transform&&(Transaction.__proto__=Transform),Transaction.prototype=Object.create(Transform&&Transform.prototype),Transaction.prototype.constructor=Transaction;var prototypeAccessors={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return prototypeAccessors.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},Transaction.prototype.setSelection=function setSelection(selection){if(selection.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=selection,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},prototypeAccessors.selectionSet.get=function(){return(1&this.updated)>0},Transaction.prototype.setStoredMarks=function setStoredMarks(marks){return this.storedMarks=marks,this.updated|=2,this},Transaction.prototype.ensureMarks=function ensureMarks(marks){return prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.d.sameSet(this.storedMarks||this.selection.$from.marks(),marks)||this.setStoredMarks(marks),this},Transaction.prototype.addStoredMark=function addStoredMark(mark){return this.ensureMarks(mark.addToSet(this.storedMarks||this.selection.$head.marks()))},Transaction.prototype.removeStoredMark=function removeStoredMark(mark){return this.ensureMarks(mark.removeFromSet(this.storedMarks||this.selection.$head.marks()))},prototypeAccessors.storedMarksSet.get=function(){return(2&this.updated)>0},Transaction.prototype.addStep=function addStep(step,doc){Transform.prototype.addStep.call(this,step,doc),this.updated=-3&this.updated,this.storedMarks=null},Transaction.prototype.setTime=function setTime(time){return this.time=time,this},Transaction.prototype.replaceSelection=function replaceSelection(slice){return this.selection.replace(this,slice),this},Transaction.prototype.replaceSelectionWith=function replaceSelectionWith(node,inheritMarks){var selection=this.selection;return!1!==inheritMarks&&(node=node.mark(this.storedMarks||(selection.empty?selection.$from.marks():selection.$from.marksAcross(selection.$to)||prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.d.none))),selection.replaceWith(this,node),this},Transaction.prototype.deleteSelection=function deleteSelection(){return this.selection.replace(this),this},Transaction.prototype.insertText=function insertText(text,from,to){void 0===to&&(to=from);var schema=this.doc.type.schema;if(null==from)return text?this.replaceSelectionWith(schema.text(text),!0):this.deleteSelection();if(!text)return this.deleteRange(from,to);var marks=this.storedMarks;if(!marks){var $from=this.doc.resolve(from);marks=to==from?$from.marks():$from.marksAcross(this.doc.resolve(to))}return this.replaceRangeWith(from,to,schema.text(text,marks)),this.selection.empty||this.setSelection(Selection.near(this.selection.$to)),this},Transaction.prototype.setMeta=function setMeta(key,value){return this.meta["string"==typeof key?key:key.key]=value,this},Transaction.prototype.getMeta=function getMeta(key){return this.meta["string"==typeof key?key:key.key]},prototypeAccessors.isGeneric.get=function(){for(var _ in this.meta)return!1;return!0},Transaction.prototype.scrollIntoView=function scrollIntoView(){return this.updated|=4,this},prototypeAccessors.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(Transaction.prototype,prototypeAccessors),Transaction}(prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.d);function bind(f,self){return self&&f?f.bind(self):f}var FieldDesc=function FieldDesc(name,desc,self){this.name=name,this.init=bind(desc.init,self),this.apply=bind(desc.apply,self)},baseFields=[new FieldDesc("doc",{init:function init(config){return config.doc||config.schema.topNodeType.createAndFill()},apply:function apply(tr){return tr.doc}}),new FieldDesc("selection",{init:function init(config,instance){return config.selection||Selection.atStart(instance.doc)},apply:function apply(tr){return tr.selection}}),new FieldDesc("storedMarks",{init:function init(config){return config.storedMarks||null},apply:function apply(tr,_marks,_old,state){return state.selection.$cursor?tr.storedMarks:null}}),new FieldDesc("scrollToSelection",{init:function init(){return 0},apply:function apply(tr,prev){return tr.scrolledIntoView?prev+1:prev}})],Configuration=function Configuration(schema,plugins){var this$1=this;this.schema=schema,this.fields=baseFields.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),plugins&&plugins.forEach((function(plugin){if(this$1.pluginsByKey[plugin.key])throw new RangeError("Adding different instances of a keyed plugin ("+plugin.key+")");this$1.plugins.push(plugin),this$1.pluginsByKey[plugin.key]=plugin,plugin.spec.state&&this$1.fields.push(new FieldDesc(plugin.key,plugin.spec.state,plugin))}))},EditorState=function EditorState(config){this.config=config},prototypeAccessors$1={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};prototypeAccessors$1.schema.get=function(){return this.config.schema},prototypeAccessors$1.plugins.get=function(){return this.config.plugins},EditorState.prototype.apply=function apply(tr){return this.applyTransaction(tr).state},EditorState.prototype.filterTransaction=function filterTransaction(tr,ignore){void 0===ignore&&(ignore=-1);for(var i=0;i<this.config.plugins.length;i++)if(i!=ignore){var plugin=this.config.plugins[i];if(plugin.spec.filterTransaction&&!plugin.spec.filterTransaction.call(plugin,tr,this))return!1}return!0},EditorState.prototype.applyTransaction=function applyTransaction(rootTr){if(!this.filterTransaction(rootTr))return{state:this,transactions:[]};for(var trs=[rootTr],newState=this.applyInner(rootTr),seen=null;;){for(var haveNew=!1,i=0;i<this.config.plugins.length;i++){var plugin=this.config.plugins[i];if(plugin.spec.appendTransaction){var n=seen?seen[i].n:0,oldState=seen?seen[i].state:this,tr=n<trs.length&&plugin.spec.appendTransaction.call(plugin,n?trs.slice(n):trs,oldState,newState);if(tr&&newState.filterTransaction(tr,i)){if(tr.setMeta("appendedTransaction",rootTr),!seen){seen=[];for(var j=0;j<this.config.plugins.length;j++)seen.push(j<i?{state:newState,n:trs.length}:{state:this,n:0})}trs.push(tr),newState=newState.applyInner(tr),haveNew=!0}seen&&(seen[i]={state:newState,n:trs.length})}}if(!haveNew)return{state:newState,transactions:trs}}},EditorState.prototype.applyInner=function applyInner(tr){if(!tr.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var newInstance=new EditorState(this.config),fields=this.config.fields,i=0;i<fields.length;i++){var field=fields[i];newInstance[field.name]=field.apply(tr,this[field.name],this,newInstance)}for(var i$1=0;i$1<applyListeners.length;i$1++)applyListeners[i$1](this,tr,newInstance);return newInstance},prototypeAccessors$1.tr.get=function(){return new Transaction(this)},EditorState.create=function create(config){for(var $config=new Configuration(config.doc?config.doc.type.schema:config.schema,config.plugins),instance=new EditorState($config),i=0;i<$config.fields.length;i++)instance[$config.fields[i].name]=$config.fields[i].init(config,instance);return instance},EditorState.prototype.reconfigure=function reconfigure(config){for(var $config=new Configuration(this.schema,config.plugins),fields=$config.fields,instance=new EditorState($config),i=0;i<fields.length;i++){var name=fields[i].name;instance[name]=this.hasOwnProperty(name)?this[name]:fields[i].init(config,instance)}return instance},EditorState.prototype.toJSON=function toJSON(pluginFields){var result={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(result.storedMarks=this.storedMarks.map((function(m){return m.toJSON()}))),pluginFields&&"object"==typeof pluginFields)for(var prop in pluginFields){if("doc"==prop||"selection"==prop)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var plugin=pluginFields[prop],state=plugin.spec.state;state&&state.toJSON&&(result[prop]=state.toJSON.call(plugin,this[plugin.key]))}return result},EditorState.fromJSON=function fromJSON(config,json,pluginFields){if(!json)throw new RangeError("Invalid input for EditorState.fromJSON");if(!config.schema)throw new RangeError("Required config field 'schema' missing");var $config=new Configuration(config.schema,config.plugins),instance=new EditorState($config);return $config.fields.forEach((function(field){if("doc"==field.name)instance.doc=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.f.fromJSON(config.schema,json.doc);else if("selection"==field.name)instance.selection=Selection.fromJSON(instance.doc,json.selection);else if("storedMarks"==field.name)json.storedMarks&&(instance.storedMarks=json.storedMarks.map(config.schema.markFromJSON));else{if(pluginFields)for(var prop in pluginFields){var plugin=pluginFields[prop],state=plugin.spec.state;if(plugin.key==field.name&&state&&state.fromJSON&&Object.prototype.hasOwnProperty.call(json,prop))return void(instance[field.name]=state.fromJSON.call(plugin,config,json[prop],instance))}instance[field.name]=field.init(config,instance)}})),instance},EditorState.addApplyListener=function addApplyListener(f){applyListeners.push(f)},EditorState.removeApplyListener=function removeApplyListener(f){var found=applyListeners.indexOf(f);found>-1&&applyListeners.splice(found,1)},Object.defineProperties(EditorState.prototype,prototypeAccessors$1);var applyListeners=[];function bindProps(obj,self,target){for(var prop in obj){var val=obj[prop];val instanceof Function?val=val.bind(self):"handleDOMEvents"==prop&&(val=bindProps(val,self,{})),target[prop]=val}return target}var Plugin=function Plugin(spec){this.props={},spec.props&&bindProps(spec.props,this,this.props),this.spec=spec,this.key=spec.key?spec.key.key:createKey("plugin")};Plugin.prototype.getState=function getState(state){return state[this.key]};var keys=Object.create(null);function createKey(name){return name in keys?name+"$"+ ++keys[name]:(keys[name]=0,name+"$")}var PluginKey=function PluginKey(name){void 0===name&&(name="key"),this.key=createKey(name)};PluginKey.prototype.get=function get(state){return state.config.pluginsByKey[this.key]},PluginKey.prototype.getState=function getState(state){return state[this.key]}},2892:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Mapping})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ReplaceAroundStep})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ReplaceStep})),__webpack_require__.d(__webpack_exports__,"d",(function(){return Transform})),__webpack_require__.d(__webpack_exports__,"e",(function(){return canJoin})),__webpack_require__.d(__webpack_exports__,"f",(function(){return canSplit})),__webpack_require__.d(__webpack_exports__,"g",(function(){return dropPoint})),__webpack_require__.d(__webpack_exports__,"h",(function(){return findWrapping})),__webpack_require__.d(__webpack_exports__,"i",(function(){return joinPoint})),__webpack_require__.d(__webpack_exports__,"j",(function(){return liftTarget}));var prosemirror_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3057),factor16=Math.pow(2,16);function recoverIndex(value){return 65535&value}var MapResult=function MapResult(pos,deleted,recover){void 0===deleted&&(deleted=!1),void 0===recover&&(recover=null),this.pos=pos,this.deleted=deleted,this.recover=recover},StepMap=function StepMap(ranges,inverted){void 0===inverted&&(inverted=!1),this.ranges=ranges,this.inverted=inverted};StepMap.prototype.recover=function recover(value){var diff=0,index=recoverIndex(value);if(!this.inverted)for(var i=0;i<index;i++)diff+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*index]+diff+function recoverOffset(value){return(value-(65535&value))/factor16}(value)},StepMap.prototype.mapResult=function mapResult(pos,assoc){return void 0===assoc&&(assoc=1),this._map(pos,assoc,!1)},StepMap.prototype.map=function map(pos,assoc){return void 0===assoc&&(assoc=1),this._map(pos,assoc,!0)},StepMap.prototype._map=function _map(pos,assoc,simple){for(var diff=0,oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,i=0;i<this.ranges.length;i+=3){var start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;var oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex],end=start+oldSize;if(pos<=end){var result=start+diff+((oldSize?pos==start?-1:pos==end?1:assoc:assoc)<0?0:newSize);if(simple)return result;var recover=pos==(assoc<0?start:end)?null:i/3+(pos-start)*factor16;return new MapResult(result,assoc<0?pos!=start:pos!=end,recover)}diff+=newSize-oldSize}return simple?pos+diff:new MapResult(pos+diff)},StepMap.prototype.touches=function touches(pos,recover){for(var diff=0,index=recoverIndex(recover),oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,i=0;i<this.ranges.length;i+=3){var start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;var oldSize=this.ranges[i+oldIndex];if(pos<=start+oldSize&&i==3*index)return!0;diff+=this.ranges[i+newIndex]-oldSize}return!1},StepMap.prototype.forEach=function forEach(f){for(var oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,i=0,diff=0;i<this.ranges.length;i+=3){var start=this.ranges[i],oldStart=start-(this.inverted?diff:0),newStart=start+(this.inverted?0:diff),oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex];f(oldStart,oldStart+oldSize,newStart,newStart+newSize),diff+=newSize-oldSize}},StepMap.prototype.invert=function invert(){return new StepMap(this.ranges,!this.inverted)},StepMap.prototype.toString=function toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},StepMap.offset=function offset(n){return 0==n?StepMap.empty:new StepMap(n<0?[0,-n,0]:[0,0,n])},StepMap.empty=new StepMap([]);var Mapping=function Mapping(maps,mirror,from,to){this.maps=maps||[],this.from=from||0,this.to=null==to?this.maps.length:to,this.mirror=mirror};function TransformError(message){var err=Error.call(this,message);return err.__proto__=TransformError.prototype,err}Mapping.prototype.slice=function slice(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.maps.length),new Mapping(this.maps,this.mirror,from,to)},Mapping.prototype.copy=function copy(){return new Mapping(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},Mapping.prototype.appendMap=function appendMap(map,mirrors){this.to=this.maps.push(map),null!=mirrors&&this.setMirror(this.maps.length-1,mirrors)},Mapping.prototype.appendMapping=function appendMapping(mapping){for(var i=0,startSize=this.maps.length;i<mapping.maps.length;i++){var mirr=mapping.getMirror(i);this.appendMap(mapping.maps[i],null!=mirr&&mirr<i?startSize+mirr:null)}},Mapping.prototype.getMirror=function getMirror(n){if(this.mirror)for(var i=0;i<this.mirror.length;i++)if(this.mirror[i]==n)return this.mirror[i+(i%2?-1:1)]},Mapping.prototype.setMirror=function setMirror(n,m){this.mirror||(this.mirror=[]),this.mirror.push(n,m)},Mapping.prototype.appendMappingInverted=function appendMappingInverted(mapping){for(var i=mapping.maps.length-1,totalSize=this.maps.length+mapping.maps.length;i>=0;i--){var mirr=mapping.getMirror(i);this.appendMap(mapping.maps[i].invert(),null!=mirr&&mirr>i?totalSize-mirr-1:null)}},Mapping.prototype.invert=function invert(){var inverse=new Mapping;return inverse.appendMappingInverted(this),inverse},Mapping.prototype.map=function map(pos,assoc){if(void 0===assoc&&(assoc=1),this.mirror)return this._map(pos,assoc,!0);for(var i=this.from;i<this.to;i++)pos=this.maps[i].map(pos,assoc);return pos},Mapping.prototype.mapResult=function mapResult(pos,assoc){return void 0===assoc&&(assoc=1),this._map(pos,assoc,!1)},Mapping.prototype._map=function _map(pos,assoc,simple){for(var deleted=!1,i=this.from;i<this.to;i++){var result=this.maps[i].mapResult(pos,assoc);if(null!=result.recover){var corr=this.getMirror(i);if(null!=corr&&corr>i&&corr<this.to){i=corr,pos=this.maps[corr].recover(result.recover);continue}}result.deleted&&(deleted=!0),pos=result.pos}return simple?pos:new MapResult(pos,deleted)},TransformError.prototype=Object.create(Error.prototype),TransformError.prototype.constructor=TransformError,TransformError.prototype.name="TransformError";var Transform=function Transform(doc){this.doc=doc,this.steps=[],this.docs=[],this.mapping=new Mapping},prototypeAccessors={before:{configurable:!0},docChanged:{configurable:!0}};function mustOverride(){throw new Error("Override me")}prototypeAccessors.before.get=function(){return this.docs.length?this.docs[0]:this.doc},Transform.prototype.step=function step(object){var result=this.maybeStep(object);if(result.failed)throw new TransformError(result.failed);return this},Transform.prototype.maybeStep=function maybeStep(step){var result=step.apply(this.doc);return result.failed||this.addStep(step,result.doc),result},prototypeAccessors.docChanged.get=function(){return this.steps.length>0},Transform.prototype.addStep=function addStep(step,doc){this.docs.push(this.doc),this.steps.push(step),this.mapping.appendMap(step.getMap()),this.doc=doc},Object.defineProperties(Transform.prototype,prototypeAccessors);var stepsByID=Object.create(null),Step=function Step(){};Step.prototype.apply=function apply(_doc){return mustOverride()},Step.prototype.getMap=function getMap(){return StepMap.empty},Step.prototype.invert=function invert(_doc){return mustOverride()},Step.prototype.map=function map(_mapping){return mustOverride()},Step.prototype.merge=function merge(_other){return null},Step.prototype.toJSON=function toJSON(){return mustOverride()},Step.fromJSON=function fromJSON(schema,json){if(!json||!json.stepType)throw new RangeError("Invalid input for Step.fromJSON");var type=stepsByID[json.stepType];if(!type)throw new RangeError("No step type "+json.stepType+" defined");return type.fromJSON(schema,json)},Step.jsonID=function jsonID(id,stepClass){if(id in stepsByID)throw new RangeError("Duplicate use of step JSON ID "+id);return stepsByID[id]=stepClass,stepClass.prototype.jsonID=id,stepClass};var StepResult=function StepResult(doc,failed){this.doc=doc,this.failed=failed};StepResult.ok=function ok(doc){return new StepResult(doc,null)},StepResult.fail=function fail(message){return new StepResult(null,message)},StepResult.fromReplace=function fromReplace(doc,from,to,slice){try{return StepResult.ok(doc.replace(from,to,slice))}catch(e){if(e instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.h)return StepResult.fail(e.message);throw e}};var ReplaceStep=function(Step){function ReplaceStep(from,to,slice,structure){Step.call(this),this.from=from,this.to=to,this.slice=slice,this.structure=!!structure}return Step&&(ReplaceStep.__proto__=Step),ReplaceStep.prototype=Object.create(Step&&Step.prototype),ReplaceStep.prototype.constructor=ReplaceStep,ReplaceStep.prototype.apply=function apply(doc){return this.structure&&contentBetween(doc,this.from,this.to)?StepResult.fail("Structure replace would overwrite content"):StepResult.fromReplace(doc,this.from,this.to,this.slice)},ReplaceStep.prototype.getMap=function getMap(){return new StepMap([this.from,this.to-this.from,this.slice.size])},ReplaceStep.prototype.invert=function invert(doc){return new ReplaceStep(this.from,this.from+this.slice.size,doc.slice(this.from,this.to))},ReplaceStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted?null:new ReplaceStep(from.pos,Math.max(from.pos,to.pos),this.slice)},ReplaceStep.prototype.merge=function merge(other){if(!(other instanceof ReplaceStep)||other.structure||this.structure)return null;if(this.from+this.slice.size!=other.from||this.slice.openEnd||other.slice.openStart){if(other.to!=this.from||this.slice.openStart||other.slice.openEnd)return null;var slice$1=this.slice.size+other.slice.size==0?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(other.slice.content.append(this.slice.content),other.slice.openStart,this.slice.openEnd);return new ReplaceStep(other.from,this.to,slice$1,this.structure)}var slice=this.slice.size+other.slice.size==0?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(this.slice.content.append(other.slice.content),this.slice.openStart,other.slice.openEnd);return new ReplaceStep(this.from,this.to+(other.to-other.from),slice,this.structure)},ReplaceStep.prototype.toJSON=function toJSON(){var json={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json},ReplaceStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ReplaceStep(json.from,json.to,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.fromJSON(schema,json.slice),!!json.structure)},ReplaceStep}(Step);Step.jsonID("replace",ReplaceStep);var ReplaceAroundStep=function(Step){function ReplaceAroundStep(from,to,gapFrom,gapTo,slice,insert,structure){Step.call(this),this.from=from,this.to=to,this.gapFrom=gapFrom,this.gapTo=gapTo,this.slice=slice,this.insert=insert,this.structure=!!structure}return Step&&(ReplaceAroundStep.__proto__=Step),ReplaceAroundStep.prototype=Object.create(Step&&Step.prototype),ReplaceAroundStep.prototype.constructor=ReplaceAroundStep,ReplaceAroundStep.prototype.apply=function apply(doc){if(this.structure&&(contentBetween(doc,this.from,this.gapFrom)||contentBetween(doc,this.gapTo,this.to)))return StepResult.fail("Structure gap-replace would overwrite content");var gap=doc.slice(this.gapFrom,this.gapTo);if(gap.openStart||gap.openEnd)return StepResult.fail("Gap is not a flat range");var inserted=this.slice.insertAt(this.insert,gap.content);return inserted?StepResult.fromReplace(doc,this.from,this.to,inserted):StepResult.fail("Content does not fit in gap")},ReplaceAroundStep.prototype.getMap=function getMap(){return new StepMap([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},ReplaceAroundStep.prototype.invert=function invert(doc){var gap=this.gapTo-this.gapFrom;return new ReplaceAroundStep(this.from,this.from+this.slice.size+gap,this.from+this.insert,this.from+this.insert+gap,doc.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},ReplaceAroundStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1),gapFrom=mapping.map(this.gapFrom,-1),gapTo=mapping.map(this.gapTo,1);return from.deleted&&to.deleted||gapFrom<from.pos||gapTo>to.pos?null:new ReplaceAroundStep(from.pos,to.pos,gapFrom,gapTo,this.slice,this.insert,this.structure)},ReplaceAroundStep.prototype.toJSON=function toJSON(){var json={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json},ReplaceAroundStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to||"number"!=typeof json.gapFrom||"number"!=typeof json.gapTo||"number"!=typeof json.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ReplaceAroundStep(json.from,json.to,json.gapFrom,json.gapTo,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.fromJSON(schema,json.slice),json.insert,!!json.structure)},ReplaceAroundStep}(Step);function contentBetween(doc,from,to){for(var $from=doc.resolve(from),dist=to-from,depth=$from.depth;dist>0&&depth>0&&$from.indexAfter(depth)==$from.node(depth).childCount;)depth--,dist--;if(dist>0)for(var next=$from.node(depth).maybeChild($from.indexAfter(depth));dist>0;){if(!next||next.isLeaf)return!0;next=next.firstChild,dist--}return!1}function canCut(node,start,end){return(0==start||node.canReplace(start,node.childCount))&&(end==node.childCount||node.canReplace(0,end))}function liftTarget(range){for(var content=range.parent.content.cutByIndex(range.startIndex,range.endIndex),depth=range.depth;;--depth){var node=range.$from.node(depth),index=range.$from.index(depth),endIndex=range.$to.indexAfter(depth);if(depth<range.depth&&node.canReplace(index,endIndex,content))return depth;if(0==depth||node.type.spec.isolating||!canCut(node,index,endIndex))break}}function findWrapping(range,nodeType,attrs,innerRange){void 0===innerRange&&(innerRange=range);var around=function findWrappingOutside(range,type){var parent=range.parent,startIndex=range.startIndex,endIndex=range.endIndex,around=parent.contentMatchAt(startIndex).findWrapping(type);if(!around)return null;var outer=around.length?around[0]:type;return parent.canReplaceWith(startIndex,endIndex,outer)?around:null}(range,nodeType),inner=around&&function findWrappingInside(range,type){var parent=range.parent,startIndex=range.startIndex,endIndex=range.endIndex,inner=parent.child(startIndex),inside=type.contentMatch.findWrapping(inner.type);if(!inside)return null;for(var innerMatch=(inside.length?inside[inside.length-1]:type).contentMatch,i=startIndex;innerMatch&&i<endIndex;i++)innerMatch=innerMatch.matchType(parent.child(i).type);if(!innerMatch||!innerMatch.validEnd)return null;return inside}(innerRange,nodeType);return inner?around.map(withAttrs).concat({type:nodeType,attrs:attrs}).concat(inner.map(withAttrs)):null}function withAttrs(type){return{type:type,attrs:null}}function canSplit(doc,pos,depth,typesAfter){void 0===depth&&(depth=1);var $pos=doc.resolve(pos),base=$pos.depth-depth,innerType=typesAfter&&typesAfter[typesAfter.length-1]||$pos.parent;if(base<0||$pos.parent.type.spec.isolating||!$pos.parent.canReplace($pos.index(),$pos.parent.childCount)||!innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(),$pos.parent.childCount)))return!1;for(var d=$pos.depth-1,i=depth-2;d>base;d--,i--){var node=$pos.node(d),index$1=$pos.index(d);if(node.type.spec.isolating)return!1;var rest=node.content.cutByIndex(index$1,node.childCount),after=typesAfter&&typesAfter[i]||node;if(after!=node&&(rest=rest.replaceChild(0,after.type.create(after.attrs))),!node.canReplace(index$1+1,node.childCount)||!after.type.validContent(rest))return!1}var index=$pos.indexAfter(base),baseType=typesAfter&&typesAfter[0];return $pos.node(base).canReplaceWith(index,index,baseType?baseType.type:$pos.node(base+1).type)}function canJoin(doc,pos){var $pos=doc.resolve(pos),index=$pos.index();return joinable($pos.nodeBefore,$pos.nodeAfter)&&$pos.parent.canReplace(index,index+1)}function joinable(a,b){return a&&b&&!a.isLeaf&&a.canAppend(b)}function joinPoint(doc,pos,dir){void 0===dir&&(dir=-1);for(var $pos=doc.resolve(pos),d=$pos.depth;;d--){var before=void 0,after=void 0,index=$pos.index(d);if(d==$pos.depth?(before=$pos.nodeBefore,after=$pos.nodeAfter):dir>0?(before=$pos.node(d+1),index++,after=$pos.node(d).maybeChild(index)):(before=$pos.node(d).maybeChild(index-1),after=$pos.node(d+1)),before&&!before.isTextblock&&joinable(before,after)&&$pos.node(d).canReplace(index,index+1))return pos;if(0==d)break;pos=dir<0?$pos.before(d):$pos.after(d)}}function dropPoint(doc,pos,slice){var $pos=doc.resolve(pos);if(!slice.content.size)return pos;for(var content=slice.content,i=0;i<slice.openStart;i++)content=content.firstChild.content;for(var pass=1;pass<=(0==slice.openStart&&slice.size?2:1);pass++)for(var d=$pos.depth;d>=0;d--){var bias=d==$pos.depth?0:$pos.pos<=($pos.start(d+1)+$pos.end(d+1))/2?-1:1,insertPos=$pos.index(d)+(bias>0?1:0),parent=$pos.node(d),fits=!1;if(1==pass)fits=parent.canReplace(insertPos,insertPos,content);else{var wrapping=parent.contentMatchAt(insertPos).findWrapping(content.firstChild.type);fits=wrapping&&parent.canReplaceWith(insertPos,insertPos,wrapping[0])}if(fits)return 0==bias?$pos.pos:bias<0?$pos.before(d+1):$pos.after(d+1)}return null}function mapFragment(fragment,f,parent){for(var mapped=[],i=0;i<fragment.childCount;i++){var child=fragment.child(i);child.content.size&&(child=child.copy(mapFragment(child.content,f,child))),child.isInline&&(child=f(child,parent,i)),mapped.push(child)}return prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.fromArray(mapped)}Step.jsonID("replaceAround",ReplaceAroundStep),Transform.prototype.lift=function(range,target){for(var $from=range.$from,$to=range.$to,depth=range.depth,gapStart=$from.before(depth+1),gapEnd=$to.after(depth+1),start=gapStart,end=gapEnd,before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,openStart=0,d=depth,splitting=!1;d>target;d--)splitting||$from.index(d)>0?(splitting=!0,before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from($from.node(d).copy(before)),openStart++):start--;for(var after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,openEnd=0,d$1=depth,splitting$1=!1;d$1>target;d$1--)splitting$1||$to.after(d$1+1)<$to.end(d$1)?(splitting$1=!0,after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from($to.node(d$1).copy(after)),openEnd++):end++;return this.step(new ReplaceAroundStep(start,end,gapStart,gapEnd,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(before.append(after),openStart,openEnd),before.size-openStart,!0))},Transform.prototype.wrap=function(range,wrappers){for(var content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,i=wrappers.length-1;i>=0;i--)content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(wrappers[i].type.create(wrappers[i].attrs,content));var start=range.start,end=range.end;return this.step(new ReplaceAroundStep(start,end,start,end,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(content,0,0),wrappers.length,!0))},Transform.prototype.setBlockType=function(from,to,type,attrs){var this$1=this;if(void 0===to&&(to=from),!type.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var mapFrom=this.steps.length;return this.doc.nodesBetween(from,to,(function(node,pos){if(node.isTextblock&&!node.hasMarkup(type,attrs)&&function canChangeType(doc,pos,type){var $pos=doc.resolve(pos),index=$pos.index();return $pos.parent.canReplaceWith(index,index+1,type)}(this$1.doc,this$1.mapping.slice(mapFrom).map(pos),type)){this$1.clearIncompatible(this$1.mapping.slice(mapFrom).map(pos,1),type);var mapping=this$1.mapping.slice(mapFrom),startM=mapping.map(pos,1),endM=mapping.map(pos+node.nodeSize,1);return this$1.step(new ReplaceAroundStep(startM,endM,startM+1,endM-1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(type.create(attrs,null,node.marks)),0,0),1,!0)),!1}})),this},Transform.prototype.setNodeMarkup=function(pos,type,attrs,marks){var node=this.doc.nodeAt(pos);if(!node)throw new RangeError("No node at given position");type||(type=node.type);var newNode=type.create(attrs,null,marks||node.marks);if(node.isLeaf)return this.replaceWith(pos,pos+node.nodeSize,newNode);if(!type.validContent(node.content))throw new RangeError("Invalid content for node type "+type.name);return this.step(new ReplaceAroundStep(pos,pos+node.nodeSize,pos+1,pos+node.nodeSize-1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(newNode),0,0),1,!0))},Transform.prototype.split=function(pos,depth,typesAfter){void 0===depth&&(depth=1);for(var $pos=this.doc.resolve(pos),before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,d=$pos.depth,e=$pos.depth-depth,i=depth-1;d>e;d--,i--){before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from($pos.node(d).copy(before));var typeAfter=typesAfter&&typesAfter[i];after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(typeAfter?typeAfter.type.create(typeAfter.attrs,after):$pos.node(d).copy(after))}return this.step(new ReplaceStep(pos,pos,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(before.append(after),depth,depth),!0))},Transform.prototype.join=function(pos,depth){void 0===depth&&(depth=1);var step=new ReplaceStep(pos-depth,pos+depth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty,!0);return this.step(step)};var AddMarkStep=function(Step){function AddMarkStep(from,to,mark){Step.call(this),this.from=from,this.to=to,this.mark=mark}return Step&&(AddMarkStep.__proto__=Step),AddMarkStep.prototype=Object.create(Step&&Step.prototype),AddMarkStep.prototype.constructor=AddMarkStep,AddMarkStep.prototype.apply=function apply(doc){var this$1=this,oldSlice=doc.slice(this.from,this.to),$from=doc.resolve(this.from),parent=$from.node($from.sharedDepth(this.to)),slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(mapFragment(oldSlice.content,(function(node,parent){return node.isAtom&&parent.type.allowsMarkType(this$1.mark.type)?node.mark(this$1.mark.addToSet(node.marks)):node}),parent),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)},AddMarkStep.prototype.invert=function invert(){return new RemoveMarkStep(this.from,this.to,this.mark)},AddMarkStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new AddMarkStep(from.pos,to.pos,this.mark)},AddMarkStep.prototype.merge=function merge(other){if(other instanceof AddMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from)return new AddMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark)},AddMarkStep.prototype.toJSON=function toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},AddMarkStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new AddMarkStep(json.from,json.to,schema.markFromJSON(json.mark))},AddMarkStep}(Step);Step.jsonID("addMark",AddMarkStep);var RemoveMarkStep=function(Step){function RemoveMarkStep(from,to,mark){Step.call(this),this.from=from,this.to=to,this.mark=mark}return Step&&(RemoveMarkStep.__proto__=Step),RemoveMarkStep.prototype=Object.create(Step&&Step.prototype),RemoveMarkStep.prototype.constructor=RemoveMarkStep,RemoveMarkStep.prototype.apply=function apply(doc){var this$1=this,oldSlice=doc.slice(this.from,this.to),slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(mapFragment(oldSlice.content,(function(node){return node.mark(this$1.mark.removeFromSet(node.marks))})),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)},RemoveMarkStep.prototype.invert=function invert(){return new AddMarkStep(this.from,this.to,this.mark)},RemoveMarkStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new RemoveMarkStep(from.pos,to.pos,this.mark)},RemoveMarkStep.prototype.merge=function merge(other){if(other instanceof RemoveMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from)return new RemoveMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark)},RemoveMarkStep.prototype.toJSON=function toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},RemoveMarkStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new RemoveMarkStep(json.from,json.to,schema.markFromJSON(json.mark))},RemoveMarkStep}(Step);function fitsTrivially($from,$to,slice){return!slice.openStart&&!slice.openEnd&&$from.start()==$to.start()&&$from.parent.canReplace($from.index(),$to.index(),slice.content)}Step.jsonID("removeMark",RemoveMarkStep),Transform.prototype.addMark=function(from,to,mark){var this$1=this,removed=[],added=[],removing=null,adding=null;return this.doc.nodesBetween(from,to,(function(node,pos,parent){if(node.isInline){var marks=node.marks;if(!mark.isInSet(marks)&&parent.type.allowsMarkType(mark.type)){for(var start=Math.max(pos,from),end=Math.min(pos+node.nodeSize,to),newSet=mark.addToSet(marks),i=0;i<marks.length;i++)marks[i].isInSet(newSet)||(removing&&removing.to==start&&removing.mark.eq(marks[i])?removing.to=end:removed.push(removing=new RemoveMarkStep(start,end,marks[i])));adding&&adding.to==start?adding.to=end:added.push(adding=new AddMarkStep(start,end,mark))}}})),removed.forEach((function(s){return this$1.step(s)})),added.forEach((function(s){return this$1.step(s)})),this},Transform.prototype.removeMark=function(from,to,mark){var this$1=this;void 0===mark&&(mark=null);var matched=[],step=0;return this.doc.nodesBetween(from,to,(function(node,pos){if(node.isInline){step++;var toRemove=null;if(mark instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.e)for(var found,set=node.marks;found=mark.isInSet(set);)(toRemove||(toRemove=[])).push(found),set=found.removeFromSet(set);else mark?mark.isInSet(node.marks)&&(toRemove=[mark]):toRemove=node.marks;if(toRemove&&toRemove.length)for(var end=Math.min(pos+node.nodeSize,to),i=0;i<toRemove.length;i++){for(var style=toRemove[i],found$1=void 0,j=0;j<matched.length;j++){var m=matched[j];m.step==step-1&&style.eq(matched[j].style)&&(found$1=m)}found$1?(found$1.to=end,found$1.step=step):matched.push({style:style,from:Math.max(pos,from),to:end,step:step})}}})),matched.forEach((function(m){return this$1.step(new RemoveMarkStep(m.from,m.to,m.style))})),this},Transform.prototype.clearIncompatible=function(pos,parentType,match){void 0===match&&(match=parentType.contentMatch);for(var node=this.doc.nodeAt(pos),delSteps=[],cur=pos+1,i=0;i<node.childCount;i++){var child=node.child(i),end=cur+child.nodeSize,allowed=match.matchType(child.type,child.attrs);if(allowed){match=allowed;for(var j=0;j<child.marks.length;j++)parentType.allowsMarkType(child.marks[j].type)||this.step(new RemoveMarkStep(cur,end,child.marks[j]))}else delSteps.push(new ReplaceStep(cur,end,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty));cur=end}if(!match.validEnd){var fill=match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,!0);this.replace(cur,cur,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(fill,0,0))}for(var i$1=delSteps.length-1;i$1>=0;i$1--)this.step(delSteps[i$1]);return this},Transform.prototype.replace=function(from,to,slice){void 0===to&&(to=from),void 0===slice&&(slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty);var step=function replaceStep(doc,from,to,slice){if(void 0===to&&(to=from),void 0===slice&&(slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty),from==to&&!slice.size)return null;var $from=doc.resolve(from),$to=doc.resolve(to);return fitsTrivially($from,$to,slice)?new ReplaceStep(from,to,slice):new Fitter($from,$to,slice).fit()}(this.doc,from,to,slice);return step&&this.step(step),this},Transform.prototype.replaceWith=function(from,to,content){return this.replace(from,to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(content),0,0))},Transform.prototype.delete=function(from,to){return this.replace(from,to,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty)},Transform.prototype.insert=function(pos,content){return this.replaceWith(pos,pos,content)};var Fitter=function Fitter($from,$to,slice){this.$to=$to,this.$from=$from,this.unplaced=slice,this.frontier=[];for(var i=0;i<=$from.depth;i++){var node=$from.node(i);this.frontier.push({type:node.type,match:node.contentMatchAt($from.indexAfter(i))})}this.placed=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty;for(var i$1=$from.depth;i$1>0;i$1--)this.placed=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from($from.node(i$1).copy(this.placed))},prototypeAccessors$1={depth:{configurable:!0}};function dropFromFragment(fragment,depth,count){return 0==depth?fragment.cutByIndex(count):fragment.replaceChild(0,fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content,depth-1,count)))}function addToFragment(fragment,depth,content){return 0==depth?fragment.append(content):fragment.replaceChild(fragment.childCount-1,fragment.lastChild.copy(addToFragment(fragment.lastChild.content,depth-1,content)))}function contentAt(fragment,depth){for(var i=0;i<depth;i++)fragment=fragment.firstChild.content;return fragment}function closeNodeStart(node,openStart,openEnd){if(openStart<=0)return node;var frag=node.content;return openStart>1&&(frag=frag.replaceChild(0,closeNodeStart(frag.firstChild,openStart-1,1==frag.childCount?openEnd-1:0))),openStart>0&&(frag=node.type.contentMatch.fillBefore(frag).append(frag),openEnd<=0&&(frag=frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,!0)))),node.copy(frag)}function contentAfterFits($to,depth,type,match,open){var node=$to.node(depth),index=open?$to.indexAfter(depth):$to.index(depth);if(index==node.childCount&&!type.compatibleContent(node.type))return null;var fit=match.fillBefore(node.content,!0,index);return fit&&!function invalidMarks(type,fragment,start){for(var i=start;i<fragment.childCount;i++)if(!type.allowsMarks(fragment.child(i).marks))return!0;return!1}(type,node.content,index)?fit:null}function closeFragment(fragment,depth,oldOpen,newOpen,parent){if(depth<oldOpen){var first=fragment.firstChild;fragment=fragment.replaceChild(0,first.copy(closeFragment(first.content,depth+1,oldOpen,newOpen,first)))}if(depth>newOpen){var match=parent.contentMatchAt(0),start=match.fillBefore(fragment).append(fragment);fragment=start.append(match.matchFragment(start).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,!0))}return fragment}function coveredDepths($from,$to){for(var result=[],d=Math.min($from.depth,$to.depth);d>=0;d--){var start=$from.start(d);if(start<$from.pos-($from.depth-d)||$to.end(d)>$to.pos+($to.depth-d)||$from.node(d).type.spec.isolating||$to.node(d).type.spec.isolating)break;(start==$to.start(d)||d==$from.depth&&d==$to.depth&&$from.parent.inlineContent&&$to.parent.inlineContent&&d&&$to.start(d-1)==start-1)&&result.push(d)}return result}prototypeAccessors$1.depth.get=function(){return this.frontier.length-1},Fitter.prototype.fit=function fit(){for(;this.unplaced.size;){var fit=this.findFittable();fit?this.placeNodes(fit):this.openMore()||this.dropNode()}var moveInline=this.mustMoveInline(),placedSize=this.placed.size-this.depth-this.$from.depth,$from=this.$from,$to=this.close(moveInline<0?this.$to:$from.doc.resolve(moveInline));if(!$to)return null;for(var content=this.placed,openStart=$from.depth,openEnd=$to.depth;openStart&&openEnd&&1==content.childCount;)content=content.firstChild.content,openStart--,openEnd--;var slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(content,openStart,openEnd);return moveInline>-1?new ReplaceAroundStep($from.pos,moveInline,this.$to.pos,this.$to.end(),slice,placedSize):slice.size||$from.pos!=this.$to.pos?new ReplaceStep($from.pos,$to.pos,slice):void 0},Fitter.prototype.findFittable=function findFittable(){for(var pass=1;pass<=2;pass++)for(var sliceDepth=this.unplaced.openStart;sliceDepth>=0;sliceDepth--)for(var parent=void 0,first=(sliceDepth?(parent=contentAt(this.unplaced.content,sliceDepth-1).firstChild).content:this.unplaced.content).firstChild,frontierDepth=this.depth;frontierDepth>=0;frontierDepth--){var ref=this.frontier[frontierDepth],type=ref.type,match=ref.match,wrap=void 0,inject=void 0;if(1==pass&&(first?match.matchType(first.type)||(inject=match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(first),!1)):type.compatibleContent(parent.type)))return{sliceDepth:sliceDepth,frontierDepth:frontierDepth,parent:parent,inject:inject};if(2==pass&&first&&(wrap=match.findWrapping(first.type)))return{sliceDepth:sliceDepth,frontierDepth:frontierDepth,parent:parent,wrap:wrap};if(parent&&match.matchType(parent.type))break}},Fitter.prototype.openMore=function openMore(){var ref=this.unplaced,content=ref.content,openStart=ref.openStart,openEnd=ref.openEnd,inner=contentAt(content,openStart);return!(!inner.childCount||inner.firstChild.isLeaf)&&(this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(content,openStart+1,Math.max(openEnd,inner.size+openStart>=content.size-openEnd?openStart+1:0)),!0)},Fitter.prototype.dropNode=function dropNode(){var ref=this.unplaced,content=ref.content,openStart=ref.openStart,openEnd=ref.openEnd,inner=contentAt(content,openStart);if(inner.childCount<=1&&openStart>0){var openAtEnd=content.size-openStart<=openStart+inner.size;this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(dropFromFragment(content,openStart-1,1),openStart-1,openAtEnd?openStart-1:openEnd)}else this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(dropFromFragment(content,openStart,1),openStart,openEnd)},Fitter.prototype.placeNodes=function placeNodes(ref){for(var sliceDepth=ref.sliceDepth,frontierDepth=ref.frontierDepth,parent=ref.parent,inject=ref.inject,wrap=ref.wrap;this.depth>frontierDepth;)this.closeFrontierNode();if(wrap)for(var i=0;i<wrap.length;i++)this.openFrontierNode(wrap[i]);var slice=this.unplaced,fragment=parent?parent.content:slice.content,openStart=slice.openStart-sliceDepth,taken=0,add=[],ref$1=this.frontier[frontierDepth],match=ref$1.match,type=ref$1.type;if(inject){for(var i$1=0;i$1<inject.childCount;i$1++)add.push(inject.child(i$1));match=match.matchFragment(inject)}for(var openEndCount=fragment.size+sliceDepth-(slice.content.size-slice.openEnd);taken<fragment.childCount;){var next=fragment.child(taken),matches=match.matchType(next.type);if(!matches)break;(++taken>1||0==openStart||next.content.size)&&(match=matches,add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)),1==taken?openStart:0,taken==fragment.childCount?openEndCount:-1)))}var toEnd=taken==fragment.childCount;toEnd||(openEndCount=-1),this.placed=addToFragment(this.placed,frontierDepth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(add)),this.frontier[frontierDepth].match=match,toEnd&&openEndCount<0&&parent&&parent.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var i$2=0,cur=fragment;i$2<openEndCount;i$2++){var node=cur.lastChild;this.frontier.push({type:node.type,match:node.contentMatchAt(node.childCount)}),cur=node.content}this.unplaced=toEnd?0==sliceDepth?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(dropFromFragment(slice.content,sliceDepth-1,1),sliceDepth-1,openEndCount<0?slice.openEnd:sliceDepth-1):new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(dropFromFragment(slice.content,sliceDepth,taken),slice.openStart,slice.openEnd)},Fitter.prototype.mustMoveInline=function mustMoveInline(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var level,top=this.frontier[this.depth];if(!top.type.isTextblock||!contentAfterFits(this.$to,this.$to.depth,top.type,top.match,!1)||this.$to.depth==this.depth&&(level=this.findCloseLevel(this.$to))&&level.depth==this.depth)return-1;for(var depth=this.$to.depth,after=this.$to.after(depth);depth>1&&after==this.$to.end(--depth);)++after;return after},Fitter.prototype.findCloseLevel=function findCloseLevel($to){scan:for(var i=Math.min(this.depth,$to.depth);i>=0;i--){var ref=this.frontier[i],match=ref.match,type=ref.type,dropInner=i<$to.depth&&$to.end(i+1)==$to.pos+($to.depth-(i+1)),fit=contentAfterFits($to,i,type,match,dropInner);if(fit){for(var d=i-1;d>=0;d--){var ref$1=this.frontier[d],match$1=ref$1.match,matches=contentAfterFits($to,d,ref$1.type,match$1,!0);if(!matches||matches.childCount)continue scan}return{depth:i,fit:fit,move:dropInner?$to.doc.resolve($to.after(i+1)):$to}}}},Fitter.prototype.close=function close($to){var close=this.findCloseLevel($to);if(!close)return null;for(;this.depth>close.depth;)this.closeFrontierNode();close.fit.childCount&&(this.placed=addToFragment(this.placed,close.depth,close.fit)),$to=close.move;for(var d=close.depth+1;d<=$to.depth;d++){var node=$to.node(d),add=node.type.contentMatch.fillBefore(node.content,!0,$to.index(d));this.openFrontierNode(node.type,node.attrs,add)}return $to},Fitter.prototype.openFrontierNode=function openFrontierNode(type,attrs,content){var top=this.frontier[this.depth];top.match=top.match.matchType(type),this.placed=addToFragment(this.placed,this.depth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(type.create(attrs,content))),this.frontier.push({type:type,match:type.contentMatch})},Fitter.prototype.closeFrontierNode=function closeFrontierNode(){var add=this.frontier.pop().match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.empty,!0);add.childCount&&(this.placed=addToFragment(this.placed,this.frontier.length,add))},Object.defineProperties(Fitter.prototype,prototypeAccessors$1),Transform.prototype.replaceRange=function(from,to,slice){if(!slice.size)return this.deleteRange(from,to);var $from=this.doc.resolve(from),$to=this.doc.resolve(to);if(fitsTrivially($from,$to,slice))return this.step(new ReplaceStep(from,to,slice));var targetDepths=coveredDepths($from,this.doc.resolve(to));0==targetDepths[targetDepths.length-1]&&targetDepths.pop();var preferredTarget=-($from.depth+1);targetDepths.unshift(preferredTarget);for(var d=$from.depth,pos=$from.pos-1;d>0;d--,pos--){var spec=$from.node(d).type.spec;if(spec.defining||spec.isolating)break;targetDepths.indexOf(d)>-1?preferredTarget=d:$from.before(d)==pos&&targetDepths.splice(1,0,-d)}for(var preferredTargetIndex=targetDepths.indexOf(preferredTarget),leftNodes=[],preferredDepth=slice.openStart,content=slice.content,i=0;;i++){var node=content.firstChild;if(leftNodes.push(node),i==slice.openStart)break;content=node.content}preferredDepth>0&&leftNodes[preferredDepth-1].type.spec.defining&&$from.node(preferredTargetIndex).type!=leftNodes[preferredDepth-1].type?preferredDepth-=1:preferredDepth>=2&&leftNodes[preferredDepth-1].isTextblock&&leftNodes[preferredDepth-2].type.spec.defining&&$from.node(preferredTargetIndex).type!=leftNodes[preferredDepth-2].type&&(preferredDepth-=2);for(var j=slice.openStart;j>=0;j--){var openDepth=(j+preferredDepth+1)%(slice.openStart+1),insert=leftNodes[openDepth];if(insert)for(var i$1=0;i$1<targetDepths.length;i$1++){var targetDepth=targetDepths[(i$1+preferredTargetIndex)%targetDepths.length],expand=!0;targetDepth<0&&(expand=!1,targetDepth=-targetDepth);var parent=$from.node(targetDepth-1),index=$from.index(targetDepth-1);if(parent.canReplaceWith(index,index,insert.type,insert.marks))return this.replace($from.before(targetDepth),expand?$to.after(targetDepth):to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(closeFragment(slice.content,0,slice.openStart,openDepth),openDepth,slice.openEnd))}}for(var startSteps=this.steps.length,i$2=targetDepths.length-1;i$2>=0&&(this.replace(from,to,slice),!(this.steps.length>startSteps));i$2--){var depth=targetDepths[i$2];depth<0||(from=$from.before(depth),to=$to.after(depth))}return this},Transform.prototype.replaceRangeWith=function(from,to,node){if(!node.isInline&&from==to&&this.doc.resolve(from).parent.content.size){var point=function insertPoint(doc,pos,nodeType){var $pos=doc.resolve(pos);if($pos.parent.canReplaceWith($pos.index(),$pos.index(),nodeType))return pos;if(0==$pos.parentOffset)for(var d=$pos.depth-1;d>=0;d--){var index=$pos.index(d);if($pos.node(d).canReplaceWith(index,index,nodeType))return $pos.before(d+1);if(index>0)return null}if($pos.parentOffset==$pos.parent.content.size)for(var d$1=$pos.depth-1;d$1>=0;d$1--){var index$1=$pos.indexAfter(d$1);if($pos.node(d$1).canReplaceWith(index$1,index$1,nodeType))return $pos.after(d$1+1);if(index$1<$pos.node(d$1).childCount)return null}}(this.doc,from,node.type);null!=point&&(from=to=point)}return this.replaceRange(from,to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.j(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.c.from(node),0,0))},Transform.prototype.deleteRange=function(from,to){for(var $from=this.doc.resolve(from),$to=this.doc.resolve(to),covered=coveredDepths($from,$to),i=0;i<covered.length;i++){var depth=covered[i],last=i==covered.length-1;if(last&&0==depth||$from.node(depth).type.contentMatch.validEnd)return this.delete($from.start(depth),$to.end(depth));if(depth>0&&(last||$from.node(depth-1).canReplace($from.index(depth-1),$to.indexAfter(depth-1))))return this.delete($from.before(depth),$to.after(depth))}for(var d=1;d<=$from.depth&&d<=$to.depth;d++)if(from-$from.start(d)==$from.depth-d&&to>$from.end(d)&&$to.end(d)-to!=$to.depth-d)return this.delete($from.before(d),to);return this.delete(from,to)}},3057:function(module,__webpack_exports__,__webpack_require__){"use strict";function OrderedMap(content){this.content=content}__webpack_require__.d(__webpack_exports__,"a",(function(){return DOMParser})),__webpack_require__.d(__webpack_exports__,"b",(function(){return DOMSerializer})),__webpack_require__.d(__webpack_exports__,"c",(function(){return Fragment})),__webpack_require__.d(__webpack_exports__,"d",(function(){return Mark})),__webpack_require__.d(__webpack_exports__,"e",(function(){return MarkType})),__webpack_require__.d(__webpack_exports__,"f",(function(){return Node})),__webpack_require__.d(__webpack_exports__,"g",(function(){return NodeRange})),__webpack_require__.d(__webpack_exports__,"h",(function(){return ReplaceError})),__webpack_require__.d(__webpack_exports__,"i",(function(){return index_es_Schema})),__webpack_require__.d(__webpack_exports__,"j",(function(){return Slice})),OrderedMap.prototype={constructor:OrderedMap,find:function(key){for(var i=0;i<this.content.length;i+=2)if(this.content[i]===key)return i;return-1},get:function(key){var found=this.find(key);return-1==found?void 0:this.content[found+1]},update:function(key,value,newKey){var self=newKey&&newKey!=key?this.remove(newKey):this,found=self.find(key),content=self.content.slice();return-1==found?content.push(newKey||key,value):(content[found+1]=value,newKey&&(content[found]=newKey)),new OrderedMap(content)},remove:function(key){var found=this.find(key);if(-1==found)return this;var content=this.content.slice();return content.splice(found,2),new OrderedMap(content)},addToStart:function(key,value){return new OrderedMap([key,value].concat(this.remove(key).content))},addToEnd:function(key,value){var content=this.remove(key).content.slice();return content.push(key,value),new OrderedMap(content)},addBefore:function(place,key,value){var without=this.remove(key),content=without.content.slice(),found=without.find(place);return content.splice(-1==found?content.length:found,0,key,value),new OrderedMap(content)},forEach:function(f){for(var i=0;i<this.content.length;i+=2)f(this.content[i],this.content[i+1])},prepend:function(map){return(map=OrderedMap.from(map)).size?new OrderedMap(map.content.concat(this.subtract(map).content)):this},append:function(map){return(map=OrderedMap.from(map)).size?new OrderedMap(this.subtract(map).content.concat(map.content)):this},subtract:function(map){var result=this;map=OrderedMap.from(map);for(var i=0;i<map.content.length;i+=2)result=result.remove(map.content[i]);return result},get size(){return this.content.length>>1}},OrderedMap.from=function(value){if(value instanceof OrderedMap)return value;var content=[];if(value)for(var prop in value)content.push(prop,value[prop]);return new OrderedMap(content)};var index_es=OrderedMap;function findDiffStart(a,b,pos){for(var i=0;;i++){if(i==a.childCount||i==b.childCount)return a.childCount==b.childCount?null:pos;var childA=a.child(i),childB=b.child(i);if(childA!=childB){if(!childA.sameMarkup(childB))return pos;if(childA.isText&&childA.text!=childB.text){for(var j=0;childA.text[j]==childB.text[j];j++)pos++;return pos}if(childA.content.size||childB.content.size){var inner=findDiffStart(childA.content,childB.content,pos+1);if(null!=inner)return inner}pos+=childA.nodeSize}else pos+=childA.nodeSize}}function findDiffEnd(a,b,posA,posB){for(var iA=a.childCount,iB=b.childCount;;){if(0==iA||0==iB)return iA==iB?null:{a:posA,b:posB};var childA=a.child(--iA),childB=b.child(--iB),size=childA.nodeSize;if(childA!=childB){if(!childA.sameMarkup(childB))return{a:posA,b:posB};if(childA.isText&&childA.text!=childB.text){for(var same=0,minSize=Math.min(childA.text.length,childB.text.length);same<minSize&&childA.text[childA.text.length-same-1]==childB.text[childB.text.length-same-1];)same++,posA--,posB--;return{a:posA,b:posB}}if(childA.content.size||childB.content.size){var inner=findDiffEnd(childA.content,childB.content,posA-1,posB-1);if(inner)return inner}posA-=size,posB-=size}else posA-=size,posB-=size}}var Fragment=function Fragment(content,size){if(this.content=content,this.size=size||0,null==size)for(var i=0;i<content.length;i++)this.size+=content[i].nodeSize},prototypeAccessors={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};Fragment.prototype.nodesBetween=function nodesBetween(from,to,f,nodeStart,parent){void 0===nodeStart&&(nodeStart=0);for(var i=0,pos=0;pos<to;i++){var child=this.content[i],end=pos+child.nodeSize;if(end>from&&!1!==f(child,nodeStart+pos,parent,i)&&child.content.size){var start=pos+1;child.nodesBetween(Math.max(0,from-start),Math.min(child.content.size,to-start),f,nodeStart+start)}pos=end}},Fragment.prototype.descendants=function descendants(f){this.nodesBetween(0,this.size,f)},Fragment.prototype.textBetween=function textBetween(from,to,blockSeparator,leafText){var text="",separated=!0;return this.nodesBetween(from,to,(function(node,pos){node.isText?(text+=node.text.slice(Math.max(from,pos)-pos,to-pos),separated=!blockSeparator):node.isLeaf&&leafText?(text+="function"==typeof leafText?leafText(node):leafText,separated=!blockSeparator):!separated&&node.isBlock&&(text+=blockSeparator,separated=!0)}),0),text},Fragment.prototype.append=function append(other){if(!other.size)return this;if(!this.size)return other;var last=this.lastChild,first=other.firstChild,content=this.content.slice(),i=0;for(last.isText&&last.sameMarkup(first)&&(content[content.length-1]=last.withText(last.text+first.text),i=1);i<other.content.length;i++)content.push(other.content[i]);return new Fragment(content,this.size+other.size)},Fragment.prototype.cut=function cut(from,to){if(null==to&&(to=this.size),0==from&&to==this.size)return this;var result=[],size=0;if(to>from)for(var i=0,pos=0;pos<to;i++){var child=this.content[i],end=pos+child.nodeSize;end>from&&((pos<from||end>to)&&(child=child.isText?child.cut(Math.max(0,from-pos),Math.min(child.text.length,to-pos)):child.cut(Math.max(0,from-pos-1),Math.min(child.content.size,to-pos-1))),result.push(child),size+=child.nodeSize),pos=end}return new Fragment(result,size)},Fragment.prototype.cutByIndex=function cutByIndex(from,to){return from==to?Fragment.empty:0==from&&to==this.content.length?this:new Fragment(this.content.slice(from,to))},Fragment.prototype.replaceChild=function replaceChild(index,node){var current=this.content[index];if(current==node)return this;var copy=this.content.slice(),size=this.size+node.nodeSize-current.nodeSize;return copy[index]=node,new Fragment(copy,size)},Fragment.prototype.addToStart=function addToStart(node){return new Fragment([node].concat(this.content),this.size+node.nodeSize)},Fragment.prototype.addToEnd=function addToEnd(node){return new Fragment(this.content.concat(node),this.size+node.nodeSize)},Fragment.prototype.eq=function eq(other){if(this.content.length!=other.content.length)return!1;for(var i=0;i<this.content.length;i++)if(!this.content[i].eq(other.content[i]))return!1;return!0},prototypeAccessors.firstChild.get=function(){return this.content.length?this.content[0]:null},prototypeAccessors.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},prototypeAccessors.childCount.get=function(){return this.content.length},Fragment.prototype.child=function child(index){var found=this.content[index];if(!found)throw new RangeError("Index "+index+" out of range for "+this);return found},Fragment.prototype.maybeChild=function maybeChild(index){return this.content[index]},Fragment.prototype.forEach=function forEach(f){for(var i=0,p=0;i<this.content.length;i++){var child=this.content[i];f(child,p,i),p+=child.nodeSize}},Fragment.prototype.findDiffStart=function findDiffStart$1(other,pos){return void 0===pos&&(pos=0),findDiffStart(this,other,pos)},Fragment.prototype.findDiffEnd=function findDiffEnd$1(other,pos,otherPos){return void 0===pos&&(pos=this.size),void 0===otherPos&&(otherPos=other.size),findDiffEnd(this,other,pos,otherPos)},Fragment.prototype.findIndex=function findIndex(pos,round){if(void 0===round&&(round=-1),0==pos)return retIndex(0,pos);if(pos==this.size)return retIndex(this.content.length,pos);if(pos>this.size||pos<0)throw new RangeError("Position "+pos+" outside of fragment ("+this+")");for(var i=0,curPos=0;;i++){var end=curPos+this.child(i).nodeSize;if(end>=pos)return end==pos||round>0?retIndex(i+1,end):retIndex(i,curPos);curPos=end}},Fragment.prototype.toString=function toString(){return"<"+this.toStringInner()+">"},Fragment.prototype.toStringInner=function toStringInner(){return this.content.join(", ")},Fragment.prototype.toJSON=function toJSON(){return this.content.length?this.content.map((function(n){return n.toJSON()})):null},Fragment.fromJSON=function fromJSON(schema,value){if(!value)return Fragment.empty;if(!Array.isArray(value))throw new RangeError("Invalid input for Fragment.fromJSON");return new Fragment(value.map(schema.nodeFromJSON))},Fragment.fromArray=function fromArray(array){if(!array.length)return Fragment.empty;for(var joined,size=0,i=0;i<array.length;i++){var node=array[i];size+=node.nodeSize,i&&node.isText&&array[i-1].sameMarkup(node)?(joined||(joined=array.slice(0,i)),joined[joined.length-1]=node.withText(joined[joined.length-1].text+node.text)):joined&&joined.push(node)}return new Fragment(joined||array,size)},Fragment.from=function from(nodes){if(!nodes)return Fragment.empty;if(nodes instanceof Fragment)return nodes;if(Array.isArray(nodes))return this.fromArray(nodes);if(nodes.attrs)return new Fragment([nodes],nodes.nodeSize);throw new RangeError("Can not convert "+nodes+" to a Fragment"+(nodes.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(Fragment.prototype,prototypeAccessors);var found={index:0,offset:0};function retIndex(index,offset){return found.index=index,found.offset=offset,found}function compareDeep(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;var array=Array.isArray(a);if(Array.isArray(b)!=array)return!1;if(array){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!compareDeep(a[i],b[i]))return!1}else{for(var p in a)if(!(p in b)||!compareDeep(a[p],b[p]))return!1;for(var p$1 in b)if(!(p$1 in a))return!1}return!0}Fragment.empty=new Fragment([],0);var Mark=function Mark(type,attrs){this.type=type,this.attrs=attrs};function ReplaceError(message){var err=Error.call(this,message);return err.__proto__=ReplaceError.prototype,err}Mark.prototype.addToSet=function addToSet(set){for(var copy,placed=!1,i=0;i<set.length;i++){var other=set[i];if(this.eq(other))return set;if(this.type.excludes(other.type))copy||(copy=set.slice(0,i));else{if(other.type.excludes(this.type))return set;!placed&&other.type.rank>this.type.rank&&(copy||(copy=set.slice(0,i)),copy.push(this),placed=!0),copy&&copy.push(other)}}return copy||(copy=set.slice()),placed||copy.push(this),copy},Mark.prototype.removeFromSet=function removeFromSet(set){for(var i=0;i<set.length;i++)if(this.eq(set[i]))return set.slice(0,i).concat(set.slice(i+1));return set},Mark.prototype.isInSet=function isInSet(set){for(var i=0;i<set.length;i++)if(this.eq(set[i]))return!0;return!1},Mark.prototype.eq=function eq(other){return this==other||this.type==other.type&&compareDeep(this.attrs,other.attrs)},Mark.prototype.toJSON=function toJSON(){var obj={type:this.type.name};for(var _ in this.attrs){obj.attrs=this.attrs;break}return obj},Mark.fromJSON=function fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Mark.fromJSON");var type=schema.marks[json.type];if(!type)throw new RangeError("There is no mark type "+json.type+" in this schema");return type.create(json.attrs)},Mark.sameSet=function sameSet(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].eq(b[i]))return!1;return!0},Mark.setFrom=function setFrom(marks){if(!marks||0==marks.length)return Mark.none;if(marks instanceof Mark)return[marks];var copy=marks.slice();return copy.sort((function(a,b){return a.type.rank-b.type.rank})),copy},Mark.none=[],ReplaceError.prototype=Object.create(Error.prototype),ReplaceError.prototype.constructor=ReplaceError,ReplaceError.prototype.name="ReplaceError";var Slice=function Slice(content,openStart,openEnd){this.content=content,this.openStart=openStart,this.openEnd=openEnd},prototypeAccessors$1={size:{configurable:!0}};function removeRange(content,from,to){var ref=content.findIndex(from),index=ref.index,offset=ref.offset,child=content.maybeChild(index),ref$1=content.findIndex(to),indexTo=ref$1.index,offsetTo=ref$1.offset;if(offset==from||child.isText){if(offsetTo!=to&&!content.child(indexTo).isText)throw new RangeError("Removing non-flat range");return content.cut(0,from).append(content.cut(to))}if(index!=indexTo)throw new RangeError("Removing non-flat range");return content.replaceChild(index,child.copy(removeRange(child.content,from-offset-1,to-offset-1)))}function insertInto(content,dist,insert,parent){var ref=content.findIndex(dist),index=ref.index,offset=ref.offset,child=content.maybeChild(index);if(offset==dist||child.isText)return parent&&!parent.canReplace(index,index,insert)?null:content.cut(0,dist).append(insert).append(content.cut(dist));var inner=insertInto(child.content,dist-offset-1,insert);return inner&&content.replaceChild(index,child.copy(inner))}function replace($from,$to,slice){if(slice.openStart>$from.depth)throw new ReplaceError("Inserted content deeper than insertion position");if($from.depth-slice.openStart!=$to.depth-slice.openEnd)throw new ReplaceError("Inconsistent open depths");return replaceOuter($from,$to,slice,0)}function replaceOuter($from,$to,slice,depth){var index=$from.index(depth),node=$from.node(depth);if(index==$to.index(depth)&&depth<$from.depth-slice.openStart){var inner=replaceOuter($from,$to,slice,depth+1);return node.copy(node.content.replaceChild(index,inner))}if(slice.content.size){if(slice.openStart||slice.openEnd||$from.depth!=depth||$to.depth!=depth){var ref=function prepareSliceForReplace(slice,$along){for(var extra=$along.depth-slice.openStart,node=$along.node(extra).copy(slice.content),i=extra-1;i>=0;i--)node=$along.node(i).copy(Fragment.from(node));return{start:node.resolveNoCache(slice.openStart+extra),end:node.resolveNoCache(node.content.size-slice.openEnd-extra)}}(slice,$from);return index_es_close(node,replaceThreeWay($from,ref.start,ref.end,$to,depth))}var parent=$from.parent,content=parent.content;return index_es_close(parent,content.cut(0,$from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))}return index_es_close(node,replaceTwoWay($from,$to,depth))}function checkJoin(main,sub){if(!sub.type.compatibleContent(main.type))throw new ReplaceError("Cannot join "+sub.type.name+" onto "+main.type.name)}function joinable($before,$after,depth){var node=$before.node(depth);return checkJoin(node,$after.node(depth)),node}function addNode(child,target){var last=target.length-1;last>=0&&child.isText&&child.sameMarkup(target[last])?target[last]=child.withText(target[last].text+child.text):target.push(child)}function addRange($start,$end,depth,target){var node=($end||$start).node(depth),startIndex=0,endIndex=$end?$end.index(depth):node.childCount;$start&&(startIndex=$start.index(depth),$start.depth>depth?startIndex++:$start.textOffset&&(addNode($start.nodeAfter,target),startIndex++));for(var i=startIndex;i<endIndex;i++)addNode(node.child(i),target);$end&&$end.depth==depth&&$end.textOffset&&addNode($end.nodeBefore,target)}function index_es_close(node,content){if(!node.type.validContent(content))throw new ReplaceError("Invalid content for node "+node.type.name);return node.copy(content)}function replaceThreeWay($from,$start,$end,$to,depth){var openStart=$from.depth>depth&&joinable($from,$start,depth+1),openEnd=$to.depth>depth&&joinable($end,$to,depth+1),content=[];return addRange(null,$from,depth,content),openStart&&openEnd&&$start.index(depth)==$end.index(depth)?(checkJoin(openStart,openEnd),addNode(index_es_close(openStart,replaceThreeWay($from,$start,$end,$to,depth+1)),content)):(openStart&&addNode(index_es_close(openStart,replaceTwoWay($from,$start,depth+1)),content),addRange($start,$end,depth,content),openEnd&&addNode(index_es_close(openEnd,replaceTwoWay($end,$to,depth+1)),content)),addRange($to,null,depth,content),new Fragment(content)}function replaceTwoWay($from,$to,depth){var content=[];(addRange(null,$from,depth,content),$from.depth>depth)&&addNode(index_es_close(joinable($from,$to,depth+1),replaceTwoWay($from,$to,depth+1)),content);return addRange($to,null,depth,content),new Fragment(content)}prototypeAccessors$1.size.get=function(){return this.content.size-this.openStart-this.openEnd},Slice.prototype.insertAt=function insertAt(pos,fragment){var content=insertInto(this.content,pos+this.openStart,fragment,null);return content&&new Slice(content,this.openStart,this.openEnd)},Slice.prototype.removeBetween=function removeBetween(from,to){return new Slice(removeRange(this.content,from+this.openStart,to+this.openStart),this.openStart,this.openEnd)},Slice.prototype.eq=function eq(other){return this.content.eq(other.content)&&this.openStart==other.openStart&&this.openEnd==other.openEnd},Slice.prototype.toString=function toString(){return this.content+"("+this.openStart+","+this.openEnd+")"},Slice.prototype.toJSON=function toJSON(){if(!this.content.size)return null;var json={content:this.content.toJSON()};return this.openStart>0&&(json.openStart=this.openStart),this.openEnd>0&&(json.openEnd=this.openEnd),json},Slice.fromJSON=function fromJSON(schema,json){if(!json)return Slice.empty;var openStart=json.openStart||0,openEnd=json.openEnd||0;if("number"!=typeof openStart||"number"!=typeof openEnd)throw new RangeError("Invalid input for Slice.fromJSON");return new Slice(Fragment.fromJSON(schema,json.content),openStart,openEnd)},Slice.maxOpen=function maxOpen(fragment,openIsolating){void 0===openIsolating&&(openIsolating=!0);for(var openStart=0,openEnd=0,n=fragment.firstChild;n&&!n.isLeaf&&(openIsolating||!n.type.spec.isolating);n=n.firstChild)openStart++;for(var n$1=fragment.lastChild;n$1&&!n$1.isLeaf&&(openIsolating||!n$1.type.spec.isolating);n$1=n$1.lastChild)openEnd++;return new Slice(fragment,openStart,openEnd)},Object.defineProperties(Slice.prototype,prototypeAccessors$1),Slice.empty=new Slice(Fragment.empty,0,0);var ResolvedPos=function ResolvedPos(pos,path,parentOffset){this.pos=pos,this.path=path,this.depth=path.length/3-1,this.parentOffset=parentOffset},prototypeAccessors$2={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};ResolvedPos.prototype.resolveDepth=function resolveDepth(val){return null==val?this.depth:val<0?this.depth+val:val},prototypeAccessors$2.parent.get=function(){return this.node(this.depth)},prototypeAccessors$2.doc.get=function(){return this.node(0)},ResolvedPos.prototype.node=function node(depth){return this.path[3*this.resolveDepth(depth)]},ResolvedPos.prototype.index=function index(depth){return this.path[3*this.resolveDepth(depth)+1]},ResolvedPos.prototype.indexAfter=function indexAfter(depth){return depth=this.resolveDepth(depth),this.index(depth)+(depth!=this.depth||this.textOffset?1:0)},ResolvedPos.prototype.start=function start(depth){return 0==(depth=this.resolveDepth(depth))?0:this.path[3*depth-1]+1},ResolvedPos.prototype.end=function end(depth){return depth=this.resolveDepth(depth),this.start(depth)+this.node(depth).content.size},ResolvedPos.prototype.before=function before(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position before the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]},ResolvedPos.prototype.after=function after(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position after the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]+this.path[3*depth].nodeSize},prototypeAccessors$2.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},prototypeAccessors$2.nodeAfter.get=function(){var parent=this.parent,index=this.index(this.depth);if(index==parent.childCount)return null;var dOff=this.pos-this.path[this.path.length-1],child=parent.child(index);return dOff?parent.child(index).cut(dOff):child},prototypeAccessors$2.nodeBefore.get=function(){var index=this.index(this.depth),dOff=this.pos-this.path[this.path.length-1];return dOff?this.parent.child(index).cut(0,dOff):0==index?null:this.parent.child(index-1)},ResolvedPos.prototype.posAtIndex=function posAtIndex(index,depth){depth=this.resolveDepth(depth);for(var node=this.path[3*depth],pos=0==depth?0:this.path[3*depth-1]+1,i=0;i<index;i++)pos+=node.child(i).nodeSize;return pos},ResolvedPos.prototype.marks=function marks(){var parent=this.parent,index=this.index();if(0==parent.content.size)return Mark.none;if(this.textOffset)return parent.child(index).marks;var main=parent.maybeChild(index-1),other=parent.maybeChild(index);if(!main){var tmp=main;main=other,other=tmp}for(var marks=main.marks,i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||other&&marks[i].isInSet(other.marks)||(marks=marks[i--].removeFromSet(marks));return marks},ResolvedPos.prototype.marksAcross=function marksAcross($end){var after=this.parent.maybeChild(this.index());if(!after||!after.isInline)return null;for(var marks=after.marks,next=$end.parent.maybeChild($end.index()),i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||next&&marks[i].isInSet(next.marks)||(marks=marks[i--].removeFromSet(marks));return marks},ResolvedPos.prototype.sharedDepth=function sharedDepth(pos){for(var depth=this.depth;depth>0;depth--)if(this.start(depth)<=pos&&this.end(depth)>=pos)return depth;return 0},ResolvedPos.prototype.blockRange=function blockRange(other,pred){if(void 0===other&&(other=this),other.pos<this.pos)return other.blockRange(this);for(var d=this.depth-(this.parent.inlineContent||this.pos==other.pos?1:0);d>=0;d--)if(other.pos<=this.end(d)&&(!pred||pred(this.node(d))))return new NodeRange(this,other,d)},ResolvedPos.prototype.sameParent=function sameParent(other){return this.pos-this.parentOffset==other.pos-other.parentOffset},ResolvedPos.prototype.max=function max(other){return other.pos>this.pos?other:this},ResolvedPos.prototype.min=function min(other){return other.pos<this.pos?other:this},ResolvedPos.prototype.toString=function toString(){for(var str="",i=1;i<=this.depth;i++)str+=(str?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return str+":"+this.parentOffset},ResolvedPos.resolve=function resolve(doc,pos){if(!(pos>=0&&pos<=doc.content.size))throw new RangeError("Position "+pos+" out of range");for(var path=[],start=0,parentOffset=pos,node=doc;;){var ref=node.content.findIndex(parentOffset),index=ref.index,offset=ref.offset,rem=parentOffset-offset;if(path.push(node,index,start+offset),!rem)break;if((node=node.child(index)).isText)break;parentOffset=rem-1,start+=offset+1}return new ResolvedPos(pos,path,parentOffset)},ResolvedPos.resolveCached=function resolveCached(doc,pos){for(var i=0;i<resolveCache.length;i++){var cached=resolveCache[i];if(cached.pos==pos&&cached.doc==doc)return cached}var result=resolveCache[resolveCachePos]=ResolvedPos.resolve(doc,pos);return resolveCachePos=(resolveCachePos+1)%resolveCacheSize,result},Object.defineProperties(ResolvedPos.prototype,prototypeAccessors$2);var resolveCache=[],resolveCachePos=0,resolveCacheSize=12,NodeRange=function NodeRange($from,$to,depth){this.$from=$from,this.$to=$to,this.depth=depth},prototypeAccessors$1$1={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};prototypeAccessors$1$1.start.get=function(){return this.$from.before(this.depth+1)},prototypeAccessors$1$1.end.get=function(){return this.$to.after(this.depth+1)},prototypeAccessors$1$1.parent.get=function(){return this.$from.node(this.depth)},prototypeAccessors$1$1.startIndex.get=function(){return this.$from.index(this.depth)},prototypeAccessors$1$1.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(NodeRange.prototype,prototypeAccessors$1$1);var emptyAttrs=Object.create(null),Node=function Node(type,attrs,content,marks){this.type=type,this.attrs=attrs,this.content=content||Fragment.empty,this.marks=marks||Mark.none},prototypeAccessors$3={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};prototypeAccessors$3.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},prototypeAccessors$3.childCount.get=function(){return this.content.childCount},Node.prototype.child=function child(index){return this.content.child(index)},Node.prototype.maybeChild=function maybeChild(index){return this.content.maybeChild(index)},Node.prototype.forEach=function forEach(f){this.content.forEach(f)},Node.prototype.nodesBetween=function nodesBetween(from,to,f,startPos){void 0===startPos&&(startPos=0),this.content.nodesBetween(from,to,f,startPos,this)},Node.prototype.descendants=function descendants(f){this.nodesBetween(0,this.content.size,f)},prototypeAccessors$3.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Node.prototype.textBetween=function textBetween(from,to,blockSeparator,leafText){return this.content.textBetween(from,to,blockSeparator,leafText)},prototypeAccessors$3.firstChild.get=function(){return this.content.firstChild},prototypeAccessors$3.lastChild.get=function(){return this.content.lastChild},Node.prototype.eq=function eq(other){return this==other||this.sameMarkup(other)&&this.content.eq(other.content)},Node.prototype.sameMarkup=function sameMarkup(other){return this.hasMarkup(other.type,other.attrs,other.marks)},Node.prototype.hasMarkup=function hasMarkup(type,attrs,marks){return this.type==type&&compareDeep(this.attrs,attrs||type.defaultAttrs||emptyAttrs)&&Mark.sameSet(this.marks,marks||Mark.none)},Node.prototype.copy=function copy(content){return void 0===content&&(content=null),content==this.content?this:new this.constructor(this.type,this.attrs,content,this.marks)},Node.prototype.mark=function mark(marks){return marks==this.marks?this:new this.constructor(this.type,this.attrs,this.content,marks)},Node.prototype.cut=function cut(from,to){return 0==from&&to==this.content.size?this:this.copy(this.content.cut(from,to))},Node.prototype.slice=function slice(from,to,includeParents){if(void 0===to&&(to=this.content.size),void 0===includeParents&&(includeParents=!1),from==to)return Slice.empty;var $from=this.resolve(from),$to=this.resolve(to),depth=includeParents?0:$from.sharedDepth(to),start=$from.start(depth),content=$from.node(depth).content.cut($from.pos-start,$to.pos-start);return new Slice(content,$from.depth-depth,$to.depth-depth)},Node.prototype.replace=function replace$1(from,to,slice){return replace(this.resolve(from),this.resolve(to),slice)},Node.prototype.nodeAt=function nodeAt(pos){for(var node=this;;){var ref=node.content.findIndex(pos),index=ref.index,offset=ref.offset;if(!(node=node.maybeChild(index)))return null;if(offset==pos||node.isText)return node;pos-=offset+1}},Node.prototype.childAfter=function childAfter(pos){var ref=this.content.findIndex(pos),index=ref.index,offset=ref.offset;return{node:this.content.maybeChild(index),index:index,offset:offset}},Node.prototype.childBefore=function childBefore(pos){if(0==pos)return{node:null,index:0,offset:0};var ref=this.content.findIndex(pos),index=ref.index,offset=ref.offset;if(offset<pos)return{node:this.content.child(index),index:index,offset:offset};var node=this.content.child(index-1);return{node:node,index:index-1,offset:offset-node.nodeSize}},Node.prototype.resolve=function resolve(pos){return ResolvedPos.resolveCached(this,pos)},Node.prototype.resolveNoCache=function resolveNoCache(pos){return ResolvedPos.resolve(this,pos)},Node.prototype.rangeHasMark=function rangeHasMark(from,to,type){var found=!1;return to>from&&this.nodesBetween(from,to,(function(node){return type.isInSet(node.marks)&&(found=!0),!found})),found},prototypeAccessors$3.isBlock.get=function(){return this.type.isBlock},prototypeAccessors$3.isTextblock.get=function(){return this.type.isTextblock},prototypeAccessors$3.inlineContent.get=function(){return this.type.inlineContent},prototypeAccessors$3.isInline.get=function(){return this.type.isInline},prototypeAccessors$3.isText.get=function(){return this.type.isText},prototypeAccessors$3.isLeaf.get=function(){return this.type.isLeaf},prototypeAccessors$3.isAtom.get=function(){return this.type.isAtom},Node.prototype.toString=function toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var name=this.type.name;return this.content.size&&(name+="("+this.content.toStringInner()+")"),wrapMarks(this.marks,name)},Node.prototype.contentMatchAt=function contentMatchAt(index){var match=this.type.contentMatch.matchFragment(this.content,0,index);if(!match)throw new Error("Called contentMatchAt on a node with invalid content");return match},Node.prototype.canReplace=function canReplace(from,to,replacement,start,end){void 0===replacement&&(replacement=Fragment.empty),void 0===start&&(start=0),void 0===end&&(end=replacement.childCount);var one=this.contentMatchAt(from).matchFragment(replacement,start,end),two=one&&one.matchFragment(this.content,to);if(!two||!two.validEnd)return!1;for(var i=start;i<end;i++)if(!this.type.allowsMarks(replacement.child(i).marks))return!1;return!0},Node.prototype.canReplaceWith=function canReplaceWith(from,to,type,marks){if(marks&&!this.type.allowsMarks(marks))return!1;var start=this.contentMatchAt(from).matchType(type),end=start&&start.matchFragment(this.content,to);return!!end&&end.validEnd},Node.prototype.canAppend=function canAppend(other){return other.content.size?this.canReplace(this.childCount,this.childCount,other.content):this.type.compatibleContent(other.type)},Node.prototype.check=function check(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var copy=Mark.none,i=0;i<this.marks.length;i++)copy=this.marks[i].addToSet(copy);if(!Mark.sameSet(copy,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(m){return m.type.name})));this.content.forEach((function(node){return node.check()}))},Node.prototype.toJSON=function toJSON(){var obj={type:this.type.name};for(var _ in this.attrs){obj.attrs=this.attrs;break}return this.content.size&&(obj.content=this.content.toJSON()),this.marks.length&&(obj.marks=this.marks.map((function(n){return n.toJSON()}))),obj},Node.fromJSON=function fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Node.fromJSON");var marks=null;if(json.marks){if(!Array.isArray(json.marks))throw new RangeError("Invalid mark data for Node.fromJSON");marks=json.marks.map(schema.markFromJSON)}if("text"==json.type){if("string"!=typeof json.text)throw new RangeError("Invalid text node in JSON");return schema.text(json.text,marks)}var content=Fragment.fromJSON(schema,json.content);return schema.nodeType(json.type).create(json.attrs,content,marks)},Object.defineProperties(Node.prototype,prototypeAccessors$3);var TextNode=function(Node){function TextNode(type,attrs,content,marks){if(Node.call(this,type,attrs,null,marks),!content)throw new RangeError("Empty text nodes are not allowed");this.text=content}Node&&(TextNode.__proto__=Node),TextNode.prototype=Object.create(Node&&Node.prototype),TextNode.prototype.constructor=TextNode;var prototypeAccessors$1={textContent:{configurable:!0},nodeSize:{configurable:!0}};return TextNode.prototype.toString=function toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wrapMarks(this.marks,JSON.stringify(this.text))},prototypeAccessors$1.textContent.get=function(){return this.text},TextNode.prototype.textBetween=function textBetween(from,to){return this.text.slice(from,to)},prototypeAccessors$1.nodeSize.get=function(){return this.text.length},TextNode.prototype.mark=function mark(marks){return marks==this.marks?this:new TextNode(this.type,this.attrs,this.text,marks)},TextNode.prototype.withText=function withText(text){return text==this.text?this:new TextNode(this.type,this.attrs,text,this.marks)},TextNode.prototype.cut=function cut(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.text.length),0==from&&to==this.text.length?this:this.withText(this.text.slice(from,to))},TextNode.prototype.eq=function eq(other){return this.sameMarkup(other)&&this.text==other.text},TextNode.prototype.toJSON=function toJSON(){var base=Node.prototype.toJSON.call(this);return base.text=this.text,base},Object.defineProperties(TextNode.prototype,prototypeAccessors$1),TextNode}(Node);function wrapMarks(marks,str){for(var i=marks.length-1;i>=0;i--)str=marks[i].type.name+"("+str+")";return str}var ContentMatch=function ContentMatch(validEnd){this.validEnd=validEnd,this.next=[],this.wrapCache=[]},prototypeAccessors$4={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};ContentMatch.parse=function parse(string,nodeTypes){var stream=new TokenStream(string,nodeTypes);if(null==stream.next)return ContentMatch.empty;var expr=parseExpr(stream);stream.next&&stream.err("Unexpected trailing text");var match=function dfa(nfa){var labeled=Object.create(null);return explore(nullFrom(nfa,0));function explore(states){var out=[];states.forEach((function(node){nfa[node].forEach((function(ref){var term=ref.term,to=ref.to;if(term){var known=out.indexOf(term),set=known>-1&&out[known+1];nullFrom(nfa,to).forEach((function(node){set||out.push(term,set=[]),-1==set.indexOf(node)&&set.push(node)}))}}))}));for(var state=labeled[states.join(",")]=new ContentMatch(states.indexOf(nfa.length-1)>-1),i=0;i<out.length;i+=2){var states$1=out[i+1].sort(cmp);state.next.push(out[i],labeled[states$1.join(",")]||explore(states$1))}return state}}(function nfa(expr){var nfa=[[]];return connect(compile(expr,0),node()),nfa;function node(){return nfa.push([])-1}function edge(from,to,term){var edge={term:term,to:to};return nfa[from].push(edge),edge}function connect(edges,to){edges.forEach((function(edge){return edge.to=to}))}function compile(expr,from){if("choice"==expr.type)return expr.exprs.reduce((function(out,expr){return out.concat(compile(expr,from))}),[]);if("seq"==expr.type)for(var i=0;;i++){var next=compile(expr.exprs[i],from);if(i==expr.exprs.length-1)return next;connect(next,from=node())}else{if("star"==expr.type){var loop=node();return edge(from,loop),connect(compile(expr.expr,loop),loop),[edge(loop)]}if("plus"==expr.type){var loop$1=node();return connect(compile(expr.expr,from),loop$1),connect(compile(expr.expr,loop$1),loop$1),[edge(loop$1)]}if("opt"==expr.type)return[edge(from)].concat(compile(expr.expr,from));if("range"==expr.type){for(var cur=from,i$1=0;i$1<expr.min;i$1++){var next$1=node();connect(compile(expr.expr,cur),next$1),cur=next$1}if(-1==expr.max)connect(compile(expr.expr,cur),cur);else for(var i$2=expr.min;i$2<expr.max;i$2++){var next$2=node();edge(cur,next$2),connect(compile(expr.expr,cur),next$2),cur=next$2}return[edge(cur)]}if("name"==expr.type)return[edge(from,null,expr.value)]}}}(expr));return function checkForDeadEnds(match,stream){for(var i=0,work=[match];i<work.length;i++){for(var state=work[i],dead=!state.validEnd,nodes=[],j=0;j<state.next.length;j+=2){var node=state.next[j],next=state.next[j+1];nodes.push(node.name),!dead||node.isText||node.hasRequiredAttrs()||(dead=!1),-1==work.indexOf(next)&&work.push(next)}dead&&stream.err("Only non-generatable nodes ("+nodes.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(match,stream),match},ContentMatch.prototype.matchType=function matchType(type){for(var i=0;i<this.next.length;i+=2)if(this.next[i]==type)return this.next[i+1];return null},ContentMatch.prototype.matchFragment=function matchFragment(frag,start,end){void 0===start&&(start=0),void 0===end&&(end=frag.childCount);for(var cur=this,i=start;cur&&i<end;i++)cur=cur.matchType(frag.child(i).type);return cur},prototypeAccessors$4.inlineContent.get=function(){var first=this.next[0];return!!first&&first.isInline},prototypeAccessors$4.defaultType.get=function(){for(var i=0;i<this.next.length;i+=2){var type=this.next[i];if(!type.isText&&!type.hasRequiredAttrs())return type}},ContentMatch.prototype.compatible=function compatible(other){for(var i=0;i<this.next.length;i+=2)for(var j=0;j<other.next.length;j+=2)if(this.next[i]==other.next[j])return!0;return!1},ContentMatch.prototype.fillBefore=function fillBefore(after,toEnd,startIndex){void 0===toEnd&&(toEnd=!1),void 0===startIndex&&(startIndex=0);var seen=[this];return function search(match,types){var finished=match.matchFragment(after,startIndex);if(finished&&(!toEnd||finished.validEnd))return Fragment.from(types.map((function(tp){return tp.createAndFill()})));for(var i=0;i<match.next.length;i+=2){var type=match.next[i],next=match.next[i+1];if(!type.isText&&!type.hasRequiredAttrs()&&-1==seen.indexOf(next)){seen.push(next);var found=search(next,types.concat(type));if(found)return found}}}(this,[])},ContentMatch.prototype.findWrapping=function findWrapping(target){for(var i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==target)return this.wrapCache[i+1];var computed=this.computeWrapping(target);return this.wrapCache.push(target,computed),computed},ContentMatch.prototype.computeWrapping=function computeWrapping(target){for(var seen=Object.create(null),active=[{match:this,type:null,via:null}];active.length;){var current=active.shift(),match=current.match;if(match.matchType(target)){for(var result=[],obj=current;obj.type;obj=obj.via)result.push(obj.type);return result.reverse()}for(var i=0;i<match.next.length;i+=2){var type=match.next[i];type.isLeaf||type.hasRequiredAttrs()||type.name in seen||current.type&&!match.next[i+1].validEnd||(active.push({match:type.contentMatch,type:type,via:current}),seen[type.name]=!0)}}},prototypeAccessors$4.edgeCount.get=function(){return this.next.length>>1},ContentMatch.prototype.edge=function edge(n){var i=n<<1;if(i>=this.next.length)throw new RangeError("There's no "+n+"th edge in this content match");return{type:this.next[i],next:this.next[i+1]}},ContentMatch.prototype.toString=function toString(){var seen=[];return function scan(m){seen.push(m);for(var i=1;i<m.next.length;i+=2)-1==seen.indexOf(m.next[i])&&scan(m.next[i])}(this),seen.map((function(m,i){for(var out=i+(m.validEnd?"*":" ")+" ",i$1=0;i$1<m.next.length;i$1+=2)out+=(i$1?", ":"")+m.next[i$1].name+"->"+seen.indexOf(m.next[i$1+1]);return out})).join("\n")},Object.defineProperties(ContentMatch.prototype,prototypeAccessors$4),ContentMatch.empty=new ContentMatch(!0);var TokenStream=function TokenStream(string,nodeTypes){this.string=string,this.nodeTypes=nodeTypes,this.inline=null,this.pos=0,this.tokens=string.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},prototypeAccessors$1$2={next:{configurable:!0}};function parseExpr(stream){var exprs=[];do{exprs.push(parseExprSeq(stream))}while(stream.eat("|"));return 1==exprs.length?exprs[0]:{type:"choice",exprs:exprs}}function parseExprSeq(stream){var exprs=[];do{exprs.push(parseExprSubscript(stream))}while(stream.next&&")"!=stream.next&&"|"!=stream.next);return 1==exprs.length?exprs[0]:{type:"seq",exprs:exprs}}function parseExprSubscript(stream){for(var expr=function parseExprAtom(stream){if(stream.eat("(")){var expr=parseExpr(stream);return stream.eat(")")||stream.err("Missing closing paren"),expr}if(!/\W/.test(stream.next)){var exprs=function resolveName(stream,name){var types=stream.nodeTypes,type=types[name];if(type)return[type];var result=[];for(var typeName in types){var type$1=types[typeName];type$1.groups.indexOf(name)>-1&&result.push(type$1)}0==result.length&&stream.err("No node type or group '"+name+"' found");return result}(stream,stream.next).map((function(type){return null==stream.inline?stream.inline=type.isInline:stream.inline!=type.isInline&&stream.err("Mixing inline and block content"),{type:"name",value:type}}));return stream.pos++,1==exprs.length?exprs[0]:{type:"choice",exprs:exprs}}stream.err("Unexpected token '"+stream.next+"'")}(stream);;)if(stream.eat("+"))expr={type:"plus",expr:expr};else if(stream.eat("*"))expr={type:"star",expr:expr};else if(stream.eat("?"))expr={type:"opt",expr:expr};else{if(!stream.eat("{"))break;expr=parseExprRange(stream,expr)}return expr}function parseNum(stream){/\D/.test(stream.next)&&stream.err("Expected number, got '"+stream.next+"'");var result=Number(stream.next);return stream.pos++,result}function parseExprRange(stream,expr){var min=parseNum(stream),max=min;return stream.eat(",")&&(max="}"!=stream.next?parseNum(stream):-1),stream.eat("}")||stream.err("Unclosed braced range"),{type:"range",min:min,max:max,expr:expr}}function cmp(a,b){return b-a}function nullFrom(nfa,node){var result=[];return function scan(node){var edges=nfa[node];if(1==edges.length&&!edges[0].term)return scan(edges[0].to);result.push(node);for(var i=0;i<edges.length;i++){var ref=edges[i],term=ref.term,to=ref.to;term||-1!=result.indexOf(to)||scan(to)}}(node),result.sort(cmp)}function defaultAttrs(attrs){var defaults=Object.create(null);for(var attrName in attrs){var attr=attrs[attrName];if(!attr.hasDefault)return null;defaults[attrName]=attr.default}return defaults}function computeAttrs(attrs,value){var built=Object.create(null);for(var name in attrs){var given=value&&value[name];if(void 0===given){var attr=attrs[name];if(!attr.hasDefault)throw new RangeError("No value supplied for attribute "+name);given=attr.default}built[name]=given}return built}function initAttrs(attrs){var result=Object.create(null);if(attrs)for(var name in attrs)result[name]=new Attribute(attrs[name]);return result}prototypeAccessors$1$2.next.get=function(){return this.tokens[this.pos]},TokenStream.prototype.eat=function eat(tok){return this.next==tok&&(this.pos++||!0)},TokenStream.prototype.err=function err(str){throw new SyntaxError(str+" (in content expression '"+this.string+"')")},Object.defineProperties(TokenStream.prototype,prototypeAccessors$1$2);var NodeType=function NodeType(name,schema,spec){this.name=name,this.schema=schema,this.spec=spec,this.groups=spec.group?spec.group.split(" "):[],this.attrs=initAttrs(spec.attrs),this.defaultAttrs=defaultAttrs(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(spec.inline||"text"==name),this.isText="text"==name},prototypeAccessors$5={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0},whitespace:{configurable:!0}};prototypeAccessors$5.isInline.get=function(){return!this.isBlock},prototypeAccessors$5.isTextblock.get=function(){return this.isBlock&&this.inlineContent},prototypeAccessors$5.isLeaf.get=function(){return this.contentMatch==ContentMatch.empty},prototypeAccessors$5.isAtom.get=function(){return this.isLeaf||this.spec.atom},prototypeAccessors$5.whitespace.get=function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")},NodeType.prototype.hasRequiredAttrs=function hasRequiredAttrs(){for(var n in this.attrs)if(this.attrs[n].isRequired)return!0;return!1},NodeType.prototype.compatibleContent=function compatibleContent(other){return this==other||this.contentMatch.compatible(other.contentMatch)},NodeType.prototype.computeAttrs=function computeAttrs$1(attrs){return!attrs&&this.defaultAttrs?this.defaultAttrs:computeAttrs(this.attrs,attrs)},NodeType.prototype.create=function create(attrs,content,marks){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Node(this,this.computeAttrs(attrs),Fragment.from(content),Mark.setFrom(marks))},NodeType.prototype.createChecked=function createChecked(attrs,content,marks){if(content=Fragment.from(content),!this.validContent(content))throw new RangeError("Invalid content for node "+this.name);return new Node(this,this.computeAttrs(attrs),content,Mark.setFrom(marks))},NodeType.prototype.createAndFill=function createAndFill(attrs,content,marks){if(attrs=this.computeAttrs(attrs),(content=Fragment.from(content)).size){var before=this.contentMatch.fillBefore(content);if(!before)return null;content=before.append(content)}var after=this.contentMatch.matchFragment(content).fillBefore(Fragment.empty,!0);return after?new Node(this,attrs,content.append(after),Mark.setFrom(marks)):null},NodeType.prototype.validContent=function validContent(content){var result=this.contentMatch.matchFragment(content);if(!result||!result.validEnd)return!1;for(var i=0;i<content.childCount;i++)if(!this.allowsMarks(content.child(i).marks))return!1;return!0},NodeType.prototype.allowsMarkType=function allowsMarkType(markType){return null==this.markSet||this.markSet.indexOf(markType)>-1},NodeType.prototype.allowsMarks=function allowsMarks(marks){if(null==this.markSet)return!0;for(var i=0;i<marks.length;i++)if(!this.allowsMarkType(marks[i].type))return!1;return!0},NodeType.prototype.allowedMarks=function allowedMarks(marks){if(null==this.markSet)return marks;for(var copy,i=0;i<marks.length;i++)this.allowsMarkType(marks[i].type)?copy&&copy.push(marks[i]):copy||(copy=marks.slice(0,i));return copy?copy.length?copy:Mark.empty:marks},NodeType.compile=function compile(nodes,schema){var result=Object.create(null);nodes.forEach((function(name,spec){return result[name]=new NodeType(name,schema,spec)}));var topType=schema.spec.topNode||"doc";if(!result[topType])throw new RangeError("Schema is missing its top node type ('"+topType+"')");if(!result.text)throw new RangeError("Every schema needs a 'text' type");for(var _ in result.text.attrs)throw new RangeError("The text node type should not have attributes");return result},Object.defineProperties(NodeType.prototype,prototypeAccessors$5);var Attribute=function Attribute(options){this.hasDefault=Object.prototype.hasOwnProperty.call(options,"default"),this.default=options.default},prototypeAccessors$1$3={isRequired:{configurable:!0}};prototypeAccessors$1$3.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Attribute.prototype,prototypeAccessors$1$3);var MarkType=function MarkType(name,rank,schema,spec){this.name=name,this.schema=schema,this.spec=spec,this.attrs=initAttrs(spec.attrs),this.rank=rank,this.excluded=null;var defaults=defaultAttrs(this.attrs);this.instance=defaults&&new Mark(this,defaults)};MarkType.prototype.create=function create(attrs){return!attrs&&this.instance?this.instance:new Mark(this,computeAttrs(this.attrs,attrs))},MarkType.compile=function compile(marks,schema){var result=Object.create(null),rank=0;return marks.forEach((function(name,spec){return result[name]=new MarkType(name,rank++,schema,spec)})),result},MarkType.prototype.removeFromSet=function removeFromSet(set){for(var i=0;i<set.length;i++)set[i].type==this&&(set=set.slice(0,i).concat(set.slice(i+1)),i--);return set},MarkType.prototype.isInSet=function isInSet(set){for(var i=0;i<set.length;i++)if(set[i].type==this)return set[i]},MarkType.prototype.excludes=function excludes(other){return this.excluded.indexOf(other)>-1};var index_es_Schema=function Schema(spec){for(var prop in this.spec={},spec)this.spec[prop]=spec[prop];this.spec.nodes=index_es.from(spec.nodes),this.spec.marks=index_es.from(spec.marks),this.nodes=NodeType.compile(this.spec.nodes,this),this.marks=MarkType.compile(this.spec.marks,this);var contentExprCache=Object.create(null);for(var prop$1 in this.nodes){if(prop$1 in this.marks)throw new RangeError(prop$1+" can not be both a node and a mark");var type=this.nodes[prop$1],contentExpr=type.spec.content||"",markExpr=type.spec.marks;type.contentMatch=contentExprCache[contentExpr]||(contentExprCache[contentExpr]=ContentMatch.parse(contentExpr,this.nodes)),type.inlineContent=type.contentMatch.inlineContent,type.markSet="_"==markExpr?null:markExpr?gatherMarks(this,markExpr.split(" ")):""!=markExpr&&type.inlineContent?null:[]}for(var prop$2 in this.marks){var type$1=this.marks[prop$2],excl=type$1.spec.excludes;type$1.excluded=null==excl?[type$1]:""==excl?[]:gatherMarks(this,excl.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function gatherMarks(schema,marks){for(var found=[],i=0;i<marks.length;i++){var name=marks[i],mark=schema.marks[name],ok=mark;if(mark)found.push(mark);else for(var prop in schema.marks){var mark$1=schema.marks[prop];("_"==name||mark$1.spec.group&&mark$1.spec.group.split(" ").indexOf(name)>-1)&&found.push(ok=mark$1)}if(!ok)throw new SyntaxError("Unknown mark type: '"+marks[i]+"'")}return found}index_es_Schema.prototype.node=function node(type,attrs,content,marks){if("string"==typeof type)type=this.nodeType(type);else{if(!(type instanceof NodeType))throw new RangeError("Invalid node type: "+type);if(type.schema!=this)throw new RangeError("Node type from different schema used ("+type.name+")")}return type.createChecked(attrs,content,marks)},index_es_Schema.prototype.text=function text(text$1,marks){var type=this.nodes.text;return new TextNode(type,type.defaultAttrs,text$1,Mark.setFrom(marks))},index_es_Schema.prototype.mark=function mark(type,attrs){return"string"==typeof type&&(type=this.marks[type]),type.create(attrs)},index_es_Schema.prototype.nodeFromJSON=function nodeFromJSON(json){return Node.fromJSON(this,json)},index_es_Schema.prototype.markFromJSON=function markFromJSON(json){return Mark.fromJSON(this,json)},index_es_Schema.prototype.nodeType=function nodeType(name){var found=this.nodes[name];if(!found)throw new RangeError("Unknown node type: "+name);return found};var DOMParser=function DOMParser(schema,rules){var this$1=this;this.schema=schema,this.rules=rules,this.tags=[],this.styles=[],rules.forEach((function(rule){rule.tag?this$1.tags.push(rule):rule.style&&this$1.styles.push(rule)})),this.normalizeLists=!this.tags.some((function(r){if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;var node=schema.nodes[r.node];return node.contentMatch.matchType(node)}))};DOMParser.prototype.parse=function parse(dom,options){void 0===options&&(options={});var context=new ParseContext(this,options,!1);return context.addAll(dom,null,options.from,options.to),context.finish()},DOMParser.prototype.parseSlice=function parseSlice(dom,options){void 0===options&&(options={});var context=new ParseContext(this,options,!0);return context.addAll(dom,null,options.from,options.to),Slice.maxOpen(context.finish())},DOMParser.prototype.matchTag=function matchTag(dom,context,after){for(var i=after?this.tags.indexOf(after)+1:0;i<this.tags.length;i++){var rule=this.tags[i];if(matches(dom,rule.tag)&&(void 0===rule.namespace||dom.namespaceURI==rule.namespace)&&(!rule.context||context.matchesContext(rule.context))){if(rule.getAttrs){var result=rule.getAttrs(dom);if(!1===result)continue;rule.attrs=result}return rule}}},DOMParser.prototype.matchStyle=function matchStyle(prop,value,context,after){for(var i=after?this.styles.indexOf(after)+1:0;i<this.styles.length;i++){var rule=this.styles[i];if(!(0!=rule.style.indexOf(prop)||rule.context&&!context.matchesContext(rule.context)||rule.style.length>prop.length&&(61!=rule.style.charCodeAt(prop.length)||rule.style.slice(prop.length+1)!=value))){if(rule.getAttrs){var result=rule.getAttrs(value);if(!1===result)continue;rule.attrs=result}return rule}}},DOMParser.schemaRules=function schemaRules(schema){var result=[];function insert(rule){for(var priority=null==rule.priority?50:rule.priority,i=0;i<result.length;i++){var next=result[i];if((null==next.priority?50:next.priority)<priority)break}result.splice(i,0,rule)}var loop=function(name){var rules=schema.marks[name].spec.parseDOM;rules&&rules.forEach((function(rule){insert(rule=copy(rule)),rule.mark=name}))};for(var name in schema.marks)loop(name);var rules$1;for(var name$1 in schema.nodes)rules$1=void 0,(rules$1=schema.nodes[name$1].spec.parseDOM)&&rules$1.forEach((function(rule){insert(rule=copy(rule)),rule.node=name$1}));return result},DOMParser.fromSchema=function fromSchema(schema){return schema.cached.domParser||(schema.cached.domParser=new DOMParser(schema,DOMParser.schemaRules(schema)))};var blockTags={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ignoreTags={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},listTags={ol:!0,ul:!0};function wsOptionsFor(type,preserveWhitespace,base){return null!=preserveWhitespace?(preserveWhitespace?1:0)|("full"===preserveWhitespace?2:0):type&&"pre"==type.whitespace?3:-5&base}var NodeContext=function NodeContext(type,attrs,marks,pendingMarks,solid,match,options){this.type=type,this.attrs=attrs,this.solid=solid,this.match=match||(4&options?null:type.contentMatch),this.options=options,this.content=[],this.marks=marks,this.activeMarks=Mark.none,this.pendingMarks=pendingMarks,this.stashMarks=[]};NodeContext.prototype.findWrapping=function findWrapping(node){if(!this.match){if(!this.type)return[];var fill=this.type.contentMatch.fillBefore(Fragment.from(node));if(!fill){var wrap,start=this.type.contentMatch;return(wrap=start.findWrapping(node.type))?(this.match=start,wrap):null}this.match=this.type.contentMatch.matchFragment(fill)}return this.match.findWrapping(node.type)},NodeContext.prototype.finish=function finish(openEnd){if(!(1&this.options)){var m,last=this.content[this.content.length-1];last&&last.isText&&(m=/[ \t\r\n\u000c]+$/.exec(last.text))&&(last.text.length==m[0].length?this.content.pop():this.content[this.content.length-1]=last.withText(last.text.slice(0,last.text.length-m[0].length)))}var content=Fragment.from(this.content);return!openEnd&&this.match&&(content=content.append(this.match.fillBefore(Fragment.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content},NodeContext.prototype.popFromStashMark=function popFromStashMark(mark){for(var i=this.stashMarks.length-1;i>=0;i--)if(mark.eq(this.stashMarks[i]))return this.stashMarks.splice(i,1)[0]},NodeContext.prototype.applyPending=function applyPending(nextType){for(var i=0,pending=this.pendingMarks;i<pending.length;i++){var mark=pending[i];(this.type?this.type.allowsMarkType(mark.type):markMayApply(mark.type,nextType))&&!mark.isInSet(this.activeMarks)&&(this.activeMarks=mark.addToSet(this.activeMarks),this.pendingMarks=mark.removeFromSet(this.pendingMarks))}},NodeContext.prototype.inlineContext=function inlineContext(node){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:node.parentNode&&!blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())};var ParseContext=function ParseContext(parser,options,open){this.parser=parser,this.options=options,this.isOpen=open;var topContext,topNode=options.topNode,topOptions=wsOptionsFor(null,options.preserveWhitespace,0)|(open?4:0);topContext=topNode?new NodeContext(topNode.type,topNode.attrs,Mark.none,Mark.none,!0,options.topMatch||topNode.type.contentMatch,topOptions):new NodeContext(open?null:parser.schema.topNodeType,null,Mark.none,Mark.none,!0,null,topOptions),this.nodes=[topContext],this.open=0,this.find=options.findPositions,this.needsBlock=!1},prototypeAccessors$6={top:{configurable:!0},currentPos:{configurable:!0}};function matches(dom,selector){return(dom.matches||dom.msMatchesSelector||dom.webkitMatchesSelector||dom.mozMatchesSelector).call(dom,selector)}function copy(obj){var copy={};for(var prop in obj)copy[prop]=obj[prop];return copy}function markMayApply(markType,nodeType){var nodes=nodeType.schema.nodes,loop=function(name){var parent=nodes[name];if(parent.allowsMarkType(markType)){var seen=[],scan=function(match){seen.push(match);for(var i=0;i<match.edgeCount;i++){var ref=match.edge(i),type=ref.type,next=ref.next;if(type==nodeType)return!0;if(seen.indexOf(next)<0&&scan(next))return!0}};return scan(parent.contentMatch)?{v:!0}:void 0}};for(var name in nodes){var returned=loop(name);if(returned)return returned.v}}prototypeAccessors$6.top.get=function(){return this.nodes[this.open]},ParseContext.prototype.addDOM=function addDOM(dom){if(3==dom.nodeType)this.addTextNode(dom);else if(1==dom.nodeType){var style=dom.getAttribute("style"),marks=style?this.readStyles(function parseStyles(style){var m,re=/\s*([\w-]+)\s*:\s*([^;]+)/g,result=[];for(;m=re.exec(style);)result.push(m[1],m[2].trim());return result}(style)):null,top=this.top;if(null!=marks)for(var i=0;i<marks.length;i++)this.addPendingMark(marks[i]);if(this.addElement(dom),null!=marks)for(var i$1=0;i$1<marks.length;i$1++)this.removePendingMark(marks[i$1],top)}},ParseContext.prototype.addTextNode=function addTextNode(dom){var value=dom.nodeValue,top=this.top;if(2&top.options||top.inlineContext(dom)||/[^ \t\r\n\u000c]/.test(value)){if(1&top.options)value=2&top.options?value.replace(/\r\n?/g,"\n"):value.replace(/\r?\n|\r/g," ");else if(value=value.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(value)&&this.open==this.nodes.length-1){var nodeBefore=top.content[top.content.length-1],domNodeBefore=dom.previousSibling;(!nodeBefore||domNodeBefore&&"BR"==domNodeBefore.nodeName||nodeBefore.isText&&/[ \t\r\n\u000c]$/.test(nodeBefore.text))&&(value=value.slice(1))}value&&this.insertNode(this.parser.schema.text(value)),this.findInText(dom)}else this.findInside(dom)},ParseContext.prototype.addElement=function addElement(dom,matchAfter){var ruleID,name=dom.nodeName.toLowerCase();listTags.hasOwnProperty(name)&&this.parser.normalizeLists&&function normalizeList(dom){for(var child=dom.firstChild,prevItem=null;child;child=child.nextSibling){var name=1==child.nodeType?child.nodeName.toLowerCase():null;name&&listTags.hasOwnProperty(name)&&prevItem?(prevItem.appendChild(child),child=prevItem):"li"==name?prevItem=child:name&&(prevItem=null)}}(dom);var rule=this.options.ruleFromNode&&this.options.ruleFromNode(dom)||(ruleID=this.parser.matchTag(dom,this,matchAfter));if(rule?rule.ignore:ignoreTags.hasOwnProperty(name))this.findInside(dom),this.ignoreFallback(dom);else if(!rule||rule.skip||rule.closeParent){rule&&rule.closeParent?this.open=Math.max(0,this.open-1):rule&&rule.skip.nodeType&&(dom=rule.skip);var sync,top=this.top,oldNeedsBlock=this.needsBlock;if(blockTags.hasOwnProperty(name))sync=!0,top.type||(this.needsBlock=!0);else if(!dom.firstChild)return void this.leafFallback(dom);this.addAll(dom),sync&&this.sync(top),this.needsBlock=oldNeedsBlock}else this.addElementByRule(dom,rule,!1===rule.consuming?ruleID:null)},ParseContext.prototype.leafFallback=function leafFallback(dom){"BR"==dom.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(dom.ownerDocument.createTextNode("\n"))},ParseContext.prototype.ignoreFallback=function ignoreFallback(dom){"BR"!=dom.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},ParseContext.prototype.readStyles=function readStyles(styles){var marks=Mark.none;style:for(var i=0;i<styles.length;i+=2)for(var after=null;;){var rule=this.parser.matchStyle(styles[i],styles[i+1],this,after);if(!rule)continue style;if(rule.ignore)return null;if(marks=this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks),!1!==rule.consuming)break;after=rule}return marks},ParseContext.prototype.addElementByRule=function addElementByRule(dom,rule,continueAfter){var sync,nodeType,mark,this$1=this;rule.node?(nodeType=this.parser.schema.nodes[rule.node]).isLeaf?this.insertNode(nodeType.create(rule.attrs))||this.leafFallback(dom):sync=this.enter(nodeType,rule.attrs,rule.preserveWhitespace):(mark=this.parser.schema.marks[rule.mark].create(rule.attrs),this.addPendingMark(mark));var startIn=this.top;if(nodeType&&nodeType.isLeaf)this.findInside(dom);else if(continueAfter)this.addElement(dom,continueAfter);else if(rule.getContent)this.findInside(dom),rule.getContent(dom,this.parser.schema).forEach((function(node){return this$1.insertNode(node)}));else{var contentDOM=rule.contentElement;"string"==typeof contentDOM?contentDOM=dom.querySelector(contentDOM):"function"==typeof contentDOM&&(contentDOM=contentDOM(dom)),contentDOM||(contentDOM=dom),this.findAround(dom,contentDOM,!0),this.addAll(contentDOM,sync)}sync&&(this.sync(startIn),this.open--),mark&&this.removePendingMark(mark,startIn)},ParseContext.prototype.addAll=function addAll(parent,sync,startIndex,endIndex){for(var index=startIndex||0,dom=startIndex?parent.childNodes[startIndex]:parent.firstChild,end=null==endIndex?null:parent.childNodes[endIndex];dom!=end;dom=dom.nextSibling,++index)this.findAtPoint(parent,index),this.addDOM(dom),sync&&blockTags.hasOwnProperty(dom.nodeName.toLowerCase())&&this.sync(sync);this.findAtPoint(parent,index)},ParseContext.prototype.findPlace=function findPlace(node){for(var route,sync,depth=this.open;depth>=0;depth--){var cx=this.nodes[depth],found=cx.findWrapping(node);if(found&&(!route||route.length>found.length)&&(route=found,sync=cx,!found.length))break;if(cx.solid)break}if(!route)return!1;this.sync(sync);for(var i=0;i<route.length;i++)this.enterInner(route[i],null,!1);return!0},ParseContext.prototype.insertNode=function insertNode(node){if(node.isInline&&this.needsBlock&&!this.top.type){var block=this.textblockFromContext();block&&this.enterInner(block)}if(this.findPlace(node)){this.closeExtra();var top=this.top;top.applyPending(node.type),top.match&&(top.match=top.match.matchType(node.type));for(var marks=top.activeMarks,i=0;i<node.marks.length;i++)top.type&&!top.type.allowsMarkType(node.marks[i].type)||(marks=node.marks[i].addToSet(marks));return top.content.push(node.mark(marks)),!0}return!1},ParseContext.prototype.enter=function enter(type,attrs,preserveWS){var ok=this.findPlace(type.create(attrs));return ok&&this.enterInner(type,attrs,!0,preserveWS),ok},ParseContext.prototype.enterInner=function enterInner(type,attrs,solid,preserveWS){this.closeExtra();var top=this.top;top.applyPending(type),top.match=top.match&&top.match.matchType(type,attrs);var options=wsOptionsFor(type,preserveWS,top.options);4&top.options&&0==top.content.length&&(options|=4),this.nodes.push(new NodeContext(type,attrs,top.activeMarks,top.pendingMarks,solid,null,options)),this.open++},ParseContext.prototype.closeExtra=function closeExtra(openEnd){var i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(openEnd));this.nodes.length=this.open+1}},ParseContext.prototype.finish=function finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ParseContext.prototype.sync=function sync(to){for(var i=this.open;i>=0;i--)if(this.nodes[i]==to)return void(this.open=i)},prototypeAccessors$6.currentPos.get=function(){this.closeExtra();for(var pos=0,i=this.open;i>=0;i--){for(var content=this.nodes[i].content,j=content.length-1;j>=0;j--)pos+=content[j].nodeSize;i&&pos++}return pos},ParseContext.prototype.findAtPoint=function findAtPoint(parent,offset){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==parent&&this.find[i].offset==offset&&(this.find[i].pos=this.currentPos)},ParseContext.prototype.findInside=function findInside(parent){if(this.find)for(var i=0;i<this.find.length;i++)null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)},ParseContext.prototype.findAround=function findAround(parent,content,before){if(parent!=content&&this.find)for(var i=0;i<this.find.length;i++){if(null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node))content.compareDocumentPosition(this.find[i].node)&(before?2:4)&&(this.find[i].pos=this.currentPos)}},ParseContext.prototype.findInText=function findInText(textNode){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==textNode&&(this.find[i].pos=this.currentPos-(textNode.nodeValue.length-this.find[i].offset))},ParseContext.prototype.matchesContext=function matchesContext(context){var this$1=this;if(context.indexOf("|")>-1)return context.split(/\s*\|\s*/).some(this.matchesContext,this);var parts=context.split("/"),option=this.options.context,useRoot=!(this.isOpen||option&&option.parent.type!=this.nodes[0].type),minDepth=-(option?option.depth+1:0)+(useRoot?0:1),match=function(i,depth){for(;i>=0;i--){var part=parts[i];if(""==part){if(i==parts.length-1||0==i)continue;for(;depth>=minDepth;depth--)if(match(i-1,depth))return!0;return!1}var next=depth>0||0==depth&&useRoot?this$1.nodes[depth].type:option&&depth>=minDepth?option.node(depth-minDepth).type:null;if(!next||next.name!=part&&-1==next.groups.indexOf(part))return!1;depth--}return!0};return match(parts.length-1,this.open)},ParseContext.prototype.textblockFromContext=function textblockFromContext(){var $context=this.options.context;if($context)for(var d=$context.depth;d>=0;d--){var deflt=$context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;if(deflt&&deflt.isTextblock&&deflt.defaultAttrs)return deflt}for(var name in this.parser.schema.nodes){var type=this.parser.schema.nodes[name];if(type.isTextblock&&type.defaultAttrs)return type}},ParseContext.prototype.addPendingMark=function addPendingMark(mark){var found=function findSameMarkInSet(mark,set){for(var i=0;i<set.length;i++)if(mark.eq(set[i]))return set[i]}(mark,this.top.pendingMarks);found&&this.top.stashMarks.push(found),this.top.pendingMarks=mark.addToSet(this.top.pendingMarks)},ParseContext.prototype.removePendingMark=function removePendingMark(mark,upto){for(var depth=this.open;depth>=0;depth--){var level=this.nodes[depth];if(level.pendingMarks.lastIndexOf(mark)>-1)level.pendingMarks=mark.removeFromSet(level.pendingMarks);else{level.activeMarks=mark.removeFromSet(level.activeMarks);var stashMark=level.popFromStashMark(mark);stashMark&&level.type&&level.type.allowsMarkType(stashMark.type)&&(level.activeMarks=stashMark.addToSet(level.activeMarks))}if(level==upto)break}},Object.defineProperties(ParseContext.prototype,prototypeAccessors$6);var DOMSerializer=function DOMSerializer(nodes,marks){this.nodes=nodes||{},this.marks=marks||{}};function gatherToDOM(obj){var result={};for(var name in obj){var toDOM=obj[name].spec.toDOM;toDOM&&(result[name]=toDOM)}return result}function doc(options){return options.document||window.document}DOMSerializer.prototype.serializeFragment=function serializeFragment(fragment,options,target){var this$1=this;void 0===options&&(options={}),target||(target=doc(options).createDocumentFragment());var top=target,active=null;return fragment.forEach((function(node){if(active||node.marks.length){active||(active=[]);for(var keep=0,rendered=0;keep<active.length&&rendered<node.marks.length;){var next=node.marks[rendered];if(this$1.marks[next.type.name]){if(!next.eq(active[keep])||!1===next.type.spec.spanning)break;keep+=2,rendered++}else rendered++}for(;keep<active.length;)top=active.pop(),active.pop();for(;rendered<node.marks.length;){var add=node.marks[rendered++],markDOM=this$1.serializeMark(add,node.isInline,options);markDOM&&(active.push(add,top),top.appendChild(markDOM.dom),top=markDOM.contentDOM||markDOM.dom)}}top.appendChild(this$1.serializeNodeInner(node,options))})),target},DOMSerializer.prototype.serializeNodeInner=function serializeNodeInner(node,options){void 0===options&&(options={});var ref=DOMSerializer.renderSpec(doc(options),this.nodes[node.type.name](node)),dom=ref.dom,contentDOM=ref.contentDOM;if(contentDOM){if(node.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");options.onContent?options.onContent(node,contentDOM,options):this.serializeFragment(node.content,options,contentDOM)}return dom},DOMSerializer.prototype.serializeNode=function serializeNode(node,options){void 0===options&&(options={});for(var dom=this.serializeNodeInner(node,options),i=node.marks.length-1;i>=0;i--){var wrap=this.serializeMark(node.marks[i],node.isInline,options);wrap&&((wrap.contentDOM||wrap.dom).appendChild(dom),dom=wrap.dom)}return dom},DOMSerializer.prototype.serializeMark=function serializeMark(mark,inline,options){void 0===options&&(options={});var toDOM=this.marks[mark.type.name];return toDOM&&DOMSerializer.renderSpec(doc(options),toDOM(mark,inline))},DOMSerializer.renderSpec=function renderSpec(doc,structure,xmlNS){if(void 0===xmlNS&&(xmlNS=null),"string"==typeof structure)return{dom:doc.createTextNode(structure)};if(null!=structure.nodeType)return{dom:structure};if(structure.dom&&null!=structure.dom.nodeType)return structure;var tagName=structure[0],space=tagName.indexOf(" ");space>0&&(xmlNS=tagName.slice(0,space),tagName=tagName.slice(space+1));var contentDOM=null,dom=xmlNS?doc.createElementNS(xmlNS,tagName):doc.createElement(tagName),attrs=structure[1],start=1;if(attrs&&"object"==typeof attrs&&null==attrs.nodeType&&!Array.isArray(attrs))for(var name in start=2,attrs)if(null!=attrs[name]){var space$1=name.indexOf(" ");space$1>0?dom.setAttributeNS(name.slice(0,space$1),name.slice(space$1+1),attrs[name]):dom.setAttribute(name,attrs[name])}for(var i=start;i<structure.length;i++){var child=structure[i];if(0===child){if(i<structure.length-1||i>start)throw new RangeError("Content hole must be the only child of its parent node");return{dom:dom,contentDOM:dom}}var ref=DOMSerializer.renderSpec(doc,child,xmlNS),inner=ref.dom,innerContent=ref.contentDOM;if(dom.appendChild(inner),innerContent){if(contentDOM)throw new RangeError("Multiple content holes");contentDOM=innerContent}}return{dom:dom,contentDOM:contentDOM}},DOMSerializer.fromSchema=function fromSchema(schema){return schema.cached.domSerializer||(schema.cached.domSerializer=new DOMSerializer(this.nodesFromSchema(schema),this.marksFromSchema(schema)))},DOMSerializer.nodesFromSchema=function nodesFromSchema(schema){var result=gatherToDOM(schema.nodes);return result.text||(result.text=function(node){return node.text}),result},DOMSerializer.marksFromSchema=function marksFromSchema(schema){return gatherToDOM(schema.marks)}},3585:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Decoration})),__webpack_require__.d(__webpack_exports__,"b",(function(){return DecorationSet})),__webpack_require__.d(__webpack_exports__,"c",(function(){return EditorView}));var prosemirror_state__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2686),prosemirror_model__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3057),prosemirror_transform__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2892),result={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var ie_edge=/Edge\/(\d+)/.exec(navigator.userAgent),ie_upto10=/MSIE \d/.test(navigator.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ie=result.ie=!!(ie_upto10||ie_11up||ie_edge);result.ie_version=ie_upto10?document.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:null,result.gecko=!ie&&/gecko\/(\d+)/i.test(navigator.userAgent),result.gecko_version=result.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var chrome=!ie&&/Chrome\/(\d+)/.exec(navigator.userAgent);result.chrome=!!chrome,result.chrome_version=chrome&&+chrome[1],result.safari=!ie&&/Apple Computer/.test(navigator.vendor),result.ios=result.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),result.mac=result.ios||/Mac/.test(navigator.platform),result.android=/Android \d/.test(navigator.userAgent),result.webkit="webkitFontSmoothing"in document.documentElement.style,result.webkit_version=result.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var domIndex=function(node){for(var index=0;;index++)if(!(node=node.previousSibling))return index},parentNode=function(node){var parent=node.assignedSlot||node.parentNode;return parent&&11==parent.nodeType?parent.host:parent},reusedRange=null,textRange=function(node,from,to){var range=reusedRange||(reusedRange=document.createRange());return range.setEnd(node,null==to?node.nodeValue.length:to),range.setStart(node,from||0),range},isEquivalentPosition=function(node,off,targetNode,targetOff){return targetNode&&(scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1))},atomElements=/^(img|br|input|textarea|hr)$/i;function scanFor(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return!0;if(off==(dir<0?0:nodeSize(node))){var parent=node.parentNode;if(1!=parent.nodeType||hasBlockDesc(node)||atomElements.test(node.nodeName)||"false"==node.contentEditable)return!1;off=domIndex(node)+(dir<0?0:1),node=parent}else{if(1!=node.nodeType)return!1;if("false"==(node=node.childNodes[off+(dir<0?-1:0)]).contentEditable)return!1;off=dir<0?nodeSize(node):0}}}function nodeSize(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function hasBlockDesc(dom){for(var desc,cur=dom;cur&&!(desc=cur.pmViewDesc);cur=cur.parentNode);return desc&&desc.node&&desc.node.isBlock&&(desc.dom==dom||desc.contentDOM==dom)}var selectionCollapsed=function(domSel){var collapsed=domSel.isCollapsed;return collapsed&&result.chrome&&domSel.rangeCount&&!domSel.getRangeAt(0).collapsed&&(collapsed=!1),collapsed};function keyEvent(keyCode,key){var event=document.createEvent("Event");return event.initEvent("keydown",!0,!0),event.keyCode=keyCode,event.key=event.code=key,event}function windowRect(doc){return{left:0,right:doc.documentElement.clientWidth,top:0,bottom:doc.documentElement.clientHeight}}function getSide(value,side){return"number"==typeof value?value:value[side]}function clientRect(node){var rect=node.getBoundingClientRect(),scaleX=rect.width/node.offsetWidth||1,scaleY=rect.height/node.offsetHeight||1;return{left:rect.left,right:rect.left+node.clientWidth*scaleX,top:rect.top,bottom:rect.top+node.clientHeight*scaleY}}function scrollRectIntoView(view,rect,startDOM){for(var scrollThreshold=view.someProp("scrollThreshold")||0,scrollMargin=view.someProp("scrollMargin")||5,doc=view.dom.ownerDocument,parent=startDOM||view.dom;parent;parent=parentNode(parent))if(1==parent.nodeType){var atTop=parent==doc.body||1!=parent.nodeType,bounding=atTop?windowRect(doc):clientRect(parent),moveX=0,moveY=0;if(rect.top<bounding.top+getSide(scrollThreshold,"top")?moveY=-(bounding.top-rect.top+getSide(scrollMargin,"top")):rect.bottom>bounding.bottom-getSide(scrollThreshold,"bottom")&&(moveY=rect.bottom-bounding.bottom+getSide(scrollMargin,"bottom")),rect.left<bounding.left+getSide(scrollThreshold,"left")?moveX=-(bounding.left-rect.left+getSide(scrollMargin,"left")):rect.right>bounding.right-getSide(scrollThreshold,"right")&&(moveX=rect.right-bounding.right+getSide(scrollMargin,"right")),moveX||moveY)if(atTop)doc.defaultView.scrollBy(moveX,moveY);else{var startX=parent.scrollLeft,startY=parent.scrollTop;moveY&&(parent.scrollTop+=moveY),moveX&&(parent.scrollLeft+=moveX);var dX=parent.scrollLeft-startX,dY=parent.scrollTop-startY;rect={left:rect.left-dX,top:rect.top-dY,right:rect.right-dX,bottom:rect.bottom-dY}}if(atTop)break}}function scrollStack(dom){for(var stack=[],doc=dom.ownerDocument;dom&&(stack.push({dom:dom,top:dom.scrollTop,left:dom.scrollLeft}),dom!=doc);dom=parentNode(dom));return stack}function restoreScrollStack(stack,dTop){for(var i=0;i<stack.length;i++){var ref=stack[i],dom=ref.dom,top=ref.top,left=ref.left;dom.scrollTop!=top+dTop&&(dom.scrollTop=top+dTop),dom.scrollLeft!=left&&(dom.scrollLeft=left)}}var preventScrollSupported=null;function findOffsetInNode(node,coords){for(var closest,coordsClosest,dxClosest=2e8,offset=0,rowBot=coords.top,rowTop=coords.top,child=node.firstChild,childIndex=0;child;child=child.nextSibling,childIndex++){var rects=void 0;if(1==child.nodeType)rects=child.getClientRects();else{if(3!=child.nodeType)continue;rects=textRange(child).getClientRects()}for(var i=0;i<rects.length;i++){var rect=rects[i];if(rect.top<=rowBot&&rect.bottom>=rowTop){rowBot=Math.max(rect.bottom,rowBot),rowTop=Math.min(rect.top,rowTop);var dx=rect.left>coords.left?rect.left-coords.left:rect.right<coords.left?coords.left-rect.right:0;if(dx<dxClosest){closest=child,dxClosest=dx,coordsClosest=dx&&3==closest.nodeType?{left:rect.right<coords.left?rect.right:rect.left,top:coords.top}:coords,1==child.nodeType&&dx&&(offset=childIndex+(coords.left>=(rect.left+rect.right)/2?1:0));continue}}!closest&&(coords.left>=rect.right&&coords.top>=rect.top||coords.left>=rect.left&&coords.top>=rect.bottom)&&(offset=childIndex+1)}}return closest&&3==closest.nodeType?function findOffsetInText(node,coords){for(var len=node.nodeValue.length,range=document.createRange(),i=0;i<len;i++){range.setEnd(node,i+1),range.setStart(node,i);var rect=singleRect(range,1);if(rect.top!=rect.bottom&&inRect(coords,rect))return{node:node,offset:i+(coords.left>=(rect.left+rect.right)/2?1:0)}}return{node:node,offset:0}}(closest,coordsClosest):!closest||dxClosest&&1==closest.nodeType?{node:node,offset:offset}:findOffsetInNode(closest,coordsClosest)}function inRect(coords,rect){return coords.left>=rect.left-1&&coords.left<=rect.right+1&&coords.top>=rect.top-1&&coords.top<=rect.bottom+1}function elementFromPoint(element,coords,box){var len=element.childNodes.length;if(len&&box.top<box.bottom)for(var startI=Math.max(0,Math.min(len-1,Math.floor(len*(coords.top-box.top)/(box.bottom-box.top))-2)),i=startI;;){var child=element.childNodes[i];if(1==child.nodeType)for(var rects=child.getClientRects(),j=0;j<rects.length;j++){var rect=rects[j];if(inRect(coords,rect))return elementFromPoint(child,coords,rect)}if((i=(i+1)%len)==startI)break}return element}function posAtCoords(view,coords){var assign,assign$1,node,offset,doc=view.dom.ownerDocument;if(doc.caretPositionFromPoint)try{var pos$1=doc.caretPositionFromPoint(coords.left,coords.top);pos$1&&(node=(assign=pos$1).offsetNode,offset=assign.offset)}catch(_){}if(!node&&doc.caretRangeFromPoint){var range=doc.caretRangeFromPoint(coords.left,coords.top);range&&(node=(assign$1=range).startContainer,offset=assign$1.startOffset)}var pos,elt=(view.root.elementFromPoint?view.root:doc).elementFromPoint(coords.left,coords.top+1);if(!elt||!view.dom.contains(1!=elt.nodeType?elt.parentNode:elt)){var box=view.dom.getBoundingClientRect();if(!inRect(coords,box))return null;if(!(elt=elementFromPoint(view.dom,coords,box)))return null}if(result.safari)for(var p=elt;node&&p;p=parentNode(p))p.draggable&&(node=offset=null);if(elt=function targetKludge(dom,coords){var parent=dom.parentNode;return parent&&/^li$/i.test(parent.nodeName)&&coords.left<dom.getBoundingClientRect().left?parent:dom}(elt,coords),node){if(result.gecko&&1==node.nodeType&&(offset=Math.min(offset,node.childNodes.length))<node.childNodes.length){var box$1,next=node.childNodes[offset];"IMG"==next.nodeName&&(box$1=next.getBoundingClientRect()).right<=coords.left&&box$1.bottom>coords.top&&offset++}node==view.dom&&offset==node.childNodes.length-1&&1==node.lastChild.nodeType&&coords.top>node.lastChild.getBoundingClientRect().bottom?pos=view.state.doc.content.size:0!=offset&&1==node.nodeType&&"BR"==node.childNodes[offset-1].nodeName||(pos=function posFromCaret(view,node,offset,coords){for(var outside=-1,cur=node;cur!=view.dom;){var desc=view.docView.nearestDesc(cur,!0);if(!desc)return null;if(desc.node.isBlock&&desc.parent){var rect=desc.dom.getBoundingClientRect();if(rect.left>coords.left||rect.top>coords.top)outside=desc.posBefore;else{if(!(rect.right<coords.left||rect.bottom<coords.top))break;outside=desc.posAfter}}cur=desc.dom.parentNode}return outside>-1?outside:view.docView.posFromDOM(node,offset)}(view,node,offset,coords))}null==pos&&(pos=function posFromElement(view,elt,coords){var ref=findOffsetInNode(elt,coords),node=ref.node,offset=ref.offset,bias=-1;if(1==node.nodeType&&!node.firstChild){var rect=node.getBoundingClientRect();bias=rect.left!=rect.right&&coords.left>(rect.left+rect.right)/2?1:-1}return view.docView.posFromDOM(node,offset,bias)}(view,elt,coords));var desc=view.docView.nearestDesc(elt,!0);return{pos:pos,inside:desc?desc.posAtStart-desc.border:-1}}function singleRect(object,bias){var rects=object.getClientRects();return rects.length?rects[bias<0?0:rects.length-1]:object.getBoundingClientRect()}var BIDI=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function coordsAtPos(view,pos,side){var ref=view.docView.domFromPos(pos,side<0?-1:1),node=ref.node,offset=ref.offset,supportEmptyRange=result.webkit||result.gecko;if(3==node.nodeType){if(!supportEmptyRange||!BIDI.test(node.nodeValue)&&(side<0?offset:offset!=node.nodeValue.length)){var from=offset,to=offset,takeSide=side<0?1:-1;return side<0&&!offset?(to++,takeSide=-1):side>=0&&offset==node.nodeValue.length?(from--,takeSide=1):side<0?from--:to++,flattenV(singleRect(textRange(node,from,to),takeSide),takeSide<0)}var rect=singleRect(textRange(node,offset,offset),side);if(result.gecko&&offset&&/\s/.test(node.nodeValue[offset-1])&&offset<node.nodeValue.length){var rectBefore=singleRect(textRange(node,offset-1,offset-1),-1);if(rectBefore.top==rect.top){var rectAfter=singleRect(textRange(node,offset,offset+1),-1);if(rectAfter.top!=rect.top)return flattenV(rectAfter,rectAfter.left<rectBefore.left)}}return rect}if(!view.state.doc.resolve(pos).parent.inlineContent){if(offset&&(side<0||offset==nodeSize(node))){var before=node.childNodes[offset-1];if(1==before.nodeType)return flattenH(before.getBoundingClientRect(),!1)}if(offset<nodeSize(node)){var after=node.childNodes[offset];if(1==after.nodeType)return flattenH(after.getBoundingClientRect(),!0)}return flattenH(node.getBoundingClientRect(),side>=0)}if(offset&&(side<0||offset==nodeSize(node))){var before$1=node.childNodes[offset-1],target=3==before$1.nodeType?textRange(before$1,nodeSize(before$1)-(supportEmptyRange?0:1)):1!=before$1.nodeType||"BR"==before$1.nodeName&&before$1.nextSibling?null:before$1;if(target)return flattenV(singleRect(target,1),!1)}if(offset<nodeSize(node)){for(var after$1=node.childNodes[offset];after$1.pmViewDesc&&after$1.pmViewDesc.ignoreForCoords;)after$1=after$1.nextSibling;var target$1=after$1?3==after$1.nodeType?textRange(after$1,0,supportEmptyRange?0:1):1==after$1.nodeType?after$1:null:null;if(target$1)return flattenV(singleRect(target$1,-1),!0)}return flattenV(singleRect(3==node.nodeType?textRange(node):node,-side),side>=0)}function flattenV(rect,left){if(0==rect.width)return rect;var x=left?rect.left:rect.right;return{top:rect.top,bottom:rect.bottom,left:x,right:x}}function flattenH(rect,top){if(0==rect.height)return rect;var y=top?rect.top:rect.bottom;return{top:y,bottom:y,left:rect.left,right:rect.right}}function withFlushedState(view,state,f){var viewState=view.state,active=view.root.activeElement;viewState!=state&&view.updateState(state),active!=view.dom&&view.focus();try{return f()}finally{viewState!=state&&view.updateState(viewState),active!=view.dom&&active&&active.focus()}}var maybeRTL=/[\u0590-\u08ac]/;var cachedState=null,cachedDir=null,cachedResult=!1;function endOfTextblock(view,state,dir){return cachedState==state&&cachedDir==dir?cachedResult:(cachedState=state,cachedDir=dir,cachedResult="up"==dir||"down"==dir?function endOfTextblockVertical(view,state,dir){var sel=state.selection,$pos="up"==dir?sel.$from:sel.$to;return withFlushedState(view,state,(function(){for(var dom=view.docView.domFromPos($pos.pos,"up"==dir?-1:1).node;;){var nearest=view.docView.nearestDesc(dom,!0);if(!nearest)break;if(nearest.node.isBlock){dom=nearest.dom;break}dom=nearest.dom.parentNode}for(var coords=coordsAtPos(view,$pos.pos,1),child=dom.firstChild;child;child=child.nextSibling){var boxes=void 0;if(1==child.nodeType)boxes=child.getClientRects();else{if(3!=child.nodeType)continue;boxes=textRange(child,0,child.nodeValue.length).getClientRects()}for(var i=0;i<boxes.length;i++){var box=boxes[i];if(box.bottom>box.top+1&&("up"==dir?coords.top-box.top>2*(box.bottom-coords.top):box.bottom-coords.bottom>2*(coords.bottom-box.top)))return!1}}return!0}))}(view,state,dir):function endOfTextblockHorizontal(view,state,dir){var $head=state.selection.$head;if(!$head.parent.isTextblock)return!1;var offset=$head.parentOffset,atStart=!offset,atEnd=offset==$head.parent.content.size,sel=view.root.getSelection();return maybeRTL.test($head.parent.textContent)&&sel.modify?withFlushedState(view,state,(function(){var oldRange=sel.getRangeAt(0),oldNode=sel.focusNode,oldOff=sel.focusOffset,oldBidiLevel=sel.caretBidiLevel;sel.modify("move",dir,"character");var result=!($head.depth?view.docView.domAfterPos($head.before()):view.dom).contains(1==sel.focusNode.nodeType?sel.focusNode:sel.focusNode.parentNode)||oldNode==sel.focusNode&&oldOff==sel.focusOffset;return sel.removeAllRanges(),sel.addRange(oldRange),null!=oldBidiLevel&&(sel.caretBidiLevel=oldBidiLevel),result})):"left"==dir||"backward"==dir?atStart:atEnd}(view,state,dir))}var ViewDesc=function ViewDesc(parent,children,dom,contentDOM){this.parent=parent,this.children=children,this.dom=dom,dom.pmViewDesc=this,this.contentDOM=contentDOM,this.dirty=0},prototypeAccessors={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};ViewDesc.prototype.matchesWidget=function matchesWidget(){return!1},ViewDesc.prototype.matchesMark=function matchesMark(){return!1},ViewDesc.prototype.matchesNode=function matchesNode(){return!1},ViewDesc.prototype.matchesHack=function matchesHack(_nodeName){return!1},ViewDesc.prototype.parseRule=function parseRule(){return null},ViewDesc.prototype.stopEvent=function stopEvent(){return!1},prototypeAccessors.size.get=function(){for(var size=0,i=0;i<this.children.length;i++)size+=this.children[i].size;return size},prototypeAccessors.border.get=function(){return 0},ViewDesc.prototype.destroy=function destroy(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var i=0;i<this.children.length;i++)this.children[i].destroy()},ViewDesc.prototype.posBeforeChild=function posBeforeChild(child){for(var i=0,pos=this.posAtStart;i<this.children.length;i++){var cur=this.children[i];if(cur==child)return pos;pos+=cur.size}},prototypeAccessors.posBefore.get=function(){return this.parent.posBeforeChild(this)},prototypeAccessors.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},prototypeAccessors.posAfter.get=function(){return this.posBefore+this.size},prototypeAccessors.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},ViewDesc.prototype.localPosFromDOM=function localPosFromDOM(dom,offset,bias){if(this.contentDOM&&this.contentDOM.contains(1==dom.nodeType?dom:dom.parentNode)){if(bias<0){var domBefore,desc;if(dom==this.contentDOM)domBefore=dom.childNodes[offset-1];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domBefore=dom.previousSibling}for(;domBefore&&(!(desc=domBefore.pmViewDesc)||desc.parent!=this);)domBefore=domBefore.previousSibling;return domBefore?this.posBeforeChild(desc)+desc.size:this.posAtStart}var domAfter,desc$1;if(dom==this.contentDOM)domAfter=dom.childNodes[offset];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domAfter=dom.nextSibling}for(;domAfter&&(!(desc$1=domAfter.pmViewDesc)||desc$1.parent!=this);)domAfter=domAfter.nextSibling;return domAfter?this.posBeforeChild(desc$1):this.posAtEnd}var atEnd;if(dom==this.dom&&this.contentDOM)atEnd=offset>domIndex(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))atEnd=2&dom.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==offset)for(var search=dom;;search=search.parentNode){if(search==this.dom){atEnd=!1;break}if(search.parentNode.firstChild!=search)break}if(null==atEnd&&offset==dom.childNodes.length)for(var search$1=dom;;search$1=search$1.parentNode){if(search$1==this.dom){atEnd=!0;break}if(search$1.parentNode.lastChild!=search$1)break}}return(null==atEnd?bias>0:atEnd)?this.posAtEnd:this.posAtStart},ViewDesc.prototype.nearestDesc=function nearestDesc(dom,onlyNodes){for(var first=!0,cur=dom;cur;cur=cur.parentNode){var desc=this.getDesc(cur);if(desc&&(!onlyNodes||desc.node)){if(!first||!desc.nodeDOM||(1==desc.nodeDOM.nodeType?desc.nodeDOM.contains(1==dom.nodeType?dom:dom.parentNode):desc.nodeDOM==dom))return desc;first=!1}}},ViewDesc.prototype.getDesc=function getDesc(dom){for(var desc=dom.pmViewDesc,cur=desc;cur;cur=cur.parent)if(cur==this)return desc},ViewDesc.prototype.posFromDOM=function posFromDOM(dom,offset,bias){for(var scan=dom;scan;scan=scan.parentNode){var desc=this.getDesc(scan);if(desc)return desc.localPosFromDOM(dom,offset,bias)}return-1},ViewDesc.prototype.descAt=function descAt(pos){for(var i=0,offset=0;i<this.children.length;i++){var child=this.children[i],end=offset+child.size;if(offset==pos&&end!=offset){for(;!child.border&&child.children.length;)child=child.children[0];return child}if(pos<end)return child.descAt(pos-offset-child.border);offset=end}},ViewDesc.prototype.domFromPos=function domFromPos(pos,side){if(!this.contentDOM)return{node:this.dom,offset:0};for(var i=0,offset=0,curPos=0;i<this.children.length;i++){var child=this.children[i],end=curPos+child.size;if(end>pos||child instanceof TrailingHackViewDesc){offset=pos-curPos;break}curPos=end}if(offset)return this.children[i].domFromPos(offset-this.children[i].border,side);for(var prev=void 0;i&&!(prev=this.children[i-1]).size&&prev instanceof WidgetViewDesc&&prev.widget.type.side>=0;i--);if(side<=0){for(var prev$1,enter=!0;(prev$1=i?this.children[i-1]:null)&&prev$1.dom.parentNode!=this.contentDOM;i--,enter=!1);return prev$1&&side&&enter&&!prev$1.border&&!prev$1.domAtom?prev$1.domFromPos(prev$1.size,side):{node:this.contentDOM,offset:prev$1?domIndex(prev$1.dom)+1:0}}for(var next,enter$1=!0;(next=i<this.children.length?this.children[i]:null)&&next.dom.parentNode!=this.contentDOM;i++,enter$1=!1);return next&&enter$1&&!next.border&&!next.domAtom?next.domFromPos(0,side):{node:this.contentDOM,offset:next?domIndex(next.dom):this.contentDOM.childNodes.length}},ViewDesc.prototype.parseRange=function parseRange(from,to,base){if(void 0===base&&(base=0),0==this.children.length)return{node:this.contentDOM,from:from,to:to,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var fromOffset=-1,toOffset=-1,offset=base,i=0;;i++){var child=this.children[i],end=offset+child.size;if(-1==fromOffset&&from<=end){var childBase=offset+child.border;if(from>=childBase&&to<=end-child.border&&child.node&&child.contentDOM&&this.contentDOM.contains(child.contentDOM))return child.parseRange(from,to,childBase);from=offset;for(var j=i;j>0;j--){var prev=this.children[j-1];if(prev.size&&prev.dom.parentNode==this.contentDOM&&!prev.emptyChildAt(1)){fromOffset=domIndex(prev.dom)+1;break}from-=prev.size}-1==fromOffset&&(fromOffset=0)}if(fromOffset>-1&&(end>to||i==this.children.length-1)){to=end;for(var j$1=i+1;j$1<this.children.length;j$1++){var next=this.children[j$1];if(next.size&&next.dom.parentNode==this.contentDOM&&!next.emptyChildAt(-1)){toOffset=domIndex(next.dom);break}to+=next.size}-1==toOffset&&(toOffset=this.contentDOM.childNodes.length);break}offset=end}return{node:this.contentDOM,from:from,to:to,fromOffset:fromOffset,toOffset:toOffset}},ViewDesc.prototype.emptyChildAt=function emptyChildAt(side){if(this.border||!this.contentDOM||!this.children.length)return!1;var child=this.children[side<0?0:this.children.length-1];return 0==child.size||child.emptyChildAt(side)},ViewDesc.prototype.domAfterPos=function domAfterPos(pos){var ref=this.domFromPos(pos,0),node=ref.node,offset=ref.offset;if(1!=node.nodeType||offset==node.childNodes.length)throw new RangeError("No node after pos "+pos);return node.childNodes[offset]},ViewDesc.prototype.setSelection=function setSelection(anchor,head,root,force){for(var from=Math.min(anchor,head),to=Math.max(anchor,head),i=0,offset=0;i<this.children.length;i++){var child=this.children[i],end=offset+child.size;if(from>offset&&to<end)return child.setSelection(anchor-offset-child.border,head-offset-child.border,root,force);offset=end}var anchorDOM=this.domFromPos(anchor,anchor?-1:1),headDOM=head==anchor?anchorDOM:this.domFromPos(head,head?-1:1),domSel=root.getSelection(),brKludge=!1;if((result.gecko||result.safari)&&anchor==head){var node=anchorDOM.node,offset$1=anchorDOM.offset;if(3==node.nodeType){if((brKludge=offset$1&&"\n"==node.nodeValue[offset$1-1])&&offset$1==node.nodeValue.length)for(var scan=node,after=void 0;scan;scan=scan.parentNode){if(after=scan.nextSibling){"BR"==after.nodeName&&(anchorDOM=headDOM={node:after.parentNode,offset:domIndex(after)+1});break}var desc=scan.pmViewDesc;if(desc&&desc.node&&desc.node.isBlock)break}}else{var prev=node.childNodes[offset$1-1];brKludge=prev&&("BR"==prev.nodeName||"false"==prev.contentEditable)}}if(result.gecko&&domSel.focusNode&&domSel.focusNode!=headDOM.node&&1==domSel.focusNode.nodeType){var after$1=domSel.focusNode.childNodes[domSel.focusOffset];after$1&&"false"==after$1.contentEditable&&(force=!0)}if(force||brKludge&&result.safari||!isEquivalentPosition(anchorDOM.node,anchorDOM.offset,domSel.anchorNode,domSel.anchorOffset)||!isEquivalentPosition(headDOM.node,headDOM.offset,domSel.focusNode,domSel.focusOffset)){var domSelExtended=!1;if((domSel.extend||anchor==head)&&!brKludge){domSel.collapse(anchorDOM.node,anchorDOM.offset);try{anchor!=head&&domSel.extend(headDOM.node,headDOM.offset),domSelExtended=!0}catch(err){if(!(err instanceof DOMException))throw err}}if(!domSelExtended){if(anchor>head){var tmp=anchorDOM;anchorDOM=headDOM,headDOM=tmp}var range=document.createRange();range.setEnd(headDOM.node,headDOM.offset),range.setStart(anchorDOM.node,anchorDOM.offset),domSel.removeAllRanges(),domSel.addRange(range)}}},ViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return!this.contentDOM&&"selection"!=mutation.type},prototypeAccessors.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},ViewDesc.prototype.markDirty=function markDirty(from,to){for(var offset=0,i=0;i<this.children.length;i++){var child=this.children[i],end=offset+child.size;if(offset==end?from<=end&&to>=offset:from<end&&to>offset){var startInside=offset+child.border,endInside=end-child.border;if(from>=startInside&&to<=endInside)return this.dirty=from==offset||to==end?2:1,void(from!=startInside||to!=endInside||!child.contentLost&&child.dom.parentNode==this.contentDOM?child.markDirty(from-startInside,to-startInside):child.dirty=3);child.dirty=child.dom==child.contentDOM&&child.dom.parentNode==this.contentDOM?2:3}offset=end}this.dirty=2},ViewDesc.prototype.markParentsDirty=function markParentsDirty(){for(var level=1,node=this.parent;node;node=node.parent,level++){var dirty=1==level?2:1;node.dirty<dirty&&(node.dirty=dirty)}},prototypeAccessors.domAtom.get=function(){return!1},prototypeAccessors.ignoreForCoords.get=function(){return!1},Object.defineProperties(ViewDesc.prototype,prototypeAccessors);var nothing=[],WidgetViewDesc=function(ViewDesc){function WidgetViewDesc(parent,widget,view,pos){var self,dom=widget.type.toDOM;if("function"==typeof dom&&(dom=dom(view,(function(){return self?self.parent?self.parent.posBeforeChild(self):void 0:pos}))),!widget.type.spec.raw){if(1!=dom.nodeType){var wrap=document.createElement("span");wrap.appendChild(dom),dom=wrap}dom.contentEditable=!1,dom.classList.add("ProseMirror-widget")}ViewDesc.call(this,parent,nothing,dom,null),this.widget=widget,self=this}ViewDesc&&(WidgetViewDesc.__proto__=ViewDesc),WidgetViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),WidgetViewDesc.prototype.constructor=WidgetViewDesc;var prototypeAccessors$1={domAtom:{configurable:!0}};return WidgetViewDesc.prototype.matchesWidget=function matchesWidget(widget){return 0==this.dirty&&widget.type.eq(this.widget.type)},WidgetViewDesc.prototype.parseRule=function parseRule(){return{ignore:!0}},WidgetViewDesc.prototype.stopEvent=function stopEvent(event){var stop=this.widget.spec.stopEvent;return!!stop&&stop(event)},WidgetViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return"selection"!=mutation.type||this.widget.spec.ignoreSelection},WidgetViewDesc.prototype.destroy=function destroy(){this.widget.type.destroy(this.dom),ViewDesc.prototype.destroy.call(this)},prototypeAccessors$1.domAtom.get=function(){return!0},Object.defineProperties(WidgetViewDesc.prototype,prototypeAccessors$1),WidgetViewDesc}(ViewDesc),CompositionViewDesc=function(ViewDesc){function CompositionViewDesc(parent,dom,textDOM,text){ViewDesc.call(this,parent,nothing,dom,null),this.textDOM=textDOM,this.text=text}ViewDesc&&(CompositionViewDesc.__proto__=ViewDesc),CompositionViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),CompositionViewDesc.prototype.constructor=CompositionViewDesc;var prototypeAccessors$2={size:{configurable:!0}};return prototypeAccessors$2.size.get=function(){return this.text.length},CompositionViewDesc.prototype.localPosFromDOM=function localPosFromDOM(dom,offset){return dom!=this.textDOM?this.posAtStart+(offset?this.size:0):this.posAtStart+offset},CompositionViewDesc.prototype.domFromPos=function domFromPos(pos){return{node:this.textDOM,offset:pos}},CompositionViewDesc.prototype.ignoreMutation=function ignoreMutation(mut){return"characterData"===mut.type&&mut.target.nodeValue==mut.oldValue},Object.defineProperties(CompositionViewDesc.prototype,prototypeAccessors$2),CompositionViewDesc}(ViewDesc),MarkViewDesc=function(ViewDesc){function MarkViewDesc(parent,mark,dom,contentDOM){ViewDesc.call(this,parent,[],dom,contentDOM),this.mark=mark}return ViewDesc&&(MarkViewDesc.__proto__=ViewDesc),MarkViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),MarkViewDesc.prototype.constructor=MarkViewDesc,MarkViewDesc.create=function create(parent,mark,inline,view){var custom=view.nodeViews[mark.type.name],spec=custom&&custom(mark,view,inline);return spec&&spec.dom||(spec=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.b.renderSpec(document,mark.type.spec.toDOM(mark,inline))),new MarkViewDesc(parent,mark,spec.dom,spec.contentDOM||spec.dom)},MarkViewDesc.prototype.parseRule=function parseRule(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},MarkViewDesc.prototype.matchesMark=function matchesMark(mark){return 3!=this.dirty&&this.mark.eq(mark)},MarkViewDesc.prototype.markDirty=function markDirty(from,to){if(ViewDesc.prototype.markDirty.call(this,from,to),0!=this.dirty){for(var parent=this.parent;!parent.node;)parent=parent.parent;parent.dirty<this.dirty&&(parent.dirty=this.dirty),this.dirty=0}},MarkViewDesc.prototype.slice=function slice(from,to,view){var copy=MarkViewDesc.create(this.parent,this.mark,!0,view),nodes=this.children,size=this.size;to<size&&(nodes=replaceNodes(nodes,to,size,view)),from>0&&(nodes=replaceNodes(nodes,0,from,view));for(var i=0;i<nodes.length;i++)nodes[i].parent=copy;return copy.children=nodes,copy},MarkViewDesc}(ViewDesc),NodeViewDesc=function(ViewDesc){function NodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos){ViewDesc.call(this,parent,node.isLeaf?nothing:[],dom,contentDOM),this.nodeDOM=nodeDOM,this.node=node,this.outerDeco=outerDeco,this.innerDeco=innerDeco,contentDOM&&this.updateChildren(view,pos)}ViewDesc&&(NodeViewDesc.__proto__=ViewDesc),NodeViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),NodeViewDesc.prototype.constructor=NodeViewDesc;var prototypeAccessors$3={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return NodeViewDesc.create=function create(parent,node,outerDeco,innerDeco,view,pos){var assign,descObj,custom=view.nodeViews[node.type.name],spec=custom&&custom(node,view,(function(){return descObj?descObj.parent?descObj.parent.posBeforeChild(descObj):void 0:pos}),outerDeco,innerDeco),dom=spec&&spec.dom,contentDOM=spec&&spec.contentDOM;if(node.isText)if(dom){if(3!=dom.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else dom=document.createTextNode(node.text);else dom||(dom=(assign=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.b.renderSpec(document,node.type.spec.toDOM(node))).dom,contentDOM=assign.contentDOM);contentDOM||node.isText||"BR"==dom.nodeName||(dom.hasAttribute("contenteditable")||(dom.contentEditable=!1),node.type.spec.draggable&&(dom.draggable=!0));var nodeDOM=dom;return dom=applyOuterDeco(dom,outerDeco,node),spec?descObj=new CustomNodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,spec,view,pos+1):node.isText?new TextViewDesc(parent,node,outerDeco,innerDeco,dom,nodeDOM,view):new NodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos+1)},NodeViewDesc.prototype.parseRule=function parseRule(){var this$1=this;if(this.node.type.spec.reparseInView)return null;var rule={node:this.node.type.name,attrs:this.node.attrs};return"pre"==this.node.type.whitespace&&(rule.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?rule.contentElement=this.contentDOM:rule.getContent=function(){return this$1.contentDOM?prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.empty:this$1.node.content},rule},NodeViewDesc.prototype.matchesNode=function matchesNode(node,outerDeco,innerDeco){return 0==this.dirty&&node.eq(this.node)&&sameOuterDeco(outerDeco,this.outerDeco)&&innerDeco.eq(this.innerDeco)},prototypeAccessors$3.size.get=function(){return this.node.nodeSize},prototypeAccessors$3.border.get=function(){return this.node.isLeaf?0:1},NodeViewDesc.prototype.updateChildren=function updateChildren(view,pos){var this$1=this,inline=this.node.inlineContent,off=pos,composition=view.composing&&this.localCompositionInfo(view,pos),localComposition=composition&&composition.pos>-1?composition:null,compositionInChild=composition&&composition.pos<0,updater=new ViewTreeUpdater(this,localComposition&&localComposition.node);!function iterDeco(parent,deco,onWidget,onNode){var locals=deco.locals(parent),offset=0;if(0==locals.length){for(var i=0;i<parent.childCount;i++){var child=parent.child(i);onNode(child,locals,deco.forChild(offset,child),i),offset+=child.nodeSize}return}for(var decoIndex=0,active=[],restNode=null,parentIndex=0;;){if(decoIndex<locals.length&&locals[decoIndex].to==offset){for(var widget=locals[decoIndex++],widgets=void 0;decoIndex<locals.length&&locals[decoIndex].to==offset;)(widgets||(widgets=[widget])).push(locals[decoIndex++]);if(widgets){widgets.sort(compareSide);for(var i$1=0;i$1<widgets.length;i$1++)onWidget(widgets[i$1],parentIndex,!!restNode)}else onWidget(widget,parentIndex,!!restNode)}var child$1=void 0,index=void 0;if(restNode)index=-1,child$1=restNode,restNode=null;else{if(!(parentIndex<parent.childCount))break;index=parentIndex,child$1=parent.child(parentIndex++)}for(var i$2=0;i$2<active.length;i$2++)active[i$2].to<=offset&&active.splice(i$2--,1);for(;decoIndex<locals.length&&locals[decoIndex].from<=offset&&locals[decoIndex].to>offset;)active.push(locals[decoIndex++]);var end=offset+child$1.nodeSize;if(child$1.isText){var cutAt=end;decoIndex<locals.length&&locals[decoIndex].from<cutAt&&(cutAt=locals[decoIndex].from);for(var i$3=0;i$3<active.length;i$3++)active[i$3].to<cutAt&&(cutAt=active[i$3].to);cutAt<end&&(restNode=child$1.cut(cutAt-offset),child$1=child$1.cut(0,cutAt-offset),end=cutAt,index=-1)}onNode(child$1,active.length?child$1.isInline&&!child$1.isLeaf?active.filter((function(d){return!d.inline})):active.slice():nothing,deco.forChild(offset,child$1),index),offset=end}}(this.node,this.innerDeco,(function(widget,i,insideNode){widget.spec.marks?updater.syncToMarks(widget.spec.marks,inline,view):widget.type.side>=0&&!insideNode&&updater.syncToMarks(i==this$1.node.childCount?prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.d.none:this$1.node.child(i).marks,inline,view),updater.placeWidget(widget,view,off)}),(function(child,outerDeco,innerDeco,i){var compIndex;updater.syncToMarks(child.marks,inline,view),updater.findNodeMatch(child,outerDeco,innerDeco,i)||compositionInChild&&view.state.selection.from>off&&view.state.selection.to<off+child.nodeSize&&(compIndex=updater.findIndexWithChild(composition.node))>-1&&updater.updateNodeAt(child,outerDeco,innerDeco,compIndex,view)||updater.updateNextNode(child,outerDeco,innerDeco,view,i)||updater.addNode(child,outerDeco,innerDeco,view,off),off+=child.nodeSize})),updater.syncToMarks(nothing,inline,view),this.node.isTextblock&&updater.addTextblockHacks(),updater.destroyRest(),(updater.changed||2==this.dirty)&&(localComposition&&this.protectLocalComposition(view,localComposition),renderDescs(this.contentDOM,this.children,view),result.ios&&function iosHacks(dom){if("UL"==dom.nodeName||"OL"==dom.nodeName){var oldCSS=dom.style.cssText;dom.style.cssText=oldCSS+"; list-style: square !important",window.getComputedStyle(dom).listStyle,dom.style.cssText=oldCSS}}(this.dom))},NodeViewDesc.prototype.localCompositionInfo=function localCompositionInfo(view,pos){var ref=view.state.selection,from=ref.from,to=ref.to;if(!(!(view.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g)||from<pos||to>pos+this.node.content.size)){var sel=view.root.getSelection(),textNode=function nearbyTextNode(node,offset){for(;;){if(3==node.nodeType)return node;if(1==node.nodeType&&offset>0){if(node.childNodes.length>offset&&3==node.childNodes[offset].nodeType)return node.childNodes[offset];offset=nodeSize(node=node.childNodes[offset-1])}else{if(!(1==node.nodeType&&offset<node.childNodes.length))return null;node=node.childNodes[offset],offset=0}}}(sel.focusNode,sel.focusOffset);if(textNode&&this.dom.contains(textNode.parentNode)){if(this.node.inlineContent){var text=textNode.nodeValue,textPos=function findTextInFragment(frag,text,from,to){for(var i=0,pos=0;i<frag.childCount&&pos<=to;){var child=frag.child(i++),childStart=pos;if(pos+=child.nodeSize,child.isText){for(var str=child.text;i<frag.childCount;){var next=frag.child(i++);if(pos+=next.nodeSize,!next.isText)break;str+=next.text}if(pos>=from&&childStart<to){var found=str.lastIndexOf(text,to-childStart-1);if(found>=0&&found+text.length+childStart>=from)return childStart+found}}}return-1}(this.node.content,text,from-pos,to-pos);return textPos<0?null:{node:textNode,pos:textPos,text:text}}return{node:textNode,pos:-1}}}},NodeViewDesc.prototype.protectLocalComposition=function protectLocalComposition(view,ref){var node=ref.node,pos=ref.pos,text=ref.text;if(!this.getDesc(node)){for(var topNode=node;topNode.parentNode!=this.contentDOM;topNode=topNode.parentNode){for(;topNode.previousSibling;)topNode.parentNode.removeChild(topNode.previousSibling);for(;topNode.nextSibling;)topNode.parentNode.removeChild(topNode.nextSibling);topNode.pmViewDesc&&(topNode.pmViewDesc=null)}var desc=new CompositionViewDesc(this,topNode,node,text);view.compositionNodes.push(desc),this.children=replaceNodes(this.children,pos,pos+text.length,view,desc)}},NodeViewDesc.prototype.update=function update(node,outerDeco,innerDeco,view){return!(3==this.dirty||!node.sameMarkup(this.node))&&(this.updateInner(node,outerDeco,innerDeco,view),!0)},NodeViewDesc.prototype.updateInner=function updateInner(node,outerDeco,innerDeco,view){this.updateOuterDeco(outerDeco),this.node=node,this.innerDeco=innerDeco,this.contentDOM&&this.updateChildren(view,this.posAtStart),this.dirty=0},NodeViewDesc.prototype.updateOuterDeco=function updateOuterDeco(outerDeco){if(!sameOuterDeco(outerDeco,this.outerDeco)){var needsWrap=1!=this.nodeDOM.nodeType,oldDOM=this.dom;this.dom=patchOuterDeco(this.dom,this.nodeDOM,computeOuterDeco(this.outerDeco,this.node,needsWrap),computeOuterDeco(outerDeco,this.node,needsWrap)),this.dom!=oldDOM&&(oldDOM.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=outerDeco}},NodeViewDesc.prototype.selectNode=function selectNode(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},NodeViewDesc.prototype.deselectNode=function deselectNode(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},prototypeAccessors$3.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(NodeViewDesc.prototype,prototypeAccessors$3),NodeViewDesc}(ViewDesc);function docViewDesc(doc,outerDeco,innerDeco,dom,view){return applyOuterDeco(dom,outerDeco,doc),new NodeViewDesc(null,doc,outerDeco,innerDeco,dom,dom,dom,view,0)}var TextViewDesc=function(NodeViewDesc){function TextViewDesc(parent,node,outerDeco,innerDeco,dom,nodeDOM,view){NodeViewDesc.call(this,parent,node,outerDeco,innerDeco,dom,null,nodeDOM,view)}NodeViewDesc&&(TextViewDesc.__proto__=NodeViewDesc),TextViewDesc.prototype=Object.create(NodeViewDesc&&NodeViewDesc.prototype),TextViewDesc.prototype.constructor=TextViewDesc;var prototypeAccessors$4={domAtom:{configurable:!0}};return TextViewDesc.prototype.parseRule=function parseRule(){for(var skip=this.nodeDOM.parentNode;skip&&skip!=this.dom&&!skip.pmIsDeco;)skip=skip.parentNode;return{skip:skip||!0}},TextViewDesc.prototype.update=function update(node,outerDeco,_,view){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!node.sameMarkup(this.node))&&(this.updateOuterDeco(outerDeco),0==this.dirty&&node.text==this.node.text||node.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=node.text,view.trackWrites==this.nodeDOM&&(view.trackWrites=null)),this.node=node,this.dirty=0,!0)},TextViewDesc.prototype.inParent=function inParent(){for(var parentDOM=this.parent.contentDOM,n=this.nodeDOM;n;n=n.parentNode)if(n==parentDOM)return!0;return!1},TextViewDesc.prototype.domFromPos=function domFromPos(pos){return{node:this.nodeDOM,offset:pos}},TextViewDesc.prototype.localPosFromDOM=function localPosFromDOM(dom,offset,bias){return dom==this.nodeDOM?this.posAtStart+Math.min(offset,this.node.text.length):NodeViewDesc.prototype.localPosFromDOM.call(this,dom,offset,bias)},TextViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return"characterData"!=mutation.type&&"selection"!=mutation.type},TextViewDesc.prototype.slice=function slice(from,to,view){var node=this.node.cut(from,to),dom=document.createTextNode(node.text);return new TextViewDesc(this.parent,node,this.outerDeco,this.innerDeco,dom,dom,view)},TextViewDesc.prototype.markDirty=function markDirty(from,to){NodeViewDesc.prototype.markDirty.call(this,from,to),this.dom==this.nodeDOM||0!=from&&to!=this.nodeDOM.nodeValue.length||(this.dirty=3)},prototypeAccessors$4.domAtom.get=function(){return!1},Object.defineProperties(TextViewDesc.prototype,prototypeAccessors$4),TextViewDesc}(NodeViewDesc),TrailingHackViewDesc=function(ViewDesc){function TrailingHackViewDesc(){ViewDesc.apply(this,arguments)}ViewDesc&&(TrailingHackViewDesc.__proto__=ViewDesc),TrailingHackViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),TrailingHackViewDesc.prototype.constructor=TrailingHackViewDesc;var prototypeAccessors$5={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return TrailingHackViewDesc.prototype.parseRule=function parseRule(){return{ignore:!0}},TrailingHackViewDesc.prototype.matchesHack=function matchesHack(nodeName){return 0==this.dirty&&this.dom.nodeName==nodeName},prototypeAccessors$5.domAtom.get=function(){return!0},prototypeAccessors$5.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(TrailingHackViewDesc.prototype,prototypeAccessors$5),TrailingHackViewDesc}(ViewDesc),CustomNodeViewDesc=function(NodeViewDesc){function CustomNodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,spec,view,pos){NodeViewDesc.call(this,parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos),this.spec=spec}return NodeViewDesc&&(CustomNodeViewDesc.__proto__=NodeViewDesc),CustomNodeViewDesc.prototype=Object.create(NodeViewDesc&&NodeViewDesc.prototype),CustomNodeViewDesc.prototype.constructor=CustomNodeViewDesc,CustomNodeViewDesc.prototype.update=function update(node,outerDeco,innerDeco,view){if(3==this.dirty)return!1;if(this.spec.update){var result=this.spec.update(node,outerDeco,innerDeco);return result&&this.updateInner(node,outerDeco,innerDeco,view),result}return!(!this.contentDOM&&!node.isLeaf)&&NodeViewDesc.prototype.update.call(this,node,outerDeco,innerDeco,view)},CustomNodeViewDesc.prototype.selectNode=function selectNode(){this.spec.selectNode?this.spec.selectNode():NodeViewDesc.prototype.selectNode.call(this)},CustomNodeViewDesc.prototype.deselectNode=function deselectNode(){this.spec.deselectNode?this.spec.deselectNode():NodeViewDesc.prototype.deselectNode.call(this)},CustomNodeViewDesc.prototype.setSelection=function setSelection(anchor,head,root,force){this.spec.setSelection?this.spec.setSelection(anchor,head,root):NodeViewDesc.prototype.setSelection.call(this,anchor,head,root,force)},CustomNodeViewDesc.prototype.destroy=function destroy(){this.spec.destroy&&this.spec.destroy(),NodeViewDesc.prototype.destroy.call(this)},CustomNodeViewDesc.prototype.stopEvent=function stopEvent(event){return!!this.spec.stopEvent&&this.spec.stopEvent(event)},CustomNodeViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return this.spec.ignoreMutation?this.spec.ignoreMutation(mutation):NodeViewDesc.prototype.ignoreMutation.call(this,mutation)},CustomNodeViewDesc}(NodeViewDesc);function renderDescs(parentDOM,descs,view){for(var dom=parentDOM.firstChild,written=!1,i=0;i<descs.length;i++){var desc=descs[i],childDOM=desc.dom;if(childDOM.parentNode==parentDOM){for(;childDOM!=dom;)dom=rm(dom),written=!0;dom=dom.nextSibling}else written=!0,parentDOM.insertBefore(childDOM,dom);if(desc instanceof MarkViewDesc){var pos=dom?dom.previousSibling:parentDOM.lastChild;renderDescs(desc.contentDOM,desc.children,view),dom=pos?pos.nextSibling:parentDOM.firstChild}}for(;dom;)dom=rm(dom),written=!0;written&&view.trackWrites==parentDOM&&(view.trackWrites=null)}function OuterDecoLevel(nodeName){nodeName&&(this.nodeName=nodeName)}OuterDecoLevel.prototype=Object.create(null);var noDeco=[new OuterDecoLevel];function computeOuterDeco(outerDeco,node,needsWrap){if(0==outerDeco.length)return noDeco;for(var top=needsWrap?noDeco[0]:new OuterDecoLevel,result=[top],i=0;i<outerDeco.length;i++){var attrs=outerDeco[i].type.attrs;if(attrs)for(var name in attrs.nodeName&&result.push(top=new OuterDecoLevel(attrs.nodeName)),attrs){var val=attrs[name];null!=val&&(needsWrap&&1==result.length&&result.push(top=new OuterDecoLevel(node.isInline?"span":"div")),"class"==name?top.class=(top.class?top.class+" ":"")+val:"style"==name?top.style=(top.style?top.style+";":"")+val:"nodeName"!=name&&(top[name]=val))}}return result}function patchOuterDeco(outerDOM,nodeDOM,prevComputed,curComputed){if(prevComputed==noDeco&&curComputed==noDeco)return nodeDOM;for(var curDOM=nodeDOM,i=0;i<curComputed.length;i++){var deco=curComputed[i],prev=prevComputed[i];if(i){var parent=void 0;prev&&prev.nodeName==deco.nodeName&&curDOM!=outerDOM&&(parent=curDOM.parentNode)&&parent.tagName.toLowerCase()==deco.nodeName||((parent=document.createElement(deco.nodeName)).pmIsDeco=!0,parent.appendChild(curDOM),prev=noDeco[0]),curDOM=parent}patchAttributes(curDOM,prev||noDeco[0],deco)}return curDOM}function patchAttributes(dom,prev,cur){for(var name in prev)"class"==name||"style"==name||"nodeName"==name||name in cur||dom.removeAttribute(name);for(var name$1 in cur)"class"!=name$1&&"style"!=name$1&&"nodeName"!=name$1&&cur[name$1]!=prev[name$1]&&dom.setAttribute(name$1,cur[name$1]);if(prev.class!=cur.class){for(var prevList=prev.class?prev.class.split(" ").filter(Boolean):nothing,curList=cur.class?cur.class.split(" ").filter(Boolean):nothing,i=0;i<prevList.length;i++)-1==curList.indexOf(prevList[i])&&dom.classList.remove(prevList[i]);for(var i$1=0;i$1<curList.length;i$1++)-1==prevList.indexOf(curList[i$1])&&dom.classList.add(curList[i$1]);0==dom.classList.length&&dom.removeAttribute("class")}if(prev.style!=cur.style){if(prev.style)for(var m,prop=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;m=prop.exec(prev.style);)dom.style.removeProperty(m[1]);cur.style&&(dom.style.cssText+=cur.style)}}function applyOuterDeco(dom,deco,node){return patchOuterDeco(dom,dom,noDeco,computeOuterDeco(deco,node,1!=dom.nodeType))}function sameOuterDeco(a,b){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].type.eq(b[i].type))return!1;return!0}function rm(dom){var next=dom.nextSibling;return dom.parentNode.removeChild(dom),next}var ViewTreeUpdater=function ViewTreeUpdater(top,lockedNode){this.top=top,this.lock=lockedNode,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function preMatch(frag,parentDesc){var curDesc=parentDesc,descI=curDesc.children.length,fI=frag.childCount,matched=new Map,matches=[];outer:for(;fI>0;){for(var desc=void 0;;)if(descI){var next=curDesc.children[descI-1];if(!(next instanceof MarkViewDesc)){desc=next,descI--;break}curDesc=next,descI=next.children.length}else{if(curDesc==parentDesc)break outer;descI=curDesc.parent.children.indexOf(curDesc),curDesc=curDesc.parent}var node=desc.node;if(node){if(node!=frag.child(fI-1))break;--fI,matched.set(desc,fI),matches.push(desc)}}return{index:fI,matched:matched,matches:matches.reverse()}}(top.node.content,top)};function compareSide(a,b){return a.type.side-b.type.side}function replaceNodes(nodes,from,to,view,replacement){for(var result=[],i=0,off=0;i<nodes.length;i++){var child=nodes[i],start=off,end=off+=child.size;start>=to||end<=from?result.push(child):(start<from&&result.push(child.slice(0,from-start,view)),replacement&&(result.push(replacement),replacement=null),end>to&&result.push(child.slice(to-start,child.size,view)))}return result}function selectionFromDOM(view,origin){var domSel=view.root.getSelection(),doc=view.state.doc;if(!domSel.focusNode)return null;var nearestDesc=view.docView.nearestDesc(domSel.focusNode),inWidget=nearestDesc&&0==nearestDesc.size,head=view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset);if(head<0)return null;var $anchor,selection,$head=doc.resolve(head);if(selectionCollapsed(domSel)){for($anchor=$head;nearestDesc&&!nearestDesc.node;)nearestDesc=nearestDesc.parent;if(nearestDesc&&nearestDesc.node.isAtom&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.isSelectable(nearestDesc.node)&&nearestDesc.parent&&(!nearestDesc.node.isInline||!function isOnEdge(node,offset,parent){for(var atStart=0==offset,atEnd=offset==nodeSize(node);atStart||atEnd;){if(node==parent)return!0;var index=domIndex(node);if(!(node=node.parentNode))return!1;atStart=atStart&&0==index,atEnd=atEnd&&index==nodeSize(node)}}(domSel.focusNode,domSel.focusOffset,nearestDesc.dom))){var pos=nearestDesc.posBefore;selection=new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c(head==pos?$head:doc.resolve(pos))}}else{var anchor=view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset);if(anchor<0)return null;$anchor=doc.resolve(anchor)}selection||(selection=selectionBetween(view,$anchor,$head,"pointer"==origin||view.state.selection.head<$head.pos&&!inWidget?1:-1));return selection}function editorOwnsSelection(view){return view.editable?view.hasFocus():hasSelection(view)&&document.activeElement&&document.activeElement.contains(view.dom)}function selectionToDOM(view,force){var sel=view.state.selection;if(syncNodeSelection(view,sel),editorOwnsSelection(view)){if(!force&&view.mouseDown&&view.mouseDown.allowDefault){var domSel=view.root.getSelection(),curSel=view.domObserver.currentSelection;if(domSel.anchorNode&&isEquivalentPosition(domSel.anchorNode,domSel.anchorOffset,curSel.anchorNode,curSel.anchorOffset))return view.mouseDown.delayedSelectionSync=!0,void view.domObserver.setCurSelection()}if(view.domObserver.disconnectSelection(),view.cursorWrapper)!function selectCursorWrapper(view){var domSel=view.root.getSelection(),range=document.createRange(),node=view.cursorWrapper.dom,img="IMG"==node.nodeName;img?range.setEnd(node.parentNode,domIndex(node)+1):range.setEnd(node,0);range.collapse(!1),domSel.removeAllRanges(),domSel.addRange(range),!img&&!view.state.selection.visible&&result.ie&&result.ie_version<=11&&(node.disabled=!0,node.disabled=!1)}(view);else{var resetEditableFrom,resetEditableTo,anchor=sel.anchor,head=sel.head;!brokenSelectBetweenUneditable||sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g||(sel.$from.parent.inlineContent||(resetEditableFrom=temporarilyEditableNear(view,sel.from)),sel.empty||sel.$from.parent.inlineContent||(resetEditableTo=temporarilyEditableNear(view,sel.to))),view.docView.setSelection(anchor,head,view.root,force),brokenSelectBetweenUneditable&&(resetEditableFrom&&resetEditable(resetEditableFrom),resetEditableTo&&resetEditable(resetEditableTo)),sel.visible?view.dom.classList.remove("ProseMirror-hideselection"):(view.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function removeClassOnSelectionChange(view){var doc=view.dom.ownerDocument;doc.removeEventListener("selectionchange",view.hideSelectionGuard);var domSel=view.root.getSelection(),node=domSel.anchorNode,offset=domSel.anchorOffset;doc.addEventListener("selectionchange",view.hideSelectionGuard=function(){domSel.anchorNode==node&&domSel.anchorOffset==offset||(doc.removeEventListener("selectionchange",view.hideSelectionGuard),setTimeout((function(){editorOwnsSelection(view)&&!view.state.selection.visible||view.dom.classList.remove("ProseMirror-hideselection")}),20))})}(view))}view.domObserver.setCurSelection(),view.domObserver.connectSelection()}}ViewTreeUpdater.prototype.destroyBetween=function destroyBetween(start,end){if(start!=end){for(var i=start;i<end;i++)this.top.children[i].destroy();this.top.children.splice(start,end-start),this.changed=!0}},ViewTreeUpdater.prototype.destroyRest=function destroyRest(){this.destroyBetween(this.index,this.top.children.length)},ViewTreeUpdater.prototype.syncToMarks=function syncToMarks(marks,inline,view){for(var keep=0,depth=this.stack.length>>1,maxKeep=Math.min(depth,marks.length);keep<maxKeep&&(keep==depth-1?this.top:this.stack[keep+1<<1]).matchesMark(marks[keep])&&!1!==marks[keep].type.spec.spanning;)keep++;for(;keep<depth;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),depth--;for(;depth<marks.length;){this.stack.push(this.top,this.index+1);for(var found=-1,i=this.index;i<Math.min(this.index+3,this.top.children.length);i++)if(this.top.children[i].matchesMark(marks[depth])){found=i;break}if(found>-1)found>this.index&&(this.changed=!0,this.destroyBetween(this.index,found)),this.top=this.top.children[this.index];else{var markDesc=MarkViewDesc.create(this.top,marks[depth],inline,view);this.top.children.splice(this.index,0,markDesc),this.top=markDesc,this.changed=!0}this.index=0,depth++}},ViewTreeUpdater.prototype.findNodeMatch=function findNodeMatch(node,outerDeco,innerDeco,index){var targetDesc,found=-1;if(index>=this.preMatch.index&&(targetDesc=this.preMatch.matches[index-this.preMatch.index]).parent==this.top&&targetDesc.matchesNode(node,outerDeco,innerDeco))found=this.top.children.indexOf(targetDesc,this.index);else for(var i=this.index,e=Math.min(this.top.children.length,i+5);i<e;i++){var child=this.top.children[i];if(child.matchesNode(node,outerDeco,innerDeco)&&!this.preMatch.matched.has(child)){found=i;break}}return!(found<0)&&(this.destroyBetween(this.index,found),this.index++,!0)},ViewTreeUpdater.prototype.updateNodeAt=function updateNodeAt(node,outerDeco,innerDeco,index,view){return!!this.top.children[index].update(node,outerDeco,innerDeco,view)&&(this.destroyBetween(this.index,index),this.index=index+1,!0)},ViewTreeUpdater.prototype.findIndexWithChild=function findIndexWithChild(domNode){for(;;){var parent=domNode.parentNode;if(!parent)return-1;if(parent==this.top.contentDOM){var desc=domNode.pmViewDesc;if(desc)for(var i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==desc)return i;return-1}domNode=parent}},ViewTreeUpdater.prototype.updateNextNode=function updateNextNode(node,outerDeco,innerDeco,view,index){for(var i=this.index;i<this.top.children.length;i++){var next=this.top.children[i];if(next instanceof NodeViewDesc){var preMatch=this.preMatch.matched.get(next);if(null!=preMatch&&preMatch!=index)return!1;var nextDOM=next.dom;if(!(this.lock&&(nextDOM==this.lock||1==nextDOM.nodeType&&nextDOM.contains(this.lock.parentNode))&&!(node.isText&&next.node&&next.node.isText&&next.nodeDOM.nodeValue==node.text&&3!=next.dirty&&sameOuterDeco(outerDeco,next.outerDeco)))&&next.update(node,outerDeco,innerDeco,view))return this.destroyBetween(this.index,i),next.dom!=nextDOM&&(this.changed=!0),this.index++,!0;break}}return!1},ViewTreeUpdater.prototype.addNode=function addNode(node,outerDeco,innerDeco,view,pos){this.top.children.splice(this.index++,0,NodeViewDesc.create(this.top,node,outerDeco,innerDeco,view,pos)),this.changed=!0},ViewTreeUpdater.prototype.placeWidget=function placeWidget(widget,view,pos){var next=this.index<this.top.children.length?this.top.children[this.index]:null;if(!next||!next.matchesWidget(widget)||widget!=next.widget&&next.widget.type.toDOM.parentNode){var desc=new WidgetViewDesc(this.top,widget,view,pos);this.top.children.splice(this.index++,0,desc),this.changed=!0}else this.index++},ViewTreeUpdater.prototype.addTextblockHacks=function addTextblockHacks(){for(var lastChild=this.top.children[this.index-1];lastChild instanceof MarkViewDesc;)lastChild=lastChild.children[lastChild.children.length-1];lastChild&&lastChild instanceof TextViewDesc&&!/\n$/.test(lastChild.node.text)||((result.safari||result.chrome)&&lastChild&&"false"==lastChild.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},ViewTreeUpdater.prototype.addHackNode=function addHackNode(nodeName){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(nodeName))this.index++;else{var dom=document.createElement(nodeName);"IMG"==nodeName&&(dom.className="ProseMirror-separator"),"BR"==nodeName&&(dom.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new TrailingHackViewDesc(this.top,nothing,dom,null)),this.changed=!0}};var brokenSelectBetweenUneditable=result.safari||result.chrome&&result.chrome_version<63;function temporarilyEditableNear(view,pos){var ref=view.docView.domFromPos(pos,0),node=ref.node,offset=ref.offset,after=offset<node.childNodes.length?node.childNodes[offset]:null,before=offset?node.childNodes[offset-1]:null;if(result.safari&&after&&"false"==after.contentEditable)return setEditable(after);if(!(after&&"false"!=after.contentEditable||before&&"false"!=before.contentEditable)){if(after)return setEditable(after);if(before)return setEditable(before)}}function setEditable(element){return element.contentEditable="true",result.safari&&element.draggable&&(element.draggable=!1,element.wasDraggable=!0),element}function resetEditable(element){element.contentEditable="false",element.wasDraggable&&(element.draggable=!0,element.wasDraggable=null)}function syncNodeSelection(view,sel){if(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c){var desc=view.docView.descAt(sel.from);desc!=view.lastSelectedViewDesc&&(clearNodeSelection(view),desc&&desc.selectNode(),view.lastSelectedViewDesc=desc)}else clearNodeSelection(view)}function clearNodeSelection(view){view.lastSelectedViewDesc&&(view.lastSelectedViewDesc.parent&&view.lastSelectedViewDesc.deselectNode(),view.lastSelectedViewDesc=null)}function selectionBetween(view,$anchor,$head,bias){return view.someProp("createSelectionBetween",(function(f){return f(view,$anchor,$head)}))||prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g.between($anchor,$head,bias)}function hasSelection(view){var sel=view.root.getSelection();if(!sel.anchorNode)return!1;try{return view.dom.contains(3==sel.anchorNode.nodeType?sel.anchorNode.parentNode:sel.anchorNode)&&(view.editable||view.dom.contains(3==sel.focusNode.nodeType?sel.focusNode.parentNode:sel.focusNode))}catch(_){return!1}}function moveSelectionBlock(state,dir){var ref=state.selection,$anchor=ref.$anchor,$head=ref.$head,$side=dir>0?$anchor.max($head):$anchor.min($head),$start=$side.parent.inlineContent?$side.depth?state.doc.resolve(dir>0?$side.after():$side.before()):null:$side;return $start&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.f.findFrom($start,dir)}function apply(view,sel){return view.dispatch(view.state.tr.setSelection(sel).scrollIntoView()),!0}function selectHorizontally(view,dir,mods){var sel=view.state.selection;if(!(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g)){if(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c&&sel.node.isInline)return apply(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g(dir>0?sel.$to:sel.$from));var next$1=moveSelectionBlock(view.state,dir);return!!next$1&&apply(view,next$1)}if(!sel.empty||mods.indexOf("s")>-1)return!1;if(view.endOfTextblock(dir>0?"right":"left")){var next=moveSelectionBlock(view.state,dir);return!!(next&&next instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c)&&apply(view,next)}if(!(result.mac&&mods.indexOf("m")>-1)){var desc,$head=sel.$head,node=$head.textOffset?null:dir<0?$head.nodeBefore:$head.nodeAfter;if(!node||node.isText)return!1;var nodePos=dir<0?$head.pos-node.nodeSize:$head.pos;return!!(node.isAtom||(desc=view.docView.descAt(nodePos))&&!desc.contentDOM)&&(prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.isSelectable(node)?apply(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c(dir<0?view.state.doc.resolve($head.pos-node.nodeSize):$head)):!!result.webkit&&apply(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g(view.state.doc.resolve(dir<0?nodePos:nodePos+node.nodeSize))))}}function nodeLen(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function isIgnorable(dom){var desc=dom.pmViewDesc;return desc&&0==desc.size&&(dom.nextSibling||"BR"!=dom.nodeName)}function skipIgnoredNodesLeft(view){var sel=view.root.getSelection(),node=sel.focusNode,offset=sel.focusOffset;if(node){var moveNode,moveOffset,force=!1;for(result.gecko&&1==node.nodeType&&offset<nodeLen(node)&&isIgnorable(node.childNodes[offset])&&(force=!0);;)if(offset>0){if(1!=node.nodeType)break;var before=node.childNodes[offset-1];if(isIgnorable(before))moveNode=node,moveOffset=--offset;else{if(3!=before.nodeType)break;offset=(node=before).nodeValue.length}}else{if(isBlockNode(node))break;for(var prev=node.previousSibling;prev&&isIgnorable(prev);)moveNode=node.parentNode,moveOffset=domIndex(prev),prev=prev.previousSibling;if(prev)offset=nodeLen(node=prev);else{if((node=node.parentNode)==view.dom)break;offset=0}}force?setSelFocus(view,sel,node,offset):moveNode&&setSelFocus(view,sel,moveNode,moveOffset)}}function skipIgnoredNodesRight(view){var sel=view.root.getSelection(),node=sel.focusNode,offset=sel.focusOffset;if(node){for(var moveNode,moveOffset,len=nodeLen(node);;)if(offset<len){if(1!=node.nodeType)break;if(!isIgnorable(node.childNodes[offset]))break;moveNode=node,moveOffset=++offset}else{if(isBlockNode(node))break;for(var next=node.nextSibling;next&&isIgnorable(next);)moveNode=next.parentNode,moveOffset=domIndex(next)+1,next=next.nextSibling;if(next)offset=0,len=nodeLen(node=next);else{if((node=node.parentNode)==view.dom)break;offset=len=0}}moveNode&&setSelFocus(view,sel,moveNode,moveOffset)}}function isBlockNode(dom){var desc=dom.pmViewDesc;return desc&&desc.node&&desc.node.isBlock}function setSelFocus(view,sel,node,offset){if(selectionCollapsed(sel)){var range=document.createRange();range.setEnd(node,offset),range.setStart(node,offset),sel.removeAllRanges(),sel.addRange(range)}else sel.extend&&sel.extend(node,offset);view.domObserver.setCurSelection();var state=view.state;setTimeout((function(){view.state==state&&selectionToDOM(view)}),50)}function selectVertically(view,dir,mods){var sel=view.state.selection;if(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g&&!sel.empty||mods.indexOf("s")>-1)return!1;if(result.mac&&mods.indexOf("m")>-1)return!1;var $from=sel.$from,$to=sel.$to;if(!$from.parent.inlineContent||view.endOfTextblock(dir<0?"up":"down")){var next=moveSelectionBlock(view.state,dir);if(next&&next instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c)return apply(view,next)}if(!$from.parent.inlineContent){var side=dir<0?$from:$to,beyond=sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.a?prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.f.near(side,dir):prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.f.findFrom(side,dir);return!!beyond&&apply(view,beyond)}return!1}function stopNativeHorizontalDelete(view,dir){if(!(view.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g))return!0;var ref=view.state.selection,$head=ref.$head,$anchor=ref.$anchor,empty=ref.empty;if(!$head.sameParent($anchor))return!0;if(!empty)return!1;if(view.endOfTextblock(dir>0?"forward":"backward"))return!0;var nextNode=!$head.textOffset&&(dir<0?$head.nodeBefore:$head.nodeAfter);if(nextNode&&!nextNode.isText){var tr=view.state.tr;return dir<0?tr.delete($head.pos-nextNode.nodeSize,$head.pos):tr.delete($head.pos,$head.pos+nextNode.nodeSize),view.dispatch(tr),!0}return!1}function switchEditable(view,node,state){view.domObserver.stop(),node.contentEditable=state,view.domObserver.start()}function captureKeyDown(view,event){var code=event.keyCode,mods=function getMods(event){var result="";return event.ctrlKey&&(result+="c"),event.metaKey&&(result+="m"),event.altKey&&(result+="a"),event.shiftKey&&(result+="s"),result}(event);return 8==code||result.mac&&72==code&&"c"==mods?stopNativeHorizontalDelete(view,-1)||skipIgnoredNodesLeft(view):46==code||result.mac&&68==code&&"c"==mods?stopNativeHorizontalDelete(view,1)||skipIgnoredNodesRight(view):13==code||27==code||(37==code?selectHorizontally(view,-1,mods)||skipIgnoredNodesLeft(view):39==code?selectHorizontally(view,1,mods)||skipIgnoredNodesRight(view):38==code?selectVertically(view,-1,mods)||skipIgnoredNodesLeft(view):40==code?function safariDownArrowBug(view){if(result.safari&&!(view.state.selection.$head.parentOffset>0)){var ref=view.root.getSelection(),focusNode=ref.focusNode,focusOffset=ref.focusOffset;if(focusNode&&1==focusNode.nodeType&&0==focusOffset&&focusNode.firstChild&&"false"==focusNode.firstChild.contentEditable){var child=focusNode.firstChild;switchEditable(view,child,!0),setTimeout((function(){return switchEditable(view,child,!1)}),20)}}}(view)||selectVertically(view,1,mods)||skipIgnoredNodesRight(view):mods==(result.mac?"m":"c")&&(66==code||73==code||89==code||90==code))}function ruleFromNode(dom){var desc=dom.pmViewDesc;if(desc)return desc.parseRule();if("BR"==dom.nodeName&&dom.parentNode){if(result.safari&&/^(ul|ol)$/i.test(dom.parentNode.nodeName)){var skip=document.createElement("div");return skip.appendChild(document.createElement("li")),{skip:skip}}if(dom.parentNode.lastChild==dom||result.safari&&/^(tr|table)$/i.test(dom.parentNode.nodeName))return{ignore:!0}}else if("IMG"==dom.nodeName&&dom.getAttribute("mark-placeholder"))return{ignore:!0}}function readDOMChange(view,from,to,typeOver,addedNodes){if(from<0){var origin=view.lastSelectionTime>Date.now()-50?view.lastSelectionOrigin:null,newSel=selectionFromDOM(view,origin);if(newSel&&!view.state.selection.eq(newSel)){var tr$1=view.state.tr.setSelection(newSel);"pointer"==origin?tr$1.setMeta("pointer",!0):"key"==origin&&tr$1.scrollIntoView(),view.dispatch(tr$1)}}else{var $before=view.state.doc.resolve(from),shared=$before.sharedDepth(to);from=$before.before(shared+1),to=view.state.doc.resolve(to).after(shared+1);var sel=view.state.selection,parse=function parseBetween(view,from_,to_){var ref=view.docView.parseRange(from_,to_),parent=ref.node,fromOffset=ref.fromOffset,toOffset=ref.toOffset,from=ref.from,to=ref.to,domSel=view.root.getSelection(),find=null,anchor=domSel.anchorNode;if(anchor&&view.dom.contains(1==anchor.nodeType?anchor:anchor.parentNode)&&(find=[{node:anchor,offset:domSel.anchorOffset}],selectionCollapsed(domSel)||find.push({node:domSel.focusNode,offset:domSel.focusOffset})),result.chrome&&8===view.lastKeyCode)for(var off=toOffset;off>fromOffset;off--){var node=parent.childNodes[off-1],desc=node.pmViewDesc;if("BR"==node.nodeName&&!desc){toOffset=off;break}if(!desc||desc.size)break}var startDoc=view.state.doc,parser=view.someProp("domParser")||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.a.fromSchema(view.state.schema),$from=startDoc.resolve(from),sel=null,doc=parser.parse(parent,{topNode:$from.parent,topMatch:$from.parent.contentMatchAt($from.index()),topOpen:!0,from:fromOffset,to:toOffset,preserveWhitespace:"pre"!=$from.parent.type.whitespace||"full",editableContent:!0,findPositions:find,ruleFromNode:ruleFromNode,context:$from});if(find&&null!=find[0].pos){var anchor$1=find[0].pos,head=find[1]&&find[1].pos;null==head&&(head=anchor$1),sel={anchor:anchor$1+from,head:head+from}}return{doc:doc,sel:sel,from:from,to:to}}(view,from,to);if(result.chrome&&view.cursorWrapper&&parse.sel&&parse.sel.anchor==view.cursorWrapper.deco.from){var text=view.cursorWrapper.deco.type.toDOM.nextSibling,size=text&&text.nodeValue?text.nodeValue.length:1;parse.sel={anchor:parse.sel.anchor+size,head:parse.sel.anchor+size}}var preferredPos,preferredSide,doc=view.state.doc,compare=doc.slice(parse.from,parse.to);8===view.lastKeyCode&&Date.now()-100<view.lastKeyCodeTime?(preferredPos=view.state.selection.to,preferredSide="end"):(preferredPos=view.state.selection.from,preferredSide="start"),view.lastKeyCode=null;var change=function findDiff(a,b,pos,preferredPos,preferredSide){var start=a.findDiffStart(b,pos);if(null==start)return null;var ref=a.findDiffEnd(b,pos+a.size,pos+b.size),endA=ref.a,endB=ref.b;if("end"==preferredSide){preferredPos-=endA+Math.max(0,start-Math.min(endA,endB))-start}if(endA<start&&a.size<b.size){endB=(start-=preferredPos<=start&&preferredPos>=endA?start-preferredPos:0)+(endB-endA),endA=start}else if(endB<start){endA=(start-=preferredPos<=start&&preferredPos>=endB?start-preferredPos:0)+(endA-endB),endB=start}return{start:start,endA:endA,endB:endB}}(compare.content,parse.doc.content,parse.from,preferredPos,preferredSide);if(!change){if(!(typeOver&&sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g&&!sel.empty&&sel.$head.sameParent(sel.$anchor))||view.composing||parse.sel&&parse.sel.anchor!=parse.sel.head){if((result.ios&&view.lastIOSEnter>Date.now()-225||result.android)&&addedNodes.some((function(n){return"DIV"==n.nodeName||"P"==n.nodeName}))&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})))return void(view.lastIOSEnter=0);if(parse.sel){var sel$1=resolveSelection(view,view.state.doc,parse.sel);sel$1&&!sel$1.eq(view.state.selection)&&view.dispatch(view.state.tr.setSelection(sel$1))}return}change={start:sel.from,endA:sel.to,endB:sel.to}}view.domChangeCount++,view.state.selection.from<view.state.selection.to&&change.start==change.endB&&view.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g&&(change.start>view.state.selection.from&&change.start<=view.state.selection.from+2?change.start=view.state.selection.from:change.endA<view.state.selection.to&&change.endA>=view.state.selection.to-2&&(change.endB+=view.state.selection.to-change.endA,change.endA=view.state.selection.to)),result.ie&&result.ie_version<=11&&change.endB==change.start+1&&change.endA==change.start&&change.start>parse.from&&"  "==parse.doc.textBetween(change.start-parse.from-1,change.start-parse.from+1)&&(change.start--,change.endA--,change.endB--);var nextSel,$from=parse.doc.resolveNoCache(change.start-parse.from),$to=parse.doc.resolveNoCache(change.endB-parse.from),inlineChange=$from.sameParent($to)&&$from.parent.inlineContent;if((result.ios&&view.lastIOSEnter>Date.now()-225&&(!inlineChange||addedNodes.some((function(n){return"DIV"==n.nodeName||"P"==n.nodeName})))||!inlineChange&&$from.pos<parse.doc.content.size&&(nextSel=prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.f.findFrom(parse.doc.resolve($from.pos+1),1,!0))&&nextSel.head==$to.pos)&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})))view.lastIOSEnter=0;else if(view.state.selection.anchor>change.start&&function looksLikeJoin(old,start,end,$newStart,$newEnd){if(!$newStart.parent.isTextblock||end-start<=$newEnd.pos-$newStart.pos||skipClosingAndOpening($newStart,!0,!1)<$newEnd.pos)return!1;var $start=old.resolve(start);if($start.parentOffset<$start.parent.content.size||!$start.parent.isTextblock)return!1;var $next=old.resolve(skipClosingAndOpening($start,!0,!0));if(!$next.parent.isTextblock||$next.pos>end||skipClosingAndOpening($next,!0,!1)<end)return!1;return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)}(doc,change.start,change.endA,$from,$to)&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(8,"Backspace"))})))result.android&&result.chrome&&view.domObserver.suppressSelectionUpdates();else{result.chrome&&result.android&&change.toB==change.from&&(view.lastAndroidDelete=Date.now()),result.android&&!inlineChange&&$from.start()!=$to.start()&&0==$to.parentOffset&&$from.depth==$to.depth&&parse.sel&&parse.sel.anchor==parse.sel.head&&parse.sel.head==change.endA&&(change.endB-=2,$to=parse.doc.resolveNoCache(change.endB-parse.from),setTimeout((function(){view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))}))}),20));var tr,storedMarks,markChange,$from1,chFrom=change.start,chTo=change.endA;if(inlineChange)if($from.pos==$to.pos)result.ie&&result.ie_version<=11&&0==$from.parentOffset&&(view.domObserver.suppressSelectionUpdates(),setTimeout((function(){return selectionToDOM(view)}),20)),tr=view.state.tr.delete(chFrom,chTo),storedMarks=doc.resolve(change.start).marksAcross(doc.resolve(change.endA));else if(change.endA==change.endB&&($from1=doc.resolve(change.start))&&(markChange=function isMarkChange(cur,prev){for(var type,mark,update,curMarks=cur.firstChild.marks,prevMarks=prev.firstChild.marks,added=curMarks,removed=prevMarks,i=0;i<prevMarks.length;i++)added=prevMarks[i].removeFromSet(added);for(var i$1=0;i$1<curMarks.length;i$1++)removed=curMarks[i$1].removeFromSet(removed);if(1==added.length&&0==removed.length)mark=added[0],type="add",update=function(node){return node.mark(mark.addToSet(node.marks))};else{if(0!=added.length||1!=removed.length)return null;mark=removed[0],type="remove",update=function(node){return node.mark(mark.removeFromSet(node.marks))}}for(var updated=[],i$2=0;i$2<prev.childCount;i$2++)updated.push(update(prev.child(i$2)));if(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.from(updated).eq(cur))return{mark:mark,type:type}}($from.parent.content.cut($from.parentOffset,$to.parentOffset),$from1.parent.content.cut($from1.parentOffset,change.endA-$from1.start()))))tr=view.state.tr,"add"==markChange.type?tr.addMark(chFrom,chTo,markChange.mark):tr.removeMark(chFrom,chTo,markChange.mark);else if($from.parent.child($from.index()).isText&&$from.index()==$to.index()-($to.textOffset?0:1)){var text$1=$from.parent.textBetween($from.parentOffset,$to.parentOffset);if(view.someProp("handleTextInput",(function(f){return f(view,chFrom,chTo,text$1)})))return;tr=view.state.tr.insertText(text$1,chFrom,chTo)}if(tr||(tr=view.state.tr.replace(chFrom,chTo,parse.doc.slice(change.start-parse.from,change.endB-parse.from))),parse.sel){var sel$2=resolveSelection(view,tr.doc,parse.sel);sel$2&&!(result.chrome&&result.android&&view.composing&&sel$2.empty&&(change.start!=change.endB||view.lastAndroidDelete<Date.now()-100)&&(sel$2.head==chFrom||sel$2.head==tr.mapping.map(chTo)-1)||result.ie&&sel$2.empty&&sel$2.head==chFrom)&&tr.setSelection(sel$2)}storedMarks&&tr.ensureMarks(storedMarks),view.dispatch(tr.scrollIntoView())}}}function resolveSelection(view,doc,parsedSel){return Math.max(parsedSel.anchor,parsedSel.head)>doc.content.size?null:selectionBetween(view,doc.resolve(parsedSel.anchor),doc.resolve(parsedSel.head))}function skipClosingAndOpening($pos,fromEnd,mayOpen){for(var depth=$pos.depth,end=fromEnd?$pos.end():$pos.pos;depth>0&&(fromEnd||$pos.indexAfter(depth)==$pos.node(depth).childCount);)depth--,end++,fromEnd=!1;if(mayOpen)for(var next=$pos.node(depth).maybeChild($pos.indexAfter(depth));next&&!next.isLeaf;)next=next.firstChild,end++;return end}function serializeForClipboard(view,slice){for(var context=[],content=slice.content,openStart=slice.openStart,openEnd=slice.openEnd;openStart>1&&openEnd>1&&1==content.childCount&&1==content.firstChild.childCount;){openStart--,openEnd--;var node=content.firstChild;context.push(node.type.name,node.attrs!=node.type.defaultAttrs?node.attrs:null),content=node.content}var serializer=view.someProp("clipboardSerializer")||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.b.fromSchema(view.state.schema),doc=detachedDoc(),wrap=doc.createElement("div");wrap.appendChild(serializer.serializeFragment(content,{document:doc}));for(var needsWrap,firstChild=wrap.firstChild;firstChild&&1==firstChild.nodeType&&(needsWrap=wrapMap[firstChild.nodeName.toLowerCase()]);){for(var i=needsWrap.length-1;i>=0;i--){for(var wrapper=doc.createElement(needsWrap[i]);wrap.firstChild;)wrapper.appendChild(wrap.firstChild);wrap.appendChild(wrapper),"tbody"!=needsWrap[i]&&(openStart++,openEnd++)}firstChild=wrap.firstChild}return firstChild&&1==firstChild.nodeType&&firstChild.setAttribute("data-pm-slice",openStart+" "+openEnd+" "+JSON.stringify(context)),{dom:wrap,text:view.someProp("clipboardTextSerializer",(function(f){return f(slice)}))||slice.content.textBetween(0,slice.content.size,"\n\n")}}function parseFromClipboard(view,text,html,plainText,$context){var dom,slice,inCode=$context.parent.type.spec.code;if(!html&&!text)return null;var asText=text&&(plainText||inCode||!html);if(asText){if(view.someProp("transformPastedText",(function(f){text=f(text,inCode||plainText)})),inCode)return text?new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.from(view.state.schema.text(text.replace(/\r\n?/g,"\n"))),0,0):prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j.empty;var parsed=view.someProp("clipboardTextParser",(function(f){return f(text,$context,plainText)}));if(parsed)slice=parsed;else{var marks=$context.marks(),schema=view.state.schema,serializer=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.b.fromSchema(schema);dom=document.createElement("div"),text.split(/(?:\r\n?|\n)+/).forEach((function(block){var p=dom.appendChild(document.createElement("p"));block&&p.appendChild(serializer.serializeNode(schema.text(block,marks)))}))}}else view.someProp("transformPastedHTML",(function(f){html=f(html)})),dom=function readHTML(html){var metas=/^(\s*<meta [^>]*>)*/.exec(html);metas&&(html=html.slice(metas[0].length));var wrap,elt=detachedDoc().createElement("div"),firstTag=/<([a-z][^>\s]+)/i.exec(html);(wrap=firstTag&&wrapMap[firstTag[1].toLowerCase()])&&(html=wrap.map((function(n){return"<"+n+">"})).join("")+html+wrap.map((function(n){return"</"+n+">"})).reverse().join(""));if(elt.innerHTML=html,wrap)for(var i=0;i<wrap.length;i++)elt=elt.querySelector(wrap[i])||elt;return elt}(html),result.webkit&&function restoreReplacedSpaces(dom){for(var nodes=dom.querySelectorAll(result.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),i=0;i<nodes.length;i++){var node=nodes[i];1==node.childNodes.length&&" "==node.textContent&&node.parentNode&&node.parentNode.replaceChild(dom.ownerDocument.createTextNode(" "),node)}}(dom);var contextNode=dom&&dom.querySelector("[data-pm-slice]"),sliceData=contextNode&&/^(\d+) (\d+) (.*)/.exec(contextNode.getAttribute("data-pm-slice"));if(!slice){var parser=view.someProp("clipboardParser")||view.someProp("domParser")||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.a.fromSchema(view.state.schema);slice=parser.parseSlice(dom,{preserveWhitespace:!(!asText&&!sliceData),context:$context,ruleFromNode:function ruleFromNode(dom){if("BR"==dom.nodeName&&!dom.nextSibling&&dom.parentNode&&!inlineParents.test(dom.parentNode.nodeName))return{ignore:!0}}})}if(sliceData)slice=function addContext(slice,context){if(!slice.size)return slice;var array,schema=slice.content.firstChild.type.schema;try{array=JSON.parse(context)}catch(e){return slice}for(var content=slice.content,openStart=slice.openStart,openEnd=slice.openEnd,i=array.length-2;i>=0;i-=2){var type=schema.nodes[array[i]];if(!type||type.hasRequiredAttrs())break;content=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.from(type.create(array[i+1],content)),openStart++,openEnd++}return new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j(content,openStart,openEnd)}(closeSlice(slice,+sliceData[1],+sliceData[2]),sliceData[3]);else if(slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j.maxOpen(function normalizeSiblings(fragment,$context){if(fragment.childCount<2)return fragment;for(var loop=function(d){var match=$context.node(d).contentMatchAt($context.index(d)),lastWrap=void 0,result=[];if(fragment.forEach((function(node){if(result){var inLast,wrap=match.findWrapping(node.type);if(!wrap)return result=null;if(inLast=result.length&&lastWrap.length&&addToSibling(wrap,lastWrap,node,result[result.length-1],0))result[result.length-1]=inLast;else{result.length&&(result[result.length-1]=closeRight(result[result.length-1],lastWrap.length));var wrapped=withWrappers(node,wrap);result.push(wrapped),match=match.matchType(wrapped.type,wrapped.attrs),lastWrap=wrap}}})),result)return{v:prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.from(result)}},d=$context.depth;d>=0;d--){var returned=loop(d);if(returned)return returned.v}return fragment}(slice.content,$context),!0),slice.openStart||slice.openEnd){for(var openStart=0,openEnd=0,node=slice.content.firstChild;openStart<slice.openStart&&!node.type.spec.isolating;openStart++,node=node.firstChild);for(var node$1=slice.content.lastChild;openEnd<slice.openEnd&&!node$1.type.spec.isolating;openEnd++,node$1=node$1.lastChild);slice=closeSlice(slice,openStart,openEnd)}return view.someProp("transformPasted",(function(f){slice=f(slice)})),slice}var inlineParents=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function withWrappers(node,wrap,from){void 0===from&&(from=0);for(var i=wrap.length-1;i>=from;i--)node=wrap[i].create(null,prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.from(node));return node}function addToSibling(wrap,lastWrap,node,sibling,depth){if(depth<wrap.length&&depth<lastWrap.length&&wrap[depth]==lastWrap[depth]){var inner=addToSibling(wrap,lastWrap,node,sibling.lastChild,depth+1);if(inner)return sibling.copy(sibling.content.replaceChild(sibling.childCount-1,inner));if(sibling.contentMatchAt(sibling.childCount).matchType(depth==wrap.length-1?node.type:wrap[depth+1]))return sibling.copy(sibling.content.append(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.from(withWrappers(node,wrap,depth+1))))}}function closeRight(node,depth){if(0==depth)return node;var fragment=node.content.replaceChild(node.childCount-1,closeRight(node.lastChild,depth-1)),fill=node.contentMatchAt(node.childCount).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.empty,!0);return node.copy(fragment.append(fill))}function closeRange(fragment,side,from,to,depth,openEnd){var node=side<0?fragment.firstChild:fragment.lastChild,inner=node.content;return depth<to-1&&(inner=closeRange(inner,side,from,to,depth+1,openEnd)),depth>=from&&(inner=side<0?node.contentMatchAt(0).fillBefore(inner,fragment.childCount>1||openEnd<=depth).append(inner):inner.append(node.contentMatchAt(node.childCount).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.c.empty,!0))),fragment.replaceChild(side<0?0:fragment.childCount-1,node.copy(inner))}function closeSlice(slice,openStart,openEnd){return openStart<slice.openStart&&(slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j(closeRange(slice.content,-1,openStart,slice.openStart,0,slice.openEnd),openStart,slice.openEnd)),openEnd<slice.openEnd&&(slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j(closeRange(slice.content,1,openEnd,slice.openEnd,0,0),slice.openStart,openEnd)),slice}var wrapMap={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},_detachedDoc=null;function detachedDoc(){return _detachedDoc||(_detachedDoc=document.implementation.createHTMLDocument("title"))}var observeOptions={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},useCharData=result.ie&&result.ie_version<=11,SelectionState=function SelectionState(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};SelectionState.prototype.set=function set(sel){this.anchorNode=sel.anchorNode,this.anchorOffset=sel.anchorOffset,this.focusNode=sel.focusNode,this.focusOffset=sel.focusOffset},SelectionState.prototype.eq=function eq(sel){return sel.anchorNode==this.anchorNode&&sel.anchorOffset==this.anchorOffset&&sel.focusNode==this.focusNode&&sel.focusOffset==this.focusOffset};var DOMObserver=function DOMObserver(view,handleDOMChange){var this$1=this;this.view=view,this.handleDOMChange=handleDOMChange,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(mutations){for(var i=0;i<mutations.length;i++)this$1.queue.push(mutations[i]);result.ie&&result.ie_version<=11&&mutations.some((function(m){return"childList"==m.type&&m.removedNodes.length||"characterData"==m.type&&m.oldValue.length>m.target.nodeValue.length}))?this$1.flushSoon():this$1.flush()})),this.currentSelection=new SelectionState,useCharData&&(this.onCharData=function(e){this$1.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this$1.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};DOMObserver.prototype.flushSoon=function flushSoon(){var this$1=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){this$1.flushingSoon=-1,this$1.flush()}),20))},DOMObserver.prototype.forceFlush=function forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},DOMObserver.prototype.start=function start(){this.observer&&this.observer.observe(this.view.dom,observeOptions),useCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},DOMObserver.prototype.stop=function stop(){var this$1=this;if(this.observer){var take=this.observer.takeRecords();if(take.length){for(var i=0;i<take.length;i++)this.queue.push(take[i]);window.setTimeout((function(){return this$1.flush()}),20)}this.observer.disconnect()}useCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},DOMObserver.prototype.connectSelection=function connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},DOMObserver.prototype.disconnectSelection=function disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},DOMObserver.prototype.suppressSelectionUpdates=function suppressSelectionUpdates(){var this$1=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return this$1.suppressingSelectionUpdates=!1}),50)},DOMObserver.prototype.onSelectionChange=function onSelectionChange(){if(function hasFocusAndSelection(view){return(!view.editable||view.root.activeElement==view.dom)&&hasSelection(view)}(this.view)){if(this.suppressingSelectionUpdates)return selectionToDOM(this.view);if(result.ie&&result.ie_version<=11&&!this.view.state.selection.empty){var sel=this.view.root.getSelection();if(sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset))return this.flushSoon()}this.flush()}},DOMObserver.prototype.setCurSelection=function setCurSelection(){this.currentSelection.set(this.view.root.getSelection())},DOMObserver.prototype.ignoreSelectionChange=function ignoreSelectionChange(sel){if(0==sel.rangeCount)return!0;var container=sel.getRangeAt(0).commonAncestorContainer,desc=this.view.docView.nearestDesc(container);return desc&&desc.ignoreMutation({type:"selection",target:3==container.nodeType?container.parentNode:container})?(this.setCurSelection(),!0):void 0},DOMObserver.prototype.flush=function flush(){if(this.view.docView&&!(this.flushingSoon>-1)){var mutations=this.observer?this.observer.takeRecords():[];this.queue.length&&(mutations=this.queue.concat(mutations),this.queue.length=0);var sel=this.view.root.getSelection(),newSel=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(sel)&&hasSelection(this.view)&&!this.ignoreSelectionChange(sel),from=-1,to=-1,typeOver=!1,added=[];if(this.view.editable)for(var i=0;i<mutations.length;i++){var result$1=this.registerMutation(mutations[i],added);result$1&&(from=from<0?result$1.from:Math.min(result$1.from,from),to=to<0?result$1.to:Math.max(result$1.to,to),result$1.typeOver&&(typeOver=!0))}if(result.gecko&&added.length>1){var brs=added.filter((function(n){return"BR"==n.nodeName}));if(2==brs.length){var a=brs[0],b=brs[1];a.parentNode&&a.parentNode.parentNode==b.parentNode?b.remove():a.remove()}}(from>-1||newSel)&&(from>-1&&(this.view.docView.markDirty(from,to),function checkCSS(view){if(cssChecked)return;cssChecked=!0,"normal"==getComputedStyle(view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(from,to,typeOver,added),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(sel)||selectionToDOM(this.view),this.currentSelection.set(sel))}},DOMObserver.prototype.registerMutation=function registerMutation(mut,added){if(added.indexOf(mut.target)>-1)return null;var desc=this.view.docView.nearestDesc(mut.target);if("attributes"==mut.type&&(desc==this.view.docView||"contenteditable"==mut.attributeName||"style"==mut.attributeName&&!mut.oldValue&&!mut.target.getAttribute("style")))return null;if(!desc||desc.ignoreMutation(mut))return null;if("childList"==mut.type){for(var i=0;i<mut.addedNodes.length;i++)added.push(mut.addedNodes[i]);if(desc.contentDOM&&desc.contentDOM!=desc.dom&&!desc.contentDOM.contains(mut.target))return{from:desc.posBefore,to:desc.posAfter};var prev=mut.previousSibling,next=mut.nextSibling;if(result.ie&&result.ie_version<=11&&mut.addedNodes.length)for(var i$1=0;i$1<mut.addedNodes.length;i$1++){var ref=mut.addedNodes[i$1],previousSibling=ref.previousSibling,nextSibling=ref.nextSibling;(!previousSibling||Array.prototype.indexOf.call(mut.addedNodes,previousSibling)<0)&&(prev=previousSibling),(!nextSibling||Array.prototype.indexOf.call(mut.addedNodes,nextSibling)<0)&&(next=nextSibling)}var fromOffset=prev&&prev.parentNode==mut.target?domIndex(prev)+1:0,from=desc.localPosFromDOM(mut.target,fromOffset,-1),toOffset=next&&next.parentNode==mut.target?domIndex(next):mut.target.childNodes.length;return{from:from,to:desc.localPosFromDOM(mut.target,toOffset,1)}}return"attributes"==mut.type?{from:desc.posAtStart-desc.border,to:desc.posAtEnd+desc.border}:{from:desc.posAtStart,to:desc.posAtEnd,typeOver:mut.target.nodeValue==mut.oldValue}};var cssChecked=!1;var handlers={},editHandlers={};function setSelectionOrigin(view,origin){view.lastSelectionOrigin=origin,view.lastSelectionTime=Date.now()}function ensureListeners(view){view.someProp("handleDOMEvents",(function(currentHandlers){for(var type in currentHandlers)view.eventHandlers[type]||view.dom.addEventListener(type,view.eventHandlers[type]=function(event){return runCustomHandler(view,event)})}))}function runCustomHandler(view,event){return view.someProp("handleDOMEvents",(function(handlers){var handler=handlers[event.type];return!!handler&&(handler(view,event)||event.defaultPrevented)}))}function eventCoords(event){return{left:event.clientX,top:event.clientY}}function runHandlerOnContext(view,propName,pos,inside,event){if(-1==inside)return!1;for(var $pos=view.state.doc.resolve(inside),loop=function(i){if(view.someProp(propName,(function(f){return i>$pos.depth?f(view,pos,$pos.nodeAfter,$pos.before(i),event,!0):f(view,pos,$pos.node(i),$pos.before(i),event,!1)})))return{v:!0}},i=$pos.depth+1;i>0;i--){var returned=loop(i);if(returned)return returned.v}return!1}function updateSelection(view,selection,origin){view.focused||view.focus();var tr=view.state.tr.setSelection(selection);"pointer"==origin&&tr.setMeta("pointer",!0),view.dispatch(tr)}function handleSingleClick(view,pos,inside,event,selectNode){return runHandlerOnContext(view,"handleClickOn",pos,inside,event)||view.someProp("handleClick",(function(f){return f(view,pos,event)}))||(selectNode?function selectClickedNode(view,inside){if(-1==inside)return!1;var selectedNode,selectAt,sel=view.state.selection;sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c&&(selectedNode=sel.node);for(var $pos=view.state.doc.resolve(inside),i=$pos.depth+1;i>0;i--){var node=i>$pos.depth?$pos.nodeAfter:$pos.node(i);if(prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.isSelectable(node)){selectAt=selectedNode&&sel.$from.depth>0&&i>=sel.$from.depth&&$pos.before(sel.$from.depth+1)==sel.$from.pos?$pos.before(sel.$from.depth):$pos.before(i);break}}return null!=selectAt&&(updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.create(view.state.doc,selectAt),"pointer"),!0)}(view,inside):function selectClickedLeaf(view,inside){if(-1==inside)return!1;var $pos=view.state.doc.resolve(inside),node=$pos.nodeAfter;return!!(node&&node.isAtom&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.isSelectable(node))&&(updateSelection(view,new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c($pos),"pointer"),!0)}(view,inside))}function handleDoubleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleDoubleClickOn",pos,inside,event)||view.someProp("handleDoubleClick",(function(f){return f(view,pos,event)}))}function handleTripleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleTripleClickOn",pos,inside,event)||view.someProp("handleTripleClick",(function(f){return f(view,pos,event)}))||function defaultTripleClick(view,inside,event){if(0!=event.button)return!1;var doc=view.state.doc;if(-1==inside)return!!doc.inlineContent&&(updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g.create(doc,0,doc.content.size),"pointer"),!0);for(var $pos=doc.resolve(inside),i=$pos.depth+1;i>0;i--){var node=i>$pos.depth?$pos.nodeAfter:$pos.node(i),nodePos=$pos.before(i);if(node.inlineContent)updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g.create(doc,nodePos+1,nodePos+1+node.content.size),"pointer");else{if(!prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.isSelectable(node))continue;updateSelection(view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.create(doc,nodePos),"pointer")}return!0}}(view,inside,event)}function forceDOMFlush(view){return endComposition(view)}editHandlers.keydown=function(view,event){if(view.shiftKey=16==event.keyCode||event.shiftKey,!inOrNearComposition(view,event)&&(view.lastKeyCode=event.keyCode,view.lastKeyCodeTime=Date.now(),!result.android||!result.chrome||13!=event.keyCode))if(229!=event.keyCode&&view.domObserver.forceFlush(),!result.ios||13!=event.keyCode||event.ctrlKey||event.altKey||event.metaKey)view.someProp("handleKeyDown",(function(f){return f(view,event)}))||captureKeyDown(view,event)?event.preventDefault():setSelectionOrigin(view,"key");else{var now=Date.now();view.lastIOSEnter=now,view.lastIOSEnterFallbackTimeout=setTimeout((function(){view.lastIOSEnter==now&&(view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})),view.lastIOSEnter=0)}),200)}},editHandlers.keyup=function(view,e){16==e.keyCode&&(view.shiftKey=!1)},editHandlers.keypress=function(view,event){if(!(inOrNearComposition(view,event)||!event.charCode||event.ctrlKey&&!event.altKey||result.mac&&event.metaKey))if(view.someProp("handleKeyPress",(function(f){return f(view,event)})))event.preventDefault();else{var sel=view.state.selection;if(!(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g&&sel.$from.sameParent(sel.$to))){var text=String.fromCharCode(event.charCode);view.someProp("handleTextInput",(function(f){return f(view,sel.$from.pos,sel.$to.pos,text)}))||view.dispatch(view.state.tr.insertText(text).scrollIntoView()),event.preventDefault()}}};var selectNodeModifier=result.mac?"metaKey":"ctrlKey";handlers.mousedown=function(view,event){view.shiftKey=event.shiftKey;var flushed=forceDOMFlush(view),now=Date.now(),type="singleClick";now-view.lastClick.time<500&&function isNear(event,click){var dx=click.x-event.clientX,dy=click.y-event.clientY;return dx*dx+dy*dy<100}(event,view.lastClick)&&!event[selectNodeModifier]&&("singleClick"==view.lastClick.type?type="doubleClick":"doubleClick"==view.lastClick.type&&(type="tripleClick")),view.lastClick={time:now,x:event.clientX,y:event.clientY,type:type};var pos=view.posAtCoords(eventCoords(event));pos&&("singleClick"==type?(view.mouseDown&&view.mouseDown.done(),view.mouseDown=new MouseDown(view,pos,event,flushed)):("doubleClick"==type?handleDoubleClick:handleTripleClick)(view,pos.pos,pos.inside,event)?event.preventDefault():setSelectionOrigin(view,"pointer"))};var MouseDown=function MouseDown(view,pos,event,flushed){var targetNode,targetPos,this$1=this;if(this.view=view,this.startDoc=view.state.doc,this.pos=pos,this.event=event,this.flushed=flushed,this.selectNode=event[selectNodeModifier],this.allowDefault=event.shiftKey,this.delayedSelectionSync=!1,pos.inside>-1)targetNode=view.state.doc.nodeAt(pos.inside),targetPos=pos.inside;else{var $pos=view.state.doc.resolve(pos.pos);targetNode=$pos.parent,targetPos=$pos.depth?$pos.before():0}this.mightDrag=null;var target=flushed?null:event.target,targetDesc=target?view.docView.nearestDesc(target,!0):null;this.target=targetDesc?targetDesc.dom:null;var selection=view.state.selection;(0==event.button&&targetNode.type.spec.draggable&&!1!==targetNode.type.spec.selectable||selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c&&selection.from<=targetPos&&selection.to>targetPos)&&(this.mightDrag={node:targetNode,pos:targetPos,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&result.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){this$1.view.mouseDown==this$1&&this$1.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),view.root.addEventListener("mouseup",this.up=this.up.bind(this)),view.root.addEventListener("mousemove",this.move=this.move.bind(this)),setSelectionOrigin(view,"pointer")};function inOrNearComposition(view,event){return!!view.composing||!!(result.safari&&Math.abs(event.timeStamp-view.compositionEndedAt)<500)&&(view.compositionEndedAt=-2e8,!0)}MouseDown.prototype.done=function done(){var this$1=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return selectionToDOM(this$1.view)})),this.view.mouseDown=null},MouseDown.prototype.up=function up(event){if(this.done(),this.view.dom.contains(3==event.target.nodeType?event.target.parentNode:event.target)){var pos=this.pos;this.view.state.doc!=this.startDoc&&(pos=this.view.posAtCoords(eventCoords(event))),this.allowDefault||!pos?setSelectionOrigin(this.view,"pointer"):handleSingleClick(this.view,pos.pos,pos.inside,event,this.selectNode)?event.preventDefault():0==event.button&&(this.flushed||result.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||result.chrome&&!(this.view.state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.g)&&Math.min(Math.abs(pos.pos-this.view.state.selection.from),Math.abs(pos.pos-this.view.state.selection.to))<=2)?(updateSelection(this.view,prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.f.near(this.view.state.doc.resolve(pos.pos)),"pointer"),event.preventDefault()):setSelectionOrigin(this.view,"pointer")}},MouseDown.prototype.move=function move(event){!this.allowDefault&&(Math.abs(this.event.x-event.clientX)>4||Math.abs(this.event.y-event.clientY)>4)&&(this.allowDefault=!0),setSelectionOrigin(this.view,"pointer"),0==event.buttons&&this.done()},handlers.touchdown=function(view){forceDOMFlush(view),setSelectionOrigin(view,"pointer")},handlers.contextmenu=function(view){return forceDOMFlush(view)};var timeoutComposition=result.android?5e3:-1;function scheduleComposeEnd(view,delay){clearTimeout(view.composingTimeout),delay>-1&&(view.composingTimeout=setTimeout((function(){return endComposition(view)}),delay))}function clearComposition(view){for(view.composing&&(view.composing=!1,view.compositionEndedAt=function timestampFromCustomEvent(){var event=document.createEvent("Event");return event.initEvent("event",!0,!0),event.timeStamp}());view.compositionNodes.length>0;)view.compositionNodes.pop().markParentsDirty()}function endComposition(view,forceUpdate){if(!(result.android&&view.domObserver.flushingSoon>=0)){if(view.domObserver.forceFlush(),clearComposition(view),forceUpdate||view.docView.dirty){var sel=selectionFromDOM(view);return sel&&!sel.eq(view.state.selection)?view.dispatch(view.state.tr.setSelection(sel)):view.updateState(view.state),!0}return!1}}editHandlers.compositionstart=editHandlers.compositionupdate=function(view){if(!view.composing){view.domObserver.flush();var state=view.state,$pos=state.selection.$from;if(state.selection.empty&&(state.storedMarks||!$pos.textOffset&&$pos.parentOffset&&$pos.nodeBefore.marks.some((function(m){return!1===m.type.spec.inclusive}))))view.markCursor=view.state.storedMarks||$pos.marks(),endComposition(view,!0),view.markCursor=null;else if(endComposition(view),result.gecko&&state.selection.empty&&$pos.parentOffset&&!$pos.textOffset&&$pos.nodeBefore.marks.length)for(var sel=view.root.getSelection(),node=sel.focusNode,offset=sel.focusOffset;node&&1==node.nodeType&&0!=offset;){var before=offset<0?node.lastChild:node.childNodes[offset-1];if(!before)break;if(3==before.nodeType){sel.collapse(before,before.nodeValue.length);break}node=before,offset=-1}view.composing=!0}scheduleComposeEnd(view,timeoutComposition)},editHandlers.compositionend=function(view,event){view.composing&&(view.composing=!1,view.compositionEndedAt=event.timeStamp,scheduleComposeEnd(view,20))};var brokenClipboardAPI=result.ie&&result.ie_version<15||result.ios&&result.webkit_version<604;function doPaste(view,text,html,e){var slice=parseFromClipboard(view,text,html,view.shiftKey,view.state.selection.$from);if(view.someProp("handlePaste",(function(f){return f(view,e,slice||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j.empty)})))return!0;if(!slice)return!1;var singleNode=function sliceSingleNode(slice){return 0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount?slice.content.firstChild:null}(slice),tr=singleNode?view.state.tr.replaceSelectionWith(singleNode,view.shiftKey):view.state.tr.replaceSelection(slice);return view.dispatch(tr.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}handlers.copy=editHandlers.cut=function(view,e){var sel=view.state.selection,cut="cut"==e.type;if(!sel.empty){var data=brokenClipboardAPI?null:e.clipboardData,ref=serializeForClipboard(view,sel.content()),dom=ref.dom,text=ref.text;data?(e.preventDefault(),data.clearData(),data.setData("text/html",dom.innerHTML),data.setData("text/plain",text)):function captureCopy(view,dom){if(view.dom.parentNode){var wrap=view.dom.parentNode.appendChild(document.createElement("div"));wrap.appendChild(dom),wrap.style.cssText="position: fixed; left: -10000px; top: 10px";var sel=getSelection(),range=document.createRange();range.selectNodeContents(dom),view.dom.blur(),sel.removeAllRanges(),sel.addRange(range),setTimeout((function(){wrap.parentNode&&wrap.parentNode.removeChild(wrap),view.focus()}),50)}}(view,dom),cut&&view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},editHandlers.paste=function(view,e){if(!view.composing||result.android){var data=brokenClipboardAPI?null:e.clipboardData;data&&doPaste(view,data.getData("text/plain"),data.getData("text/html"),e)?e.preventDefault():function capturePaste(view,e){if(view.dom.parentNode){var plainText=view.shiftKey||view.state.selection.$from.parent.type.spec.code,target=view.dom.parentNode.appendChild(document.createElement(plainText?"textarea":"div"));plainText||(target.contentEditable="true"),target.style.cssText="position: fixed; left: -10000px; top: 10px",target.focus(),setTimeout((function(){view.focus(),target.parentNode&&target.parentNode.removeChild(target),plainText?doPaste(view,target.value,null,e):doPaste(view,target.textContent,target.innerHTML,e)}),50)}}(view,e)}};var Dragging=function Dragging(slice,move){this.slice=slice,this.move=move},dragCopyModifier=result.mac?"altKey":"ctrlKey";for(var prop in handlers.dragstart=function(view,e){var mouseDown=view.mouseDown;if(mouseDown&&mouseDown.done(),e.dataTransfer){var sel=view.state.selection,pos=sel.empty?null:view.posAtCoords(eventCoords(e));if(pos&&pos.pos>=sel.from&&pos.pos<=(sel instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c?sel.to-1:sel.to));else if(mouseDown&&mouseDown.mightDrag)view.dispatch(view.state.tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.create(view.state.doc,mouseDown.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var desc=view.docView.nearestDesc(e.target,!0);desc&&desc.node.type.spec.draggable&&desc!=view.docView&&view.dispatch(view.state.tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.create(view.state.doc,desc.posBefore)))}var slice=view.state.selection.content(),ref=serializeForClipboard(view,slice),dom=ref.dom,text=ref.text;e.dataTransfer.clearData(),e.dataTransfer.setData(brokenClipboardAPI?"Text":"text/html",dom.innerHTML),e.dataTransfer.effectAllowed="copyMove",brokenClipboardAPI||e.dataTransfer.setData("text/plain",text),view.dragging=new Dragging(slice,!e[dragCopyModifier])}},handlers.dragend=function(view){var dragging=view.dragging;window.setTimeout((function(){view.dragging==dragging&&(view.dragging=null)}),50)},editHandlers.dragover=editHandlers.dragenter=function(_,e){return e.preventDefault()},editHandlers.drop=function(view,e){var dragging=view.dragging;if(view.dragging=null,e.dataTransfer){var eventPos=view.posAtCoords(eventCoords(e));if(eventPos){var $mouse=view.state.doc.resolve(eventPos.pos);if($mouse){var slice=dragging&&dragging.slice;slice?view.someProp("transformPasted",(function(f){slice=f(slice)})):slice=parseFromClipboard(view,e.dataTransfer.getData(brokenClipboardAPI?"Text":"text/plain"),brokenClipboardAPI?null:e.dataTransfer.getData("text/html"),!1,$mouse);var move=dragging&&!e[dragCopyModifier];if(view.someProp("handleDrop",(function(f){return f(view,e,slice||prosemirror_model__WEBPACK_IMPORTED_MODULE_1__.j.empty,move)})))e.preventDefault();else if(slice){e.preventDefault();var insertPos=slice?Object(prosemirror_transform__WEBPACK_IMPORTED_MODULE_2__.g)(view.state.doc,$mouse.pos,slice):$mouse.pos;null==insertPos&&(insertPos=$mouse.pos);var tr=view.state.tr;move&&tr.deleteSelection();var pos=tr.mapping.map(insertPos),isNode=0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount,beforeInsert=tr.doc;if(isNode?tr.replaceRangeWith(pos,pos,slice.content.firstChild):tr.replaceRange(pos,pos,slice),!tr.doc.eq(beforeInsert)){var $pos=tr.doc.resolve(pos);if(isNode&&prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c.isSelectable(slice.content.firstChild)&&$pos.nodeAfter&&$pos.nodeAfter.sameMarkup(slice.content.firstChild))tr.setSelection(new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c($pos));else{var end=tr.mapping.map(insertPos);tr.mapping.maps[tr.mapping.maps.length-1].forEach((function(_from,_to,_newFrom,newTo){return end=newTo})),tr.setSelection(selectionBetween(view,$pos,tr.doc.resolve(end)))}view.focus(),view.dispatch(tr.setMeta("uiEvent","drop"))}}}}}},handlers.focus=function(view){view.focused||(view.domObserver.stop(),view.dom.classList.add("ProseMirror-focused"),view.domObserver.start(),view.focused=!0,setTimeout((function(){view.docView&&view.hasFocus()&&!view.domObserver.currentSelection.eq(view.root.getSelection())&&selectionToDOM(view)}),20))},handlers.blur=function(view,e){view.focused&&(view.domObserver.stop(),view.dom.classList.remove("ProseMirror-focused"),view.domObserver.start(),e.relatedTarget&&view.dom.contains(e.relatedTarget)&&view.domObserver.currentSelection.set({}),view.focused=!1)},handlers.beforeinput=function(view,event){if(result.chrome&&result.android&&"deleteContentBackward"==event.inputType){view.domObserver.flushSoon();var domChangeCount=view.domChangeCount;setTimeout((function(){if(view.domChangeCount==domChangeCount&&(view.dom.blur(),view.focus(),!view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(8,"Backspace"))})))){var $cursor=view.state.selection.$cursor;$cursor&&$cursor.pos>0&&view.dispatch(view.state.tr.delete($cursor.pos-1,$cursor.pos).scrollIntoView())}}),50)}},editHandlers)handlers[prop]=editHandlers[prop];function compareObjs(a,b){if(a==b)return!0;for(var p in a)if(a[p]!==b[p])return!1;for(var p$1 in b)if(!(p$1 in a))return!1;return!0}var WidgetType=function WidgetType(toDOM,spec){this.spec=spec||noSpec,this.side=this.spec.side||0,this.toDOM=toDOM};WidgetType.prototype.map=function map(mapping,span,offset,oldOffset){var ref=mapping.mapResult(span.from+oldOffset,this.side<0?-1:1),pos=ref.pos;return ref.deleted?null:new Decoration(pos-offset,pos-offset,this)},WidgetType.prototype.valid=function valid(){return!0},WidgetType.prototype.eq=function eq(other){return this==other||other instanceof WidgetType&&(this.spec.key&&this.spec.key==other.spec.key||this.toDOM==other.toDOM&&compareObjs(this.spec,other.spec))},WidgetType.prototype.destroy=function destroy(node){this.spec.destroy&&this.spec.destroy(node)};var InlineType=function InlineType(attrs,spec){this.spec=spec||noSpec,this.attrs=attrs};InlineType.prototype.map=function map(mapping,span,offset,oldOffset){var from=mapping.map(span.from+oldOffset,this.spec.inclusiveStart?-1:1)-offset,to=mapping.map(span.to+oldOffset,this.spec.inclusiveEnd?1:-1)-offset;return from>=to?null:new Decoration(from,to,this)},InlineType.prototype.valid=function valid(_,span){return span.from<span.to},InlineType.prototype.eq=function eq(other){return this==other||other instanceof InlineType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)},InlineType.is=function is(span){return span.type instanceof InlineType};var NodeType=function NodeType(attrs,spec){this.spec=spec||noSpec,this.attrs=attrs};NodeType.prototype.map=function map(mapping,span,offset,oldOffset){var from=mapping.mapResult(span.from+oldOffset,1);if(from.deleted)return null;var to=mapping.mapResult(span.to+oldOffset,-1);return to.deleted||to.pos<=from.pos?null:new Decoration(from.pos-offset,to.pos-offset,this)},NodeType.prototype.valid=function valid(node,span){var child,ref=node.content.findIndex(span.from),index=ref.index,offset=ref.offset;return offset==span.from&&!(child=node.child(index)).isText&&offset+child.nodeSize==span.to},NodeType.prototype.eq=function eq(other){return this==other||other instanceof NodeType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)};var Decoration=function Decoration(from,to,type){this.from=from,this.to=to,this.type=type},prototypeAccessors$1={spec:{configurable:!0},inline:{configurable:!0}};Decoration.prototype.copy=function copy(from,to){return new Decoration(from,to,this.type)},Decoration.prototype.eq=function eq(other,offset){return void 0===offset&&(offset=0),this.type.eq(other.type)&&this.from+offset==other.from&&this.to+offset==other.to},Decoration.prototype.map=function map(mapping,offset,oldOffset){return this.type.map(mapping,this,offset,oldOffset)},Decoration.widget=function widget(pos,toDOM,spec){return new Decoration(pos,pos,new WidgetType(toDOM,spec))},Decoration.inline=function inline(from,to,attrs,spec){return new Decoration(from,to,new InlineType(attrs,spec))},Decoration.node=function node(from,to,attrs,spec){return new Decoration(from,to,new NodeType(attrs,spec))},prototypeAccessors$1.spec.get=function(){return this.type.spec},prototypeAccessors$1.inline.get=function(){return this.type instanceof InlineType},Object.defineProperties(Decoration.prototype,prototypeAccessors$1);var none=[],noSpec={},DecorationSet=function DecorationSet(local,children){this.local=local&&local.length?local:none,this.children=children&&children.length?children:none};DecorationSet.create=function create(doc,decorations){return decorations.length?buildTree(decorations,doc,0,noSpec):empty},DecorationSet.prototype.find=function find(start,end,predicate){var result=[];return this.findInner(null==start?0:start,null==end?1e9:end,result,0,predicate),result},DecorationSet.prototype.findInner=function findInner(start,end,result,offset,predicate){for(var i=0;i<this.local.length;i++){var span=this.local[i];span.from<=end&&span.to>=start&&(!predicate||predicate(span.spec))&&result.push(span.copy(span.from+offset,span.to+offset))}for(var i$1=0;i$1<this.children.length;i$1+=3)if(this.children[i$1]<end&&this.children[i$1+1]>start){var childOff=this.children[i$1]+1;this.children[i$1+2].findInner(start-childOff,end-childOff,result,offset+childOff,predicate)}},DecorationSet.prototype.map=function map(mapping,doc,options){return this==empty||0==mapping.maps.length?this:this.mapInner(mapping,doc,0,0,options||noSpec)},DecorationSet.prototype.mapInner=function mapInner(mapping,node,offset,oldOffset,options){for(var newLocal,i=0;i<this.local.length;i++){var mapped=this.local[i].map(mapping,offset,oldOffset);mapped&&mapped.type.valid(node,mapped)?(newLocal||(newLocal=[])).push(mapped):options.onRemove&&options.onRemove(this.local[i].spec)}return this.children.length?function mapChildren(oldChildren,newLocal,mapping,node,offset,oldOffset,options){for(var children=oldChildren.slice(),shift=function(oldStart,oldEnd,newStart,newEnd){for(var i=0;i<children.length;i+=3){var end=children[i+1],dSize=void 0;-1==end||oldStart>end+oldOffset||(oldEnd>=children[i]+oldOffset?children[i+1]=-1:newStart>=offset&&(dSize=newEnd-newStart-(oldEnd-oldStart))&&(children[i]+=dSize,children[i+1]+=dSize))}},i=0;i<mapping.maps.length;i++)mapping.maps[i].forEach(shift);for(var mustRebuild=!1,i$1=0;i$1<children.length;i$1+=3)if(-1==children[i$1+1]){var from=mapping.map(oldChildren[i$1]+oldOffset),fromLocal=from-offset;if(fromLocal<0||fromLocal>=node.content.size){mustRebuild=!0;continue}var toLocal=mapping.map(oldChildren[i$1+1]+oldOffset,-1)-offset,ref=node.content.findIndex(fromLocal),index=ref.index,childOffset=ref.offset,childNode=node.maybeChild(index);if(childNode&&childOffset==fromLocal&&childOffset+childNode.nodeSize==toLocal){var mapped=children[i$1+2].mapInner(mapping,childNode,from+1,oldChildren[i$1]+oldOffset+1,options);mapped!=empty?(children[i$1]=fromLocal,children[i$1+1]=toLocal,children[i$1+2]=mapped):(children[i$1+1]=-2,mustRebuild=!0)}else mustRebuild=!0}if(mustRebuild){var decorations=function mapAndGatherRemainingDecorations(children,oldChildren,decorations,mapping,offset,oldOffset,options){function gather(set,oldOffset){for(var i=0;i<set.local.length;i++){var mapped=set.local[i].map(mapping,offset,oldOffset);mapped?decorations.push(mapped):options.onRemove&&options.onRemove(set.local[i].spec)}for(var i$1=0;i$1<set.children.length;i$1+=3)gather(set.children[i$1+2],set.children[i$1]+oldOffset+1)}for(var i=0;i<children.length;i+=3)-1==children[i+1]&&gather(children[i+2],oldChildren[i]+oldOffset+1);return decorations}(children,oldChildren,newLocal||[],mapping,offset,oldOffset,options),built=buildTree(decorations,node,0,options);newLocal=built.local;for(var i$2=0;i$2<children.length;i$2+=3)children[i$2+1]<0&&(children.splice(i$2,3),i$2-=3);for(var i$3=0,j=0;i$3<built.children.length;i$3+=3){for(var from$1=built.children[i$3];j<children.length&&children[j]<from$1;)j+=3;children.splice(j,0,built.children[i$3],built.children[i$3+1],built.children[i$3+2])}}return new DecorationSet(newLocal&&newLocal.sort(byPos),children)}(this.children,newLocal,mapping,node,offset,oldOffset,options):newLocal?new DecorationSet(newLocal.sort(byPos)):empty},DecorationSet.prototype.add=function add(doc,decorations){return decorations.length?this==empty?DecorationSet.create(doc,decorations):this.addInner(doc,decorations,0):this},DecorationSet.prototype.addInner=function addInner(doc,decorations,offset){var children,this$1=this,childIndex=0;doc.forEach((function(childNode,childOffset){var found,baseOffset=childOffset+offset;if(found=takeSpansForNode(decorations,childNode,baseOffset)){for(children||(children=this$1.children.slice());childIndex<children.length&&children[childIndex]<childOffset;)childIndex+=3;children[childIndex]==childOffset?children[childIndex+2]=children[childIndex+2].addInner(childNode,found,baseOffset+1):children.splice(childIndex,0,childOffset,childOffset+childNode.nodeSize,buildTree(found,childNode,baseOffset+1,noSpec)),childIndex+=3}}));for(var local=moveSpans(childIndex?withoutNulls(decorations):decorations,-offset),i=0;i<local.length;i++)local[i].type.valid(doc,local[i])||local.splice(i--,1);return new DecorationSet(local.length?this.local.concat(local).sort(byPos):this.local,children||this.children)},DecorationSet.prototype.remove=function remove(decorations){return 0==decorations.length||this==empty?this:this.removeInner(decorations,0)},DecorationSet.prototype.removeInner=function removeInner(decorations,offset){for(var children=this.children,local=this.local,i=0;i<children.length;i+=3){for(var found=void 0,from=children[i]+offset,to=children[i+1]+offset,j=0,span=void 0;j<decorations.length;j++)(span=decorations[j])&&span.from>from&&span.to<to&&(decorations[j]=null,(found||(found=[])).push(span));if(found){children==this.children&&(children=this.children.slice());var removed=children[i+2].removeInner(found,from+1);removed!=empty?children[i+2]=removed:(children.splice(i,3),i-=3)}}if(local.length)for(var i$1=0,span$1=void 0;i$1<decorations.length;i$1++)if(span$1=decorations[i$1])for(var j$1=0;j$1<local.length;j$1++)local[j$1].eq(span$1,offset)&&(local==this.local&&(local=this.local.slice()),local.splice(j$1--,1));return children==this.children&&local==this.local?this:local.length||children.length?new DecorationSet(local,children):empty},DecorationSet.prototype.forChild=function forChild(offset,node){if(this==empty)return this;if(node.isLeaf)return DecorationSet.empty;for(var child,local,i=0;i<this.children.length;i+=3)if(this.children[i]>=offset){this.children[i]==offset&&(child=this.children[i+2]);break}for(var start=offset+1,end=start+node.content.size,i$1=0;i$1<this.local.length;i$1++){var dec=this.local[i$1];if(dec.from<end&&dec.to>start&&dec.type instanceof InlineType){var from=Math.max(start,dec.from)-start,to=Math.min(end,dec.to)-start;from<to&&(local||(local=[])).push(dec.copy(from,to))}}if(local){var localSet=new DecorationSet(local.sort(byPos));return child?new DecorationGroup([localSet,child]):localSet}return child||empty},DecorationSet.prototype.eq=function eq(other){if(this==other)return!0;if(!(other instanceof DecorationSet)||this.local.length!=other.local.length||this.children.length!=other.children.length)return!1;for(var i=0;i<this.local.length;i++)if(!this.local[i].eq(other.local[i]))return!1;for(var i$1=0;i$1<this.children.length;i$1+=3)if(this.children[i$1]!=other.children[i$1]||this.children[i$1+1]!=other.children[i$1+1]||!this.children[i$1+2].eq(other.children[i$1+2]))return!1;return!0},DecorationSet.prototype.locals=function locals(node){return removeOverlap(this.localsInner(node))},DecorationSet.prototype.localsInner=function localsInner(node){if(this==empty)return none;if(node.inlineContent||!this.local.some(InlineType.is))return this.local;for(var result=[],i=0;i<this.local.length;i++)this.local[i].type instanceof InlineType||result.push(this.local[i]);return result};var empty=new DecorationSet;DecorationSet.empty=empty,DecorationSet.removeOverlap=removeOverlap;var DecorationGroup=function DecorationGroup(members){this.members=members};function moveSpans(spans,offset){if(!offset||!spans.length)return spans;for(var result=[],i=0;i<spans.length;i++){var span=spans[i];result.push(new Decoration(span.from+offset,span.to+offset,span.type))}return result}function takeSpansForNode(spans,node,offset){if(node.isLeaf)return null;for(var end=offset+node.nodeSize,found=null,i=0,span=void 0;i<spans.length;i++)(span=spans[i])&&span.from>offset&&span.to<end&&((found||(found=[])).push(span),spans[i]=null);return found}function withoutNulls(array){for(var result=[],i=0;i<array.length;i++)null!=array[i]&&result.push(array[i]);return result}function buildTree(spans,node,offset,options){var children=[],hasNulls=!1;node.forEach((function(childNode,localStart){var found=takeSpansForNode(spans,childNode,localStart+offset);if(found){hasNulls=!0;var subtree=buildTree(found,childNode,offset+localStart+1,options);subtree!=empty&&children.push(localStart,localStart+childNode.nodeSize,subtree)}}));for(var locals=moveSpans(hasNulls?withoutNulls(spans):spans,-offset).sort(byPos),i=0;i<locals.length;i++)locals[i].type.valid(node,locals[i])||(options.onRemove&&options.onRemove(locals[i].spec),locals.splice(i--,1));return locals.length||children.length?new DecorationSet(locals,children):empty}function byPos(a,b){return a.from-b.from||a.to-b.to}function removeOverlap(spans){for(var working=spans,i=0;i<working.length-1;i++){var span=working[i];if(span.from!=span.to)for(var j=i+1;j<working.length;j++){var next=working[j];if(next.from!=span.from){next.from<span.to&&(working==spans&&(working=spans.slice()),working[i]=span.copy(span.from,next.from),insertAhead(working,j,span.copy(next.from,span.to)));break}next.to!=span.to&&(working==spans&&(working=spans.slice()),working[j]=next.copy(next.from,span.to),insertAhead(working,j+1,next.copy(span.to,next.to)))}}return working}function insertAhead(array,i,deco){for(;i<array.length&&byPos(deco,array[i])>0;)i++;array.splice(i,0,deco)}function viewDecorations(view){var found=[];return view.someProp("decorations",(function(f){var result=f(view.state);result&&result!=empty&&found.push(result)})),view.cursorWrapper&&found.push(DecorationSet.create(view.state.doc,[view.cursorWrapper.deco])),DecorationGroup.from(found)}DecorationGroup.prototype.map=function map(mapping,doc){var mappedDecos=this.members.map((function(member){return member.map(mapping,doc,noSpec)}));return DecorationGroup.from(mappedDecos)},DecorationGroup.prototype.forChild=function forChild(offset,child){if(child.isLeaf)return DecorationSet.empty;for(var found=[],i=0;i<this.members.length;i++){var result=this.members[i].forChild(offset,child);result!=empty&&(result instanceof DecorationGroup?found=found.concat(result.members):found.push(result))}return DecorationGroup.from(found)},DecorationGroup.prototype.eq=function eq(other){if(!(other instanceof DecorationGroup)||other.members.length!=this.members.length)return!1;for(var i=0;i<this.members.length;i++)if(!this.members[i].eq(other.members[i]))return!1;return!0},DecorationGroup.prototype.locals=function locals(node){for(var result,sorted=!0,i=0;i<this.members.length;i++){var locals=this.members[i].localsInner(node);if(locals.length)if(result){sorted&&(result=result.slice(),sorted=!1);for(var j=0;j<locals.length;j++)result.push(locals[j])}else result=locals}return result?removeOverlap(sorted?result:result.sort(byPos)):none},DecorationGroup.from=function from(members){switch(members.length){case 0:return empty;case 1:return members[0];default:return new DecorationGroup(members)}};var EditorView=function EditorView(place,props){this._props=props,this.state=props.state,this.directPlugins=props.plugins||[],this.directPlugins.forEach(checkStateComponent),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=place&&place.mount||document.createElement("div"),place&&(place.appendChild?place.appendChild(this.dom):place.apply?place(this.dom):place.mount&&(this.mounted=!0)),this.editable=getEditable(this),this.markCursor=null,this.cursorWrapper=null,updateCursorWrapper(this),this.nodeViews=buildNodeViews(this),this.docView=docViewDesc(this.state.doc,computeDocDeco(this),viewDecorations(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function initInput(view){view.shiftKey=!1,view.mouseDown=null,view.lastKeyCode=null,view.lastKeyCodeTime=0,view.lastClick={time:0,x:0,y:0,type:""},view.lastSelectionOrigin=null,view.lastSelectionTime=0,view.lastIOSEnter=0,view.lastIOSEnterFallbackTimeout=null,view.lastAndroidDelete=0,view.composing=!1,view.composingTimeout=null,view.compositionNodes=[],view.compositionEndedAt=-2e8,view.domObserver=new DOMObserver(view,(function(from,to,typeOver,added){return readDOMChange(view,from,to,typeOver,added)})),view.domObserver.start(),view.domChangeCount=0,view.eventHandlers=Object.create(null);var loop=function(event){var handler=handlers[event];view.dom.addEventListener(event,view.eventHandlers[event]=function(event){!function eventBelongsToView(view,event){if(!event.bubbles)return!0;if(event.defaultPrevented)return!1;for(var node=event.target;node!=view.dom;node=node.parentNode)if(!node||11==node.nodeType||node.pmViewDesc&&node.pmViewDesc.stopEvent(event))return!1;return!0}(view,event)||runCustomHandler(view,event)||!view.editable&&event.type in editHandlers||handler(view,event)})};for(var event in handlers)loop(event);result.safari&&view.dom.addEventListener("input",(function(){return null})),ensureListeners(view)}(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},prototypeAccessors$2={props:{configurable:!0},root:{configurable:!0},isDestroyed:{configurable:!0}};function computeDocDeco(view){var attrs=Object.create(null);return attrs.class="ProseMirror",attrs.contenteditable=String(view.editable),attrs.translate="no",view.someProp("attributes",(function(value){if("function"==typeof value&&(value=value(view.state)),value)for(var attr in value)"class"==attr&&(attrs.class+=" "+value[attr]),"style"==attr?attrs.style=(attrs.style?attrs.style+";":"")+value[attr]:attrs[attr]||"contenteditable"==attr||"nodeName"==attr||(attrs[attr]=String(value[attr]))})),[Decoration.node(0,view.state.doc.content.size,attrs)]}function updateCursorWrapper(view){if(view.markCursor){var dom=document.createElement("img");dom.className="ProseMirror-separator",dom.setAttribute("mark-placeholder","true"),view.cursorWrapper={dom:dom,deco:Decoration.widget(view.state.selection.head,dom,{raw:!0,marks:view.markCursor})}}else view.cursorWrapper=null}function getEditable(view){return!view.someProp("editable",(function(value){return!1===value(view.state)}))}function buildNodeViews(view){var result={};return view.someProp("nodeViews",(function(obj){for(var prop in obj)Object.prototype.hasOwnProperty.call(result,prop)||(result[prop]=obj[prop])})),result}function checkStateComponent(plugin){if(plugin.spec.state||plugin.spec.filterTransaction||plugin.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}prototypeAccessors$2.props.get=function(){if(this._props.state!=this.state){var prev=this._props;for(var name in this._props={},prev)this._props[name]=prev[name];this._props.state=this.state}return this._props},EditorView.prototype.update=function update(props){props.handleDOMEvents!=this._props.handleDOMEvents&&ensureListeners(this),this._props=props,props.plugins&&(props.plugins.forEach(checkStateComponent),this.directPlugins=props.plugins),this.updateStateInner(props.state,!0)},EditorView.prototype.setProps=function setProps(props){var updated={};for(var name in this._props)updated[name]=this._props[name];for(var name$1 in updated.state=this.state,props)updated[name$1]=props[name$1];this.update(updated)},EditorView.prototype.updateState=function updateState(state){this.updateStateInner(state,this.state.plugins!=state.plugins)},EditorView.prototype.updateStateInner=function updateStateInner(state,reconfigured){var this$1=this,prev=this.state,redraw=!1,updateSel=!1;if(state.storedMarks&&this.composing&&(clearComposition(this),updateSel=!0),this.state=state,reconfigured){var nodeViews=buildNodeViews(this);(function changedNodeViews(a,b){var nA=0,nB=0;for(var prop in a){if(a[prop]!=b[prop])return!0;nA++}for(var _ in b)nB++;return nA!=nB})(nodeViews,this.nodeViews)&&(this.nodeViews=nodeViews,redraw=!0),ensureListeners(this)}this.editable=getEditable(this),updateCursorWrapper(this);var innerDeco=viewDecorations(this),outerDeco=computeDocDeco(this),scroll=reconfigured?"reset":state.scrollToSelection>prev.scrollToSelection?"to selection":"preserve",updateDoc=redraw||!this.docView.matchesNode(state.doc,outerDeco,innerDeco);!updateDoc&&state.selection.eq(prev.selection)||(updateSel=!0);var oldScrollPos="preserve"==scroll&&updateSel&&null==this.dom.style.overflowAnchor&&function storeScrollPos(view){for(var refDOM,refTop,rect=view.dom.getBoundingClientRect(),startY=Math.max(0,rect.top),x=(rect.left+rect.right)/2,y=startY+1;y<Math.min(innerHeight,rect.bottom);y+=5){var dom=view.root.elementFromPoint(x,y);if(dom!=view.dom&&view.dom.contains(dom)){var localRect=dom.getBoundingClientRect();if(localRect.top>=startY-20){refDOM=dom,refTop=localRect.top;break}}}return{refDOM:refDOM,refTop:refTop,stack:scrollStack(view.dom)}}(this);if(updateSel){this.domObserver.stop();var forceSelUpdate=updateDoc&&(result.ie||result.chrome)&&!this.composing&&!prev.selection.empty&&!state.selection.empty&&function selectionContextChanged(sel1,sel2){var depth=Math.min(sel1.$anchor.sharedDepth(sel1.head),sel2.$anchor.sharedDepth(sel2.head));return sel1.$anchor.start(depth)!=sel2.$anchor.start(depth)}(prev.selection,state.selection);if(updateDoc){var chromeKludge=result.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!redraw&&this.docView.update(state.doc,outerDeco,innerDeco,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=docViewDesc(state.doc,outerDeco,innerDeco,this.dom,this)),chromeKludge&&!this.trackWrites&&(forceSelUpdate=!0)}forceSelUpdate||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&function anchorInRightPlace(view){var anchorDOM=view.docView.domFromPos(view.state.selection.anchor,0),domSel=view.root.getSelection();return isEquivalentPosition(anchorDOM.node,anchorDOM.offset,domSel.anchorNode,domSel.anchorOffset)}(this))?selectionToDOM(this,forceSelUpdate):(syncNodeSelection(this,state.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(prev),"reset"==scroll)this.dom.scrollTop=0;else if("to selection"==scroll){var startDOM=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(f){return f(this$1)}))||(state.selection instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.c?scrollRectIntoView(this,this.docView.domAfterPos(state.selection.from).getBoundingClientRect(),startDOM):scrollRectIntoView(this,this.coordsAtPos(state.selection.head,1),startDOM))}else oldScrollPos&&function resetScrollPos(ref){var refDOM=ref.refDOM,refTop=ref.refTop,stack=ref.stack,newRefTop=refDOM?refDOM.getBoundingClientRect().top:0;restoreScrollStack(stack,0==newRefTop?0:newRefTop-refTop)}(oldScrollPos)},EditorView.prototype.destroyPluginViews=function destroyPluginViews(){for(var view;view=this.pluginViews.pop();)view.destroy&&view.destroy()},EditorView.prototype.updatePluginViews=function updatePluginViews(prevState){if(prevState&&prevState.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var i$2=0;i$2<this.pluginViews.length;i$2++){var pluginView=this.pluginViews[i$2];pluginView.update&&pluginView.update(this,prevState)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var i=0;i<this.directPlugins.length;i++){var plugin=this.directPlugins[i];plugin.spec.view&&this.pluginViews.push(plugin.spec.view(this))}for(var i$1=0;i$1<this.state.plugins.length;i$1++){var plugin$1=this.state.plugins[i$1];plugin$1.spec.view&&this.pluginViews.push(plugin$1.spec.view(this))}}},EditorView.prototype.someProp=function someProp(propName,f){var value,prop=this._props&&this._props[propName];if(null!=prop&&(value=f?f(prop):prop))return value;for(var i=0;i<this.directPlugins.length;i++){var prop$1=this.directPlugins[i].props[propName];if(null!=prop$1&&(value=f?f(prop$1):prop$1))return value}var plugins=this.state.plugins;if(plugins)for(var i$1=0;i$1<plugins.length;i$1++){var prop$2=plugins[i$1].props[propName];if(null!=prop$2&&(value=f?f(prop$2):prop$2))return value}},EditorView.prototype.hasFocus=function hasFocus(){return this.root.activeElement==this.dom},EditorView.prototype.focus=function focus(){this.domObserver.stop(),this.editable&&function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();if(preventScrollSupported)return dom.focus(preventScrollSupported);var stored=scrollStack(dom);dom.focus(null==preventScrollSupported?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),preventScrollSupported||(preventScrollSupported=!1,restoreScrollStack(stored,0))}(this.dom),selectionToDOM(this),this.domObserver.start()},prototypeAccessors$2.root.get=function(){var cached=this._root;if(null==cached)for(var search=this.dom.parentNode;search;search=search.parentNode)if(9==search.nodeType||11==search.nodeType&&search.host)return search.getSelection||(Object.getPrototypeOf(search).getSelection=function(){return document.getSelection()}),this._root=search;return cached||document},EditorView.prototype.posAtCoords=function posAtCoords$1(coords){return posAtCoords(this,coords)},EditorView.prototype.coordsAtPos=function coordsAtPos$1(pos,side){return void 0===side&&(side=1),coordsAtPos(this,pos,side)},EditorView.prototype.domAtPos=function domAtPos(pos,side){return void 0===side&&(side=0),this.docView.domFromPos(pos,side)},EditorView.prototype.nodeDOM=function nodeDOM(pos){var desc=this.docView.descAt(pos);return desc?desc.nodeDOM:null},EditorView.prototype.posAtDOM=function posAtDOM(node,offset,bias){void 0===bias&&(bias=-1);var pos=this.docView.posFromDOM(node,offset,bias);if(null==pos)throw new RangeError("DOM position not inside the editor");return pos},EditorView.prototype.endOfTextblock=function endOfTextblock$1(dir,state){return endOfTextblock(this,state||this.state,dir)},EditorView.prototype.destroy=function destroy(){this.docView&&(!function destroyInput(view){for(var type in view.domObserver.stop(),view.eventHandlers)view.dom.removeEventListener(type,view.eventHandlers[type]);clearTimeout(view.composingTimeout),clearTimeout(view.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],viewDecorations(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},prototypeAccessors$2.isDestroyed.get=function(){return null==this.docView},EditorView.prototype.dispatchEvent=function dispatchEvent$1(event){return function dispatchEvent(view,event){runCustomHandler(view,event)||!handlers[event.type]||!view.editable&&event.type in editHandlers||handlers[event.type](view,event)}(this,event)},EditorView.prototype.dispatch=function dispatch(tr){var dispatchTransaction=this._props.dispatchTransaction;dispatchTransaction?dispatchTransaction.call(this,tr):this.updateState(this.state.apply(tr))},Object.defineProperties(EditorView.prototype,prototypeAccessors$2)},3607:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return keydownHandler})),__webpack_require__.d(__webpack_exports__,"b",(function(){return keymap}));for(var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},chrome="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),safari="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),gecko="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),mac="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),ie="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),brokenModifierNames=chrome&&(mac||+chrome[1]<57)||gecko&&mac,i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(i=1;i<=24;i++)base[i+111]="F"+i;for(i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift[i]=String.fromCharCode(i);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);var index_es=__webpack_require__(2686),index_es_mac="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function normalizeKeyName(name){var alt,ctrl,shift,meta,parts=name.split(/-(?!$)/),result=parts[parts.length-1];"Space"==result&&(result=" ");for(var i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);index_es_mac?meta=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta&&(result="Meta-"+result),shift&&(result="Shift-"+result),result}function modifiers(name,event,shift){return event.altKey&&(name="Alt-"+name),event.ctrlKey&&(name="Ctrl-"+name),event.metaKey&&(name="Meta-"+name),!1!==shift&&event.shiftKey&&(name="Shift-"+name),name}function keymap(bindings){return new index_es.d({props:{handleKeyDown:keydownHandler(bindings)}})}function keydownHandler(bindings){var map=function normalize(map){var copy=Object.create(null);for(var prop in map)copy[normalizeKeyName(prop)]=map[prop];return copy}(bindings);return function(view,event){var baseName,name=function keyName(event){var name=!(brokenModifierNames&&(event.ctrlKey||event.altKey||event.metaKey)||(safari||ie)&&event.shiftKey&&event.key&&1==event.key.length)&&event.key||(event.shiftKey?shift:base)[event.keyCode]||event.key||"Unidentified";return"Esc"==name&&(name="Escape"),"Del"==name&&(name="Delete"),"Left"==name&&(name="ArrowLeft"),"Up"==name&&(name="ArrowUp"),"Right"==name&&(name="ArrowRight"),"Down"==name&&(name="ArrowDown"),name}(event),isChar=1==name.length&&" "!=name,direct=map[modifiers(name,event,!isChar)];if(direct&&direct(view.state,view.dispatch,view))return!0;if(isChar&&(event.shiftKey||event.altKey||event.metaKey||name.charCodeAt(0)>127)&&(baseName=base[event.keyCode])&&baseName!=name){var fromCode=map[modifiers(baseName,event,!0)];if(fromCode&&fromCode(view.state,view.dispatch,view))return!0}else if(isChar&&event.shiftKey){var withShift=map[modifiers(name,event,!0)];if(withShift&&withShift(view.state,view.dispatch,view))return!0}return!1}}}}]);