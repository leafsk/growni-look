(window.webpackJsonp=window.webpackJsonp||[]).push([[480],{4140:function(module,exports,__webpack_require__){"use strict";(function(Buffer){Object.defineProperty(exports,"__esModule",{value:!0});const BMP={validate:buffer=>"BM"===buffer.toString("ascii",0,2),calculate:buffer=>({height:Math.abs(buffer.readInt32LE(22)),width:buffer.readUInt32LE(18)})};function getSizeFromOffset(buffer,offset){const value=buffer.readUInt8(offset);return 0===value?256:value}function getImageSize(buffer,imageIndex){const offset=6+16*imageIndex;return{height:getSizeFromOffset(buffer,offset+1),width:getSizeFromOffset(buffer,offset)}}const ICO={validate:buffer=>0===buffer.readUInt16LE(0)&&1===buffer.readUInt16LE(2),calculate(buffer){const nbImages=buffer.readUInt16LE(4),imageSize=getImageSize(buffer,0);if(1===nbImages)return imageSize;const imgs=[imageSize];for(let imageIndex=1;imageIndex<nbImages;imageIndex+=1)imgs.push(getImageSize(buffer,imageIndex));return{height:imageSize.height,images:imgs,width:imageSize.width}}},CUR={validate:buffer=>0===buffer.readUInt16LE(0)&&2===buffer.readUInt16LE(2),calculate:buffer=>ICO.calculate(buffer)},DDS={validate:buffer=>542327876===buffer.readUInt32LE(0),calculate:buffer=>({height:buffer.readUInt32LE(12),width:buffer.readUInt32LE(16)})},gifRegexp=/^GIF8[79]a/,GIF={validate(buffer){const signature=buffer.toString("ascii",0,6);return gifRegexp.test(signature)},calculate:buffer=>({height:buffer.readUInt16LE(8),width:buffer.readUInt16LE(6)})},ICON_TYPE_SIZE={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function readImageHeader(buffer,imageOffset){const imageLengthOffset=imageOffset+4;return[buffer.toString("ascii",imageOffset,imageLengthOffset),buffer.readUInt32BE(imageLengthOffset)]}function getImageSize$1(type){const size=ICON_TYPE_SIZE[type];return{width:size,height:size,type:type}}const ICNS={validate:buffer=>"icns"===buffer.toString("ascii",0,4),calculate(buffer){const bufferLength=buffer.length,fileLength=buffer.readUInt32BE(4);let imageOffset=8,imageHeader=readImageHeader(buffer,imageOffset),imageSize=getImageSize$1(imageHeader[0]);if(imageOffset+=imageHeader[1],imageOffset===fileLength)return imageSize;const result={height:imageSize.height,images:[imageSize],width:imageSize.width};for(;imageOffset<fileLength&&imageOffset<bufferLength;)imageHeader=readImageHeader(buffer,imageOffset),imageSize=getImageSize$1(imageHeader[0]),imageOffset+=imageHeader[1],result.images.push(imageSize);return result}},J2C={validate:buffer=>"ff4fff51"===buffer.toString("hex",0,4),calculate:buffer=>({height:buffer.readUInt32BE(12),width:buffer.readUInt32BE(8)})},BoxTypes_ftyp="66747970",BoxTypes_jp2h="6a703268",BoxTypes_jp__="6a502020",BoxTypes_rreq="72726571",parseIHDR=box=>({height:box.readUInt32BE(4),width:box.readUInt32BE(8)}),JP2={validate(buffer){const signature=buffer.toString("hex",4,8),signatureLength=buffer.readUInt32BE(0);if(signature!==BoxTypes_jp__||signatureLength<1)return!1;const ftypeBoxStart=signatureLength+4,ftypBoxLength=buffer.readUInt32BE(signatureLength);return buffer.slice(ftypeBoxStart,ftypeBoxStart+ftypBoxLength).toString("hex",0,4)===BoxTypes_ftyp},calculate(buffer){const signatureLength=buffer.readUInt32BE(0);let offset=signatureLength+4+buffer.readUInt16BE(signatureLength+2);switch(buffer.toString("hex",offset,offset+4)){case BoxTypes_rreq:return offset=offset+4+4+(box=>{const unit=box.readUInt8(0);let offset=1+2*unit;return offset=offset+2+box.readUInt16BE(offset)*(2+unit),offset+2+box.readUInt16BE(offset)*(16+unit)})(buffer.slice(offset+4)),parseIHDR(buffer.slice(offset+8,offset+24));case BoxTypes_jp2h:return parseIHDR(buffer.slice(offset+8,offset+24));default:throw new TypeError("Unsupported header found: "+buffer.toString("ascii",offset,offset+4))}}};function readUInt(buffer,bits,offset,isBigEndian){offset=offset||0;return buffer["readUInt"+bits+(isBigEndian?"BE":"LE")].call(buffer,offset)}function isEXIF(buffer){return"45786966"===buffer.toString("hex",2,6)}function extractSize(buffer,index){return{height:buffer.readUInt16BE(index),width:buffer.readUInt16BE(index+2)}}function validateExifBlock(buffer,index){const exifBlock=buffer.slice(2,index),byteAlign=exifBlock.toString("hex",6,8),isBigEndian="4d4d"===byteAlign;if(isBigEndian||"4949"===byteAlign)return function extractOrientation(exifBlock,isBigEndian){const idfDirectoryEntries=readUInt(exifBlock,16,14,isBigEndian);for(let directoryEntryNumber=0;directoryEntryNumber<idfDirectoryEntries;directoryEntryNumber++){const start=16+12*directoryEntryNumber,end=start+12;if(start>exifBlock.length)return;const block=exifBlock.slice(start,end);if(274===readUInt(block,16,0,isBigEndian)){if(3!==readUInt(block,16,2,isBigEndian))return;if(1!==readUInt(block,32,4,isBigEndian))return;return readUInt(block,16,8,isBigEndian)}}}(exifBlock,isBigEndian)}function validateBuffer(buffer,index){if(index>buffer.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(255!==buffer[index])throw new TypeError("Invalid JPG, marker table corrupted")}const JPG={validate:buffer=>"ffd8"===buffer.toString("hex",0,2),calculate(buffer){let orientation,next;for(buffer=buffer.slice(4);buffer.length;){const i=buffer.readUInt16BE(0);if(isEXIF(buffer)&&(orientation=validateExifBlock(buffer,i)),validateBuffer(buffer,i),next=buffer[i+1],192===next||193===next||194===next){const size=extractSize(buffer,i+5);return orientation?{height:size.height,orientation:orientation,width:size.width}:size}buffer=buffer.slice(i+2)}throw new TypeError("Invalid JPG, no size found")}},KTX={validate:buffer=>"KTX 11"===buffer.toString("ascii",1,7),calculate:buffer=>({height:buffer.readUInt32LE(40),width:buffer.readUInt32LE(36)})},PNG={validate(buffer){if("PNG\r\n\n"===buffer.toString("ascii",1,8)){let chunkName=buffer.toString("ascii",12,16);if("CgBI"===chunkName&&(chunkName=buffer.toString("ascii",28,32)),"IHDR"!==chunkName)throw new TypeError("Invalid PNG");return!0}return!1},calculate:buffer=>"CgBI"===buffer.toString("ascii",12,16)?{height:buffer.readUInt32BE(36),width:buffer.readUInt32BE(32)}:{height:buffer.readUInt32BE(20),width:buffer.readUInt32BE(16)}},PNMTypes={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},Signatures=Object.keys(PNMTypes),handlers={default:lines=>{let dimensions=[];for(;lines.length>0;){const line=lines.shift();if("#"!==line[0]){dimensions=line.split(" ");break}}if(2===dimensions.length)return{height:parseInt(dimensions[1],10),width:parseInt(dimensions[0],10)};throw new TypeError("Invalid PNM")},pam:lines=>{const size={};for(;lines.length>0;){const line=lines.shift();if(line.length>16||line.charCodeAt(0)>128)continue;const[key,value]=line.split(" ");if(key&&value&&(size[key.toLowerCase()]=parseInt(value,10)),size.height&&size.width)break}if(size.height&&size.width)return{height:size.height,width:size.width};throw new TypeError("Invalid PAM")}},svgReg=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,extractorRegExps={height:/\sheight=(['"])([^%]+?)\1/,root:svgReg,viewbox:/\sviewBox=(['"])(.+?)\1/,width:/\swidth=(['"])([^%]+?)\1/},units={cm:96/2.54,em:16,ex:8,m:96/2.54*100,mm:96/2.54/10,pc:96/72/12,pt:96/72};function parseLength(len){const m=/([0-9.]+)([a-z]*)/.exec(len);if(m)return Math.round(parseFloat(m[1])*(units[m[2]]||1))}function parseViewbox(viewbox){const bounds=viewbox.split(" ");return{height:parseLength(bounds[3]),width:parseLength(bounds[2])}}const typeHandlers={bmp:BMP,cur:CUR,dds:DDS,gif:GIF,icns:ICNS,ico:ICO,j2c:J2C,jp2:JP2,jpg:JPG,ktx:KTX,png:PNG,pnm:{validate(buffer){const signature=buffer.toString("ascii",0,2);return Signatures.includes(signature)},calculate(buffer){const signature=buffer.toString("ascii",0,2),type=PNMTypes[signature],lines=buffer.toString("ascii",3).split(/[\r\n]+/);return(handlers[type]||handlers.default)(lines)}},psd:{validate:buffer=>"8BPS"===buffer.toString("ascii",0,4),calculate:buffer=>({height:buffer.readUInt32BE(14),width:buffer.readUInt32BE(18)})},svg:{validate(buffer){const str=String(buffer);return svgReg.test(str)},calculate(buffer){const root=buffer.toString("utf8").match(extractorRegExps.root);if(root){const attrs=function parseAttributes(root){const width=root.match(extractorRegExps.width),height=root.match(extractorRegExps.height),viewbox=root.match(extractorRegExps.viewbox);return{height:height&&parseLength(height[2]),viewbox:viewbox&&parseViewbox(viewbox[2]),width:width&&parseLength(width[2])}}(root[0]);if(attrs.width&&attrs.height)return function calculateByDimensions(attrs){return{height:attrs.height,width:attrs.width}}(attrs);if(attrs.viewbox)return function calculateByViewbox(attrs,viewbox){const ratio=viewbox.width/viewbox.height;return attrs.width?{height:Math.floor(attrs.width/ratio),width:attrs.width}:attrs.height?{height:attrs.height,width:Math.floor(attrs.height*ratio)}:{height:viewbox.height,width:viewbox.width}}(attrs,attrs.viewbox)}throw new TypeError("Invalid SVG")}},webp:{validate(buffer){const riffHeader="RIFF"===buffer.toString("ascii",0,4),webpHeader="WEBP"===buffer.toString("ascii",8,12),vp8Header="VP8"===buffer.toString("ascii",12,15);return riffHeader&&webpHeader&&vp8Header},calculate(buffer){const chunkHeader=buffer.toString("ascii",12,16);if(buffer=buffer.slice(20,30),"VP8X"===chunkHeader){const extendedHeader=buffer[0],validEnd=0==(1&extendedHeader);if(0==(192&extendedHeader)&&validEnd)return function calculateExtended(buffer){return{height:1+buffer.readUIntLE(7,3),width:1+buffer.readUIntLE(4,3)}}(buffer);throw new TypeError("Invalid WebP")}if("VP8 "===chunkHeader&&47!==buffer[0])return function calculateLossy(buffer){return{height:16383&buffer.readInt16LE(8),width:16383&buffer.readInt16LE(6)}}(buffer);const signature=buffer.toString("hex",3,6);if("VP8L"===chunkHeader&&"9d012a"!==signature)return function calculateLossless(buffer){return{height:1+((15&buffer[4])<<10|buffer[3]<<2|(192&buffer[2])>>6),width:1+((63&buffer[2])<<8|buffer[1])}}(buffer);throw new TypeError("Invalid WebP")}}},keys=Object.keys(typeHandlers),firstBytes={56:"psd",66:"bmp",68:"dds",71:"gif",73:"tiff",77:"tiff",82:"webp",105:"icns",137:"png",255:"jpg"};function lookup(buffer,filepath){const type=function detector(buffer){const byte=buffer[0];if(byte in firstBytes){const type=firstBytes[byte];if(typeHandlers[type].validate(buffer))return type}return keys.find((key=>typeHandlers[key].validate(buffer)))}(buffer);if(type&&type in typeHandlers){const size=typeHandlers[type].calculate(buffer,filepath);if(void 0!==size)return size.type=type,size.mimeType=(type=>"svg"===type?"image/svg+xml":`image/${type}`)(type),size}throw new TypeError("unsupported file type: "+type+" (file: "+filepath+")")}const types=Object.keys(typeHandlers);exports.default=function imageMeta(input){if(Buffer.isBuffer(input))return lookup(input);throw new Error("Input should be buffer!")},exports.types=types}).call(this,__webpack_require__(2531).Buffer)}}]);